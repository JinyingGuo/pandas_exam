2022-05-17 17:11:39.342 | INFO     | src.main:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:11:39.946 | INFO     | src.main:<module>:23 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.771
66666664  0.725  0.636  0.864  0.861
66662208  0.543  0.663  0.492  0.604
66662209  0.750  0.951  0.636  0.805
66662210  0.743  0.845  0.804  0.815
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.604
66662333  0.730  0.709  0.564  0.618
66662334  0.752  0.846  0.600  0.656
66662335  0.828  0.821  0.592  0.701
平均值       0.752  0.800  0.658  0.697

[139 rows x 4 columns]
2022-05-17 17:11:39.952 | INFO     | src.main:<module>:24 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   65.0
单项目标未达成人数       33   24.0   93.0   73.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-17 17:11:39.955 | INFO     | src.main:<module>:25 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  47.10%
单项目标未达成人数    23.91%  17.39%  67.39%  52.90%
2022-05-17 17:11:39.959 | INFO     | src.main:<module>:26 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-17 17:15:41.829 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:15:42.577 | INFO     | __main__:<module>:23 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.771
66666664  0.725  0.636  0.864  0.861
66662208  0.543  0.663  0.492  0.604
66662209  0.750  0.951  0.636  0.805
66662210  0.743  0.845  0.804  0.815
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.604
66662333  0.730  0.709  0.564  0.618
66662334  0.752  0.846  0.600  0.656
66662335  0.828  0.821  0.592  0.701
平均值       0.752  0.800  0.658  0.697

[139 rows x 4 columns]
2022-05-17 17:15:42.583 | INFO     | __main__:<module>:24 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   65.0
单项目标未达成人数       33   24.0   93.0   73.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-17 17:15:42.587 | INFO     | __main__:<module>:25 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  47.10%
单项目标未达成人数    23.91%  17.39%  67.39%  52.90%
2022-05-17 17:15:42.590 | INFO     | __main__:<module>:26 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-17 17:16:16.074 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:16:16.726 | INFO     | __main__:<module>:23 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.771
66666664  0.725  0.636  0.864  0.861
66662208  0.543  0.663  0.492  0.604
66662209  0.750  0.951  0.636  0.805
66662210  0.743  0.845  0.804  0.815
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.604
66662333  0.730  0.709  0.564  0.618
66662334  0.752  0.846  0.600  0.656
66662335  0.828  0.821  0.592  0.701
平均值       0.752  0.800  0.658  0.697

[139 rows x 4 columns]
2022-05-17 17:16:16.732 | INFO     | __main__:<module>:24 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   65.0
单项目标未达成人数       33   24.0   93.0   73.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-17 17:16:16.735 | INFO     | __main__:<module>:25 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  47.10%
单项目标未达成人数    23.91%  17.39%  67.39%  52.90%
2022-05-17 17:16:16.739 | INFO     | __main__:<module>:26 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-17 17:17:25.906 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:17:26.501 | INFO     | __main__:<module>:23 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.771
66666664  0.725  0.636  0.864  0.861
66662208  0.543  0.663  0.492  0.604
66662209  0.750  0.951  0.636  0.805
66662210  0.743  0.845  0.804  0.815
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.604
66662333  0.730  0.709  0.564  0.618
66662334  0.752  0.846  0.600  0.656
66662335  0.828  0.821  0.592  0.701
平均值       0.752  0.800  0.658  0.697

[139 rows x 4 columns]
2022-05-17 17:17:26.506 | INFO     | __main__:<module>:24 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   65.0
单项目标未达成人数       33   24.0   93.0   73.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-17 17:17:26.510 | INFO     | __main__:<module>:25 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  47.10%
单项目标未达成人数    23.91%  17.39%  67.39%  52.90%
2022-05-17 17:17:26.513 | INFO     | __main__:<module>:26 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-17 17:18:48.485 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:18:49.111 | INFO     | __main__:<module>:23 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.771
66666664  0.725  0.636  0.864  0.861
66662208  0.543  0.663  0.492  0.604
66662209  0.750  0.951  0.636  0.805
66662210  0.743  0.845  0.804  0.815
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.604
66662333  0.730  0.709  0.564  0.618
66662334  0.752  0.846  0.600  0.656
66662335  0.828  0.821  0.592  0.701
平均值       0.752  0.800  0.658  0.697

[139 rows x 4 columns]
2022-05-17 17:18:49.116 | INFO     | __main__:<module>:24 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   65.0
单项目标未达成人数       33   24.0   93.0   73.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-17 17:18:49.120 | INFO     | __main__:<module>:25 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  47.10%
单项目标未达成人数    23.91%  17.39%  67.39%  52.90%
2022-05-17 17:18:49.123 | INFO     | __main__:<module>:26 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-17 17:19:10.097 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:19:10.837 | INFO     | __main__:<module>:23 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.771
66666664  0.725  0.636  0.864  0.861
66662208  0.543  0.663  0.492  0.604
66662209  0.750  0.951  0.636  0.805
66662210  0.743  0.845  0.804  0.815
66662211  0.719  0.734  0.628  0.766
66662212  0.676  0.793  0.648  0.631
66662213  0.882  0.921  0.800  0.693
66662214  0.712  0.793  0.500  0.634
66662215  0.716  0.899  0.648  0.681
66662216  0.737  0.821  0.704  0.667
66662217  0.767  0.723  0.560  0.774
66662218  0.895  0.843  0.692  0.792
66662219  0.785  0.791  0.604  0.848
66662220  0.821  0.678  0.676  0.585
66662221  0.661  0.701  0.728  0.657
66662222  0.707  0.827  0.680  0.747
66662223  0.877  0.845  0.796  0.832
66662224  0.601  0.641  0.556  0.518
66662225  0.652  0.773  0.644  0.767
66662226  0.821  0.799  0.688  0.745
66662227  0.710  0.915  0.724  0.654
66662228  0.730  0.899  0.876  0.826
66662229  0.634  0.743  0.508  0.563
66662230  0.764  0.615  0.548  0.581
66662231  0.628  0.915  0.876  0.797
66662232  0.764  0.911  0.584  0.655
66662233  0.700  0.663  0.476  0.646
66662234  0.649  0.773  0.564  0.783
66662235  0.727  0.371  0.692  0.428
66662236  0.861  0.861  0.780  0.864
66662237  0.724  0.849  0.492  0.494
66662238  0.825  0.687  0.862  0.711
66662239  0.700  0.833  0.552  0.778
66662240  0.640  0.717  0.528  0.495
66662241  0.828  0.711  0.768  0.741
66662242  0.585  0.639  0.536  0.634
66662243  0.704  0.915  0.620  0.778
66662244  0.765  0.817  0.776  0.718
66662245  0.725  0.827  0.744  0.672
66662246  0.810  0.849  0.828  0.793
66662247  0.606  0.775  0.568  0.721
66662248  0.659  0.667  0.698  0.719
66662249  0.670  0.749  0.572  0.695
66662250  0.655  0.766  0.776  0.773
66662251  0.792  0.897  0.776  0.779
66642617  0.770  0.923  0.752  0.791
66660051  0.894  0.885  0.920  0.724
66661848  0.895  0.839  0.900  0.724
66662073  0.834  0.976  0.756  0.849
66662252  0.603  0.657  0.156  0.479
66662253  0.771  0.867  0.644  0.603
66662254  0.722  0.843  0.596  0.637
66662255  0.780  0.909  0.584  0.729
66662256  0.770  0.749  0.572  0.669
66662257  0.910  0.827  0.808  0.895
66662258  0.700  0.754  0.548  0.627
66662259  0.755  0.905  0.656  0.669
66662260  0.737  0.915  0.548  0.773
66662261  0.828  0.857  0.636  0.679
66662262  0.976  1.000  0.944  0.940
66662263  0.755  0.743  0.620  0.582
66662264  0.882  0.864  0.804  0.807
66662265  0.752  0.809  0.556  0.650
66662266  0.794  0.867  0.864  0.808
66662267  0.688  0.691  0.512  0.655
66662268  0.794  0.939  0.856  0.778
66662269  0.768  0.955  0.600  0.822
66662270  0.658  0.821  0.656  0.625
66662271  0.934  0.933  0.868  0.841
66662272  0.652  0.839  0.640  0.762
66662273  0.888  0.867  0.664  0.702
66662274  0.767  0.755  0.640  0.681
66662275  0.937  0.957  0.688  0.856
66662276  0.746  0.721  0.584  0.632
66662277  0.843  0.867  0.860  0.766
66662279  0.888  0.924  0.908  0.825
66662280  0.682  0.321  0.326  0.505
66662281  0.774  0.976  0.808  0.795
66662282  0.585  0.589  0.484  0.474
66662284  0.591  0.697  0.644  0.650
66662285  0.783  0.767  0.596  0.678
66662286  0.710  0.957  0.860  0.717
66662287  0.960  1.000  0.856  0.845
66662288  0.661  0.839  0.812  0.572
66662289  0.743  0.660  0.648  0.657
66662291  0.604  0.871  0.700  0.632
66662292  0.788  0.921  0.776  0.689
66662293  0.664  0.893  0.588  0.656
66662294  0.646  0.615  0.436  0.431
66662926  0.834  0.846  0.616  0.800
66642392  0.664  0.805  0.408  0.538
66642950  0.792  0.955  0.864  0.841
66660068  0.764  0.936  0.684  0.701
66661657  0.752  0.749  0.804  0.709
66661694  0.794  0.879  0.700  0.781
66661695  0.704  0.879  0.644  0.698
66661859  0.819  0.939  0.764  0.809
66662062  0.819  0.976  0.788  0.878
66662295  0.744  0.800  0.668  0.835
66662296  0.719  0.887  0.536  0.657
66662297  0.764  0.776  0.756  0.805
66662298  0.815  0.675  0.592  0.645
66662300  0.776  0.908  0.664  0.661
66662301  0.682  0.717  0.504  0.499
66662302  0.806  0.862  0.700  0.629
66662303  0.748  0.543  0.508  0.496
66662304  0.785  0.911  0.540  0.684
66662305  0.777  0.892  0.644  0.663
66662306  0.694  0.727  0.596  0.574
66662307  0.728  0.849  0.700  0.672
66662308  0.955  0.749  0.644  0.817
66662309  0.891  0.879  0.556  0.690
66662310  0.691  0.875  0.656  0.652
66662311  0.728  0.773  0.564  0.812
66662312  0.670  0.775  0.500  0.436
66662313  0.786  0.691  0.640  0.715
66662314  0.794  0.899  0.776  0.626
66662316  0.610  0.255  0.508  0.468
66662317  0.732  0.712  0.536  0.668
66662318  0.810  0.933  0.568  0.716
66662319  0.729  0.604  0.662  0.652
66662320  0.879  0.767  0.620  0.801
66662321  0.776  0.879  0.692  0.673
66662322  0.791  0.843  0.644  0.558
66662323  0.762  0.701  0.668  0.685
66662324  0.779  0.899  0.544  0.762
66662325  0.776  0.342  0.552  0.680
66662326  0.742  0.806  0.572  0.596
66662327  0.721  0.727  0.640  0.649
66662328  0.758  0.839  0.588  0.682
66662329  0.732  0.870  0.812  0.856
66662330  0.661  0.551  0.532  0.673
66662331  0.733  0.727  0.628  0.734
66662332  0.836  0.871  0.648  0.604
66662333  0.730  0.709  0.564  0.618
66662334  0.752  0.846  0.600  0.656
66662335  0.828  0.821  0.592  0.701
平均值       0.752  0.800  0.658  0.697
2022-05-17 17:19:10.856 | INFO     | __main__:<module>:24 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   65.0
单项目标未达成人数       33   24.0   93.0   73.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-17 17:19:10.860 | INFO     | __main__:<module>:25 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  47.10%
单项目标未达成人数    23.91%  17.39%  67.39%  52.90%
2022-05-17 17:19:10.862 | INFO     | __main__:<module>:26 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-17 17:33:04.186 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:33:04.786 | INFO     | __main__:<module>:23 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.771
66666664  0.725  0.636  0.864  0.861
66662208  0.543  0.663  0.492  0.604
66662209  0.750  0.951  0.636  0.805
66662210  0.743  0.845  0.804  0.815
66662211  0.719  0.734  0.628  0.766
66662212  0.676  0.793  0.648  0.631
66662213  0.882  0.921  0.800  0.693
66662214  0.712  0.793  0.500  0.634
66662215  0.716  0.899  0.648  0.681
66662216  0.737  0.821  0.704  0.667
66662217  0.767  0.723  0.560  0.774
66662218  0.895  0.843  0.692  0.792
66662219  0.785  0.791  0.604  0.848
66662220  0.821  0.678  0.676  0.585
66662221  0.661  0.701  0.728  0.657
66662222  0.707  0.827  0.680  0.747
66662223  0.877  0.845  0.796  0.832
66662224  0.601  0.641  0.556  0.518
66662225  0.652  0.773  0.644  0.767
66662226  0.821  0.799  0.688  0.745
66662227  0.710  0.915  0.724  0.654
66662228  0.730  0.899  0.876  0.826
66662229  0.634  0.743  0.508  0.563
66662230  0.764  0.615  0.548  0.581
66662231  0.628  0.915  0.876  0.797
66662232  0.764  0.911  0.584  0.655
66662233  0.700  0.663  0.476  0.646
66662234  0.649  0.773  0.564  0.783
66662235  0.727  0.371  0.692  0.428
66662236  0.861  0.861  0.780  0.864
66662237  0.724  0.849  0.492  0.494
66662238  0.825  0.687  0.862  0.711
66662239  0.700  0.833  0.552  0.778
66662240  0.640  0.717  0.528  0.495
66662241  0.828  0.711  0.768  0.741
66662242  0.585  0.639  0.536  0.634
66662243  0.704  0.915  0.620  0.778
66662244  0.765  0.817  0.776  0.718
66662245  0.725  0.827  0.744  0.672
66662246  0.810  0.849  0.828  0.793
66662247  0.606  0.775  0.568  0.721
66662248  0.659  0.667  0.698  0.719
66662249  0.670  0.749  0.572  0.695
66662250  0.655  0.766  0.776  0.773
66662251  0.792  0.897  0.776  0.779
66642617  0.770  0.923  0.752  0.791
66660051  0.894  0.885  0.920  0.724
66661848  0.895  0.839  0.900  0.724
66662073  0.834  0.976  0.756  0.849
66662252  0.603  0.657  0.156  0.479
66662253  0.771  0.867  0.644  0.603
66662254  0.722  0.843  0.596  0.637
66662255  0.780  0.909  0.584  0.729
66662256  0.770  0.749  0.572  0.669
66662257  0.910  0.827  0.808  0.895
66662258  0.700  0.754  0.548  0.627
66662259  0.755  0.905  0.656  0.669
66662260  0.737  0.915  0.548  0.773
66662261  0.828  0.857  0.636  0.679
66662262  0.976  1.000  0.944  0.940
66662263  0.755  0.743  0.620  0.582
66662264  0.882  0.864  0.804  0.807
66662265  0.752  0.809  0.556  0.650
66662266  0.794  0.867  0.864  0.808
66662267  0.688  0.691  0.512  0.655
66662268  0.794  0.939  0.856  0.778
66662269  0.768  0.955  0.600  0.822
66662270  0.658  0.821  0.656  0.625
66662271  0.934  0.933  0.868  0.841
66662272  0.652  0.839  0.640  0.762
66662273  0.888  0.867  0.664  0.702
66662274  0.767  0.755  0.640  0.681
66662275  0.937  0.957  0.688  0.856
66662276  0.746  0.721  0.584  0.632
66662277  0.843  0.867  0.860  0.766
66662279  0.888  0.924  0.908  0.825
66662280  0.682  0.321  0.326  0.505
66662281  0.774  0.976  0.808  0.795
66662282  0.585  0.589  0.484  0.474
66662284  0.591  0.697  0.644  0.650
66662285  0.783  0.767  0.596  0.678
66662286  0.710  0.957  0.860  0.717
66662287  0.960  1.000  0.856  0.845
66662288  0.661  0.839  0.812  0.572
66662289  0.743  0.660  0.648  0.657
66662291  0.604  0.871  0.700  0.632
66662292  0.788  0.921  0.776  0.689
66662293  0.664  0.893  0.588  0.656
66662294  0.646  0.615  0.436  0.431
66662926  0.834  0.846  0.616  0.800
66642392  0.664  0.805  0.408  0.538
66642950  0.792  0.955  0.864  0.841
66660068  0.764  0.936  0.684  0.701
66661657  0.752  0.749  0.804  0.709
66661694  0.794  0.879  0.700  0.781
66661695  0.704  0.879  0.644  0.698
66661859  0.819  0.939  0.764  0.809
66662062  0.819  0.976  0.788  0.878
66662295  0.744  0.800  0.668  0.835
66662296  0.719  0.887  0.536  0.657
66662297  0.764  0.776  0.756  0.805
66662298  0.815  0.675  0.592  0.645
66662300  0.776  0.908  0.664  0.661
66662301  0.682  0.717  0.504  0.499
66662302  0.806  0.862  0.700  0.629
66662303  0.748  0.543  0.508  0.496
66662304  0.785  0.911  0.540  0.684
66662305  0.777  0.892  0.644  0.663
66662306  0.694  0.727  0.596  0.574
66662307  0.728  0.849  0.700  0.672
66662308  0.955  0.749  0.644  0.817
66662309  0.891  0.879  0.556  0.690
66662310  0.691  0.875  0.656  0.652
66662311  0.728  0.773  0.564  0.812
66662312  0.670  0.775  0.500  0.436
66662313  0.786  0.691  0.640  0.715
66662314  0.794  0.899  0.776  0.626
66662316  0.610  0.255  0.508  0.468
66662317  0.732  0.712  0.536  0.668
66662318  0.810  0.933  0.568  0.716
66662319  0.729  0.604  0.662  0.652
66662320  0.879  0.767  0.620  0.801
66662321  0.776  0.879  0.692  0.673
66662322  0.791  0.843  0.644  0.558
66662323  0.762  0.701  0.668  0.685
66662324  0.779  0.899  0.544  0.762
66662325  0.776  0.342  0.552  0.680
66662326  0.742  0.806  0.572  0.596
66662327  0.721  0.727  0.640  0.649
66662328  0.758  0.839  0.588  0.682
66662329  0.732  0.870  0.812  0.856
66662330  0.661  0.551  0.532  0.673
66662331  0.733  0.727  0.628  0.734
66662332  0.836  0.871  0.648  0.604
66662333  0.730  0.709  0.564  0.618
66662334  0.752  0.846  0.600  0.656
66662335  0.828  0.821  0.592  0.701
平均值       0.752  0.800  0.658  0.697
2022-05-17 17:33:04.805 | INFO     | __main__:<module>:24 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   65.0
单项目标未达成人数       33   24.0   93.0   73.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-17 17:33:04.809 | INFO     | __main__:<module>:25 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  47.10%
单项目标未达成人数    23.91%  17.39%  67.39%  52.90%
2022-05-17 17:33:04.812 | INFO     | __main__:<module>:26 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-17 17:41:05.913 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:41:06.397 | INFO     | src.get_info:read_sheet:119 - 出现异常
2022-05-17 17:41:06.398 | INFO     | __main__:<module>:31 - 出现异常
2022-05-17 17:43:17.931 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:43:18.430 | INFO     | src.get_info:read_sheet:119 - 出现异常
2022-05-17 17:43:18.430 | INFO     | __main__:<module>:31 - 出现异常
2022-05-17 17:43:58.212 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:43:58.696 | INFO     | src.get_info:read_sheet:119 - 出现异常
2022-05-17 17:43:58.696 | INFO     | __main__:<module>:31 - 出现异常
2022-05-17 17:45:22.993 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:45:23.495 | INFO     | __main__:<module>:31 - 出现异常
2022-05-17 17:47:00.789 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:47:01.292 | INFO     | src.get_info:read_sheet:119 - 出现异常
2022-05-17 17:47:01.292 | INFO     | __main__:<module>:31 - 出现异常
2022-05-17 17:47:31.845 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:47:32.339 | INFO     | src.get_info:read_sheet:120 - 出现异常
2022-05-17 17:47:32.339 | INFO     | __main__:<module>:31 - 出现异常
2022-05-17 17:48:51.504 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 17:48:51.994 | INFO     | src.get_info:read_sheet:120 - 出现异常
2022-05-17 17:48:51.994 | INFO     | __main__:<module>:31 - 出现异常
2022-05-17 18:15:13.027 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:15:13.499 | DEBUG    | src.function:operate_object_sheet:124 - 课程目标个数不一致
2022-05-17 18:15:13.499 | ERROR    | src.function:operate_object_sheet:125 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001EB62FD3740>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001EB65F89820>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001EB65F870D0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000001EB63BC14F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000001EB6398C810>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000001EB639948B0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001EB663644F0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000001EB63994940>
           └ <pandas.core.indexing._LocIndexer object at 0x000001EB663644F0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000001EB62FE0C10>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000001EB62FE0F70>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000001EB62FE0EE0>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000001EB62FDD430>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 18:15:13.636 | INFO     | src.get_info:read_sheet:117 - 出现异常
2022-05-17 18:21:29.968 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:21:30.454 | DEBUG    | src.function:operate_object_sheet:128 - 课程目标个数不一致
2022-05-17 18:21:30.454 | ERROR    | src.function:operate_object_sheet:129 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x00000183A2022800>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000183A4FD8820>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000183A4FD60D0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 122, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x00000183A2C104F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x00000183A29DC860>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x00000183A29E48B0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000183A53D39A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x00000183A29E4940>
           └ <pandas.core.indexing._LocIndexer object at 0x00000183A53D39A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x00000183A2031C10>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x00000183A2031F70>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x00000183A2031EE0>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x00000183A202D430>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 18:21:30.593 | INFO     | src.get_info:read_sheet:117 - 出现异常
2022-05-17 18:21:52.345 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:21:52.821 | DEBUG    | src.function:operate_object_sheet:128 - 课程目标个数不一致
2022-05-17 18:21:52.821 | ERROR    | src.function:operate_object_sheet:129 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001D6C0FA3680>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001D6C3F58820>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001D6C3F560D0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 122, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000001D6C1B904F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000001D6C195D770>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000001D6C19648B0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001D6C4338180>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000001D6C1964940>
           └ <pandas.core.indexing._LocIndexer object at 0x000001D6C4338180>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000001D6C0FB0C10>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000001D6C0FB0F70>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000001D6C0FB0EE0>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000001D6C0FAD430>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 18:21:52.955 | INFO     | src.get_info:read_sheet:117 - 出现异常
2022-05-17 18:28:06.876 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:29:17.149 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:29:17.621 | ERROR    | src.function:operate_object_sheet:128 -        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
题号                                          ...                                    
小题分数   10  10.0  2.0  8.0  10.0  10.0  2.0  ...  5.0  5.0  5.0  5.0  5.0  5.0  10.0
课程目标1   1   1.0  0.0  0.0   0.0   0.0  0.0  ...  0.0  0.0  0.0  0.0  0.0  0.0   0.0
课程目标3   0   0.0  0.0  0.0   0.0   0.0  0.0  ...  0.0  1.0  0.0  1.0  0.0  1.0   0.0
课程目标4   0   0.0  0.0  1.0   1.0   1.0  0.0  ...  0.0  0.0  0.0  0.0  0.0  0.0   1.0

[4 rows x 15 columns]
NoneType: None
2022-05-17 18:30:13.111 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:30:13.584 | ERROR    | src.function:operate_object_sheet:128 -        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
题号                                          ...                                    
小题分数   10  10.0  2.0  8.0  10.0  10.0  2.0  ...  5.0  5.0  5.0  5.0  5.0  5.0  10.0
课程目标1   1   1.0  0.0  0.0   0.0   0.0  0.0  ...  0.0  0.0  0.0  0.0  0.0  0.0   0.0
课程目标3   0   0.0  0.0  0.0   0.0   0.0  0.0  ...  0.0  1.0  0.0  1.0  0.0  1.0   0.0
课程目标4   0   0.0  0.0  1.0   1.0   1.0  0.0  ...  0.0  0.0  0.0  0.0  0.0  0.0   1.0

[4 rows x 15 columns]
NoneType: None
2022-05-17 18:30:13.595 | ERROR    | src.function:operate_object_sheet:129 - 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
课程目标达成情况评价报告                        
随堂测验           0.1   0.1   0.1   0.1
作业             0.2     0   0.3   0.2
实验               0   0.3     0   0.2
考试             0.7   0.6   0.6   0.5
NoneType: None
2022-05-17 18:30:42.541 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:30:43.014 | ERROR    | src.function:operate_object_sheet:128 - Index(['小题分数', '课程目标1', '课程目标3', '课程目标4'], dtype='object', name='题号')
NoneType: None
2022-05-17 18:30:43.015 | ERROR    | src.function:operate_object_sheet:129 - Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
NoneType: None
2022-05-17 18:31:49.123 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:31:49.584 | DEBUG    | src.function:operate_object_sheet:133 - 课程目标个数不一致
2022-05-17 18:31:49.584 | ERROR    | src.function:operate_object_sheet:134 - unhashable type: 'Index'
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002CDA80599D0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002CDA8056280>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 128, in operate_object_sheet
    logger.exception(df_test_weight.columns not in object_parameter.index)
    │      │         │              │              │                └ <pandas._libs.properties.AxisProperty object at 0x000002CDA5C903A0>
    │      │         │              │              └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
    │      │         │              │                题号                                       ...
    │      │         │              └ <pandas._libs.properties.AxisProperty object at 0x000002CDA5C904F0>
    │      │         └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
    │      │           课程目标达成情况评价报告                        
    │      │           随堂测验           0.1   0.1   0.1   0.1
    │      │           作业            ...
    │      └ <function Logger.exception at 0x000002CDA803A940>
    └ <loguru.logger handlers=[(id=1, level=10, sink='../log/原表修改_log.log')]>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 4265, in __contains__
    hash(key)
         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 4273, in __hash__
    raise TypeError(f"unhashable type: {repr(type(self).__name__)}")

TypeError: unhashable type: 'Index'
2022-05-17 18:31:49.695 | DEBUG    | src.function:operate_object_sheet:133 - 课程目标个数不一致
2022-05-17 18:31:49.695 | ERROR    | src.function:operate_object_sheet:134 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000002CDA50A4580>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002CDA80599D0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002CDA8056280>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 123, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000002CDA5C904F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000002CDA5A5F680>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000002CDA5A648B0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002CDA84C2860>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000002CDA5A64940>
           └ <pandas.core.indexing._LocIndexer object at 0x000002CDA84C2860>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000002CDA50B0C10>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000002CDA50B0F70>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000002CDA50B0EE0>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000002CDA50AD430>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 18:31:49.811 | INFO     | src.get_info:read_sheet:117 - 出现异常
2022-05-17 18:32:20.406 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:32:20.880 | ERROR    | src.function:operate_object_sheet:128 - Index(['小题分数', '课程目标1', '课程目标3', '课程目标4'], dtype='object', name='题号')
NoneType: None
2022-05-17 18:32:20.881 | ERROR    | src.function:operate_object_sheet:129 - Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
NoneType: None
2022-05-17 18:32:55.572 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:32:56.051 | ERROR    | src.function:operate_object_sheet:129 - True
NoneType: None
2022-05-17 18:34:02.443 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:34:02.905 | DEBUG    | src.function:operate_object_sheet:134 - 课程目标个数不一致
2022-05-17 18:34:02.905 | ERROR    | src.function:operate_object_sheet:135 - unsupported operand type(s) for -: 'list' and 'list'
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000018C16E099D0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000018C16E06280>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 129, in operate_object_sheet
    logger.exception(list(df_test_weight.columns) - list(object_parameter.index))
    │      │              │              │               │                └ <pandas._libs.properties.AxisProperty object at 0x0000018C14A303A0>
    │      │              │              │               └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
    │      │              │              │                 题号                                       ...
    │      │              │              └ <pandas._libs.properties.AxisProperty object at 0x0000018C14A304F0>
    │      │              └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
    │      │                课程目标达成情况评价报告                        
    │      │                随堂测验           0.1   0.1   0.1   0.1
    │      │                作业            ...
    │      └ <function Logger.exception at 0x0000018C16DEA940>
    └ <loguru.logger handlers=[(id=1, level=10, sink='../log/原表修改_log.log')]>

TypeError: unsupported operand type(s) for -: 'list' and 'list'
2022-05-17 18:34:03.019 | DEBUG    | src.function:operate_object_sheet:134 - 课程目标个数不一致
2022-05-17 18:34:03.020 | ERROR    | src.function:operate_object_sheet:135 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000018C7FE436C0>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000018C16E099D0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000018C16E06280>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 123, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x0000018C14A304F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x0000018C1482F630>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x0000018C148348B0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000018C15A8F2C0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x0000018C14834940>
           └ <pandas.core.indexing._LocIndexer object at 0x0000018C15A8F2C0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x0000018C7FE50C10>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x0000018C7FE50F70>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x0000018C7FE50EE0>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x0000018C7FE4D430>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 18:34:03.142 | INFO     | src.get_info:read_sheet:117 - 出现异常
2022-05-17 18:35:11.662 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:35:12.135 | ERROR    | src.function:operate_object_sheet:129 - <generator object operate_object_sheet.<locals>.<genexpr> at 0x0000014B144BF5F0>
NoneType: None
2022-05-17 18:36:58.276 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:36:58.746 | ERROR    | src.function:operate_object_sheet:129 - <generator object operate_object_sheet.<locals>.<genexpr> at 0x000001E1A456F5F0>
NoneType: None
2022-05-17 18:37:04.834 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:37:05.298 | ERROR    | src.function:operate_object_sheet:129 - <generator object operate_object_sheet.<locals>.<genexpr> at 0x00000157243C05F0>
NoneType: None
2022-05-17 18:38:03.918 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:38:04.384 | ERROR    | src.function:operate_object_sheet:129 - <generator object operate_object_sheet.<locals>.<genexpr> at 0x000001DF14D805F0>
NoneType: None
2022-05-17 18:38:46.335 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:38:46.815 | ERROR    | src.function:operate_object_sheet:128 - ['小题分数', '课程目标1', '课程目标3', '课程目标4']
NoneType: None
2022-05-17 18:38:46.815 | ERROR    | src.function:operate_object_sheet:129 - ['课程目标1', '课程目标2', '课程目标3', '课程目标4']
NoneType: None
2022-05-17 18:41:20.573 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:41:21.035 | ERROR    | src.function:operate_object_sheet:128 - {'课程目标1', '小题分数', '课程目标4', '课程目标3'}
NoneType: None
2022-05-17 18:41:21.035 | ERROR    | src.function:operate_object_sheet:129 - {'课程目标1', '课程目标4', '课程目标2', '课程目标3'}
NoneType: None
2022-05-17 18:42:59.862 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 18:43:00.329 | ERROR    | src.function:operate_object_sheet:130 - {'课程目标2'}
NoneType: None
2022-05-17 22:16:01.246 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:16:01.723 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:16:01.723 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001EAFBB37A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001EAFBB39310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000001EAFBB31550>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 56, in check_target_num
    if df_test_weight.columns == object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000001EAF97704F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__eq__ at 0x000001EAF8961EE0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 29, in __eq__
    return self._cmp_method(other, operator.eq)
           │    │           │      │        └ <built-in function eq>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000001EAF977ACA0>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x000001EAF88FCD30>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000001EAFBFF2940>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:16:02.044 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:16:02.044 | ERROR    | src.function:operate_object_sheet:128 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001EAF8B84580>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001EAFBB37A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001EAFBB39310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 114, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000001EAF97704F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000001EAF953D770>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000001EAF95448B0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001EAFC098450>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000001EAF9544940>
           └ <pandas.core.indexing._LocIndexer object at 0x000001EAFC098450>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000001EAF8B90C10>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000001EAF8B90F70>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000001EAF8B90EE0>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000001EAF8B8D430>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:16:02.164 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:16:02.164 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 7: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001EAFBB37A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001EAFBB39310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └         1   2  3   4   5  6   7
       │          │                  题号                             
       │          │                  小题分数   20  20  5  15  20  5  15
       │          │                  课程目标1   0   0  0   0   0  0  ...
       │          └ <function check_target_num at 0x000001EAFBB31550>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 56, in check_target_num
    if df_test_weight.columns == object_parameter:
       │              │          └        1  2  3  4  5  6  7
       │              │            题号                        
       │              │            课程目标1  0  0  0  0  0  0  0
       │              │            课程目标2  0  0  1  0  0  1  0
       │              │            课程目标3  0  0  0  0...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000001EAF97704F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1  2  3  4  5  6  7
           │        题号                        
           │        课程目标1  0  0  0  0  0  0  0
           │        课程目标2  0  0  1  0  0  1  0
           │        课程目标3  0  0  0  0...
           └ <function OpsMixin.__eq__ at 0x000001EAF8961EE0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 29, in __eq__
    return self._cmp_method(other, operator.eq)
           │    │           │      │        └ <built-in function eq>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000001EAF977ACA0>
           └        1  2  3  4  5  6  7
             题号                        
             课程目标1  0  0  0  0  0  0  0
             课程目标2  0  0  1  0  0  1  0
             课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1  2  3  4  5  6  7
    │             │   │                    题号                        
    │             │   │                    课程目标1  0  0  0  0  0  0  0
    │             │   │                    课程目标2  0  0  1  0  0  1  0
    │             │   │                    课程目标3  0  0  0  0...
    │             │   └ <function align_method_FRAME at 0x000001EAF88FCD30>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1  2  3  4  5  6  7
      题号                        
      课程目标1  0  0  0  0  0  0  0
      课程目标2  0  0  1  0  0  1  0
      课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000001EAFBFF2940>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 7: given 4
2022-05-17 22:16:02.279 | INFO     | src.get_info:read_sheet:117 - 出现异常
2022-05-17 22:17:31.404 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:17:31.879 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:17:31.879 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000028760F88AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000028760F863A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x0000028760F815E0>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 56, in check_target_num
    if df_test_weight.columns == object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000002875EBC04F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__eq__ at 0x000002875DDB0EE0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 29, in __eq__
    return self._cmp_method(other, operator.eq)
           │    │           │      │        └ <built-in function eq>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000002875EBCACA0>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x000002875DD4CD30>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x00000287611CB9D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:17:32.056 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:17:32.056 | ERROR    | src.function:operate_object_sheet:128 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000002875DFD4580>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000028760F88AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000028760F863A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 114, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000002875EBC04F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000002875E98D720>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000002875E9948B0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002876168DC70>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000002875E994940>
           └ <pandas.core.indexing._LocIndexer object at 0x000002876168DC70>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000002875DFE0C10>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000002875DFE0F70>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000002875DFE0EE0>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000002875DFDD430>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:17:32.177 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:17:32.177 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 7: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000028760F88AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000028760F863A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └         1   2  3   4   5  6   7
       │          │                  题号                             
       │          │                  小题分数   20  20  5  15  20  5  15
       │          │                  课程目标1   0   0  0   0   0  0  ...
       │          └ <function check_target_num at 0x0000028760F815E0>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 56, in check_target_num
    if df_test_weight.columns == object_parameter:
       │              │          └        1  2  3  4  5  6  7
       │              │            题号                        
       │              │            课程目标1  0  0  0  0  0  0  0
       │              │            课程目标2  0  0  1  0  0  1  0
       │              │            课程目标3  0  0  0  0...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000002875EBC04F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1  2  3  4  5  6  7
           │        题号                        
           │        课程目标1  0  0  0  0  0  0  0
           │        课程目标2  0  0  1  0  0  1  0
           │        课程目标3  0  0  0  0...
           └ <function OpsMixin.__eq__ at 0x000002875DDB0EE0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 29, in __eq__
    return self._cmp_method(other, operator.eq)
           │    │           │      │        └ <built-in function eq>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000002875EBCACA0>
           └        1  2  3  4  5  6  7
             题号                        
             课程目标1  0  0  0  0  0  0  0
             课程目标2  0  0  1  0  0  1  0
             课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1  2  3  4  5  6  7
    │             │   │                    题号                        
    │             │   │                    课程目标1  0  0  0  0  0  0  0
    │             │   │                    课程目标2  0  0  1  0  0  1  0
    │             │   │                    课程目标3  0  0  0  0...
    │             │   └ <function align_method_FRAME at 0x000002875DD4CD30>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1  2  3  4  5  6  7
      题号                        
      课程目标1  0  0  0  0  0  0  0
      课程目标2  0  0  1  0  0  1  0
      课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x00000287611CB9D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 7: given 4
2022-05-17 22:17:32.294 | INFO     | src.get_info:read_sheet:117 - 出现异常
2022-05-17 22:18:02.717 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:18:03.206 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:18:03.206 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000241AFCD8AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000241AFCD63A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x00000241AFCD15E0>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns == object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x00000241AD9104F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__eq__ at 0x00000241ACB00EE0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 29, in __eq__
    return self._cmp_method(other, operator.eq)
           │    │           │      │        └ <built-in function eq>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x00000241AD91ACA0>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x00000241ACA9CD30>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x00000241AFF1AA60>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:18:03.383 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:18:03.383 | ERROR    | src.function:operate_object_sheet:128 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x00000241ACD23640>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000241AFCD8AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000241AFCD63A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 114, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x00000241AD9104F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x00000241AD6DF680>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x00000241AD6E48B0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000241B0062A90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x00000241AD6E4940>
           └ <pandas.core.indexing._LocIndexer object at 0x00000241B0062A90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x00000241ACD30C10>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x00000241ACD30F70>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x00000241ACD30EE0>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x00000241ACD2D430>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:18:03.509 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:18:03.509 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 7: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000241AFCD8AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000241AFCD63A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └         1   2  3   4   5  6   7
       │          │                  题号                             
       │          │                  小题分数   20  20  5  15  20  5  15
       │          │                  课程目标1   0   0  0   0   0  0  ...
       │          └ <function check_target_num at 0x00000241AFCD15E0>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns == object_parameter:
       │              │          └        1  2  3  4  5  6  7
       │              │            题号                        
       │              │            课程目标1  0  0  0  0  0  0  0
       │              │            课程目标2  0  0  1  0  0  1  0
       │              │            课程目标3  0  0  0  0...
       │              └ <pandas._libs.properties.AxisProperty object at 0x00000241AD9104F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1  2  3  4  5  6  7
           │        题号                        
           │        课程目标1  0  0  0  0  0  0  0
           │        课程目标2  0  0  1  0  0  1  0
           │        课程目标3  0  0  0  0...
           └ <function OpsMixin.__eq__ at 0x00000241ACB00EE0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 29, in __eq__
    return self._cmp_method(other, operator.eq)
           │    │           │      │        └ <built-in function eq>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x00000241AD91ACA0>
           └        1  2  3  4  5  6  7
             题号                        
             课程目标1  0  0  0  0  0  0  0
             课程目标2  0  0  1  0  0  1  0
             课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1  2  3  4  5  6  7
    │             │   │                    题号                        
    │             │   │                    课程目标1  0  0  0  0  0  0  0
    │             │   │                    课程目标2  0  0  1  0  0  1  0
    │             │   │                    课程目标3  0  0  0  0...
    │             │   └ <function align_method_FRAME at 0x00000241ACA9CD30>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1  2  3  4  5  6  7
      题号                        
      课程目标1  0  0  0  0  0  0  0
      课程目标2  0  0  1  0  0  1  0
      课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x00000241AFF1AA60>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 7: given 4
2022-05-17 22:18:03.624 | INFO     | src.get_info:read_sheet:117 - 出现异常
2022-05-17 22:18:23.993 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:18:24.467 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:18:24.467 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001FF35F98AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001FF35F963A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000001FF35F915E0>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000001FF33BD04F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__ne__ at 0x000001FF32DCA040>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000001FF33BDACA0>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x000001FF32D5CD30>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000001FF361DCA60>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:18:24.640 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:18:24.640 | ERROR    | src.function:operate_object_sheet:128 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001FF32FE3700>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001FF35F98AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001FF35F963A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 114, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000001FF33BD04F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000001FF3399D770>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000001FF339A48B0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001FF36228AE0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000001FF339A4940>
           └ <pandas.core.indexing._LocIndexer object at 0x000001FF36228AE0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000001FF32FF0C10>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000001FF32FF0F70>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000001FF32FF0EE0>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000001FF32FED430>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:18:24.765 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:18:24.765 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 7: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001FF35F98AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001FF35F963A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └         1   2  3   4   5  6   7
       │          │                  题号                             
       │          │                  小题分数   20  20  5  15  20  5  15
       │          │                  课程目标1   0   0  0   0   0  0  ...
       │          └ <function check_target_num at 0x000001FF35F915E0>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1  2  3  4  5  6  7
       │              │            题号                        
       │              │            课程目标1  0  0  0  0  0  0  0
       │              │            课程目标2  0  0  1  0  0  1  0
       │              │            课程目标3  0  0  0  0...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000001FF33BD04F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1  2  3  4  5  6  7
           │        题号                        
           │        课程目标1  0  0  0  0  0  0  0
           │        课程目标2  0  0  1  0  0  1  0
           │        课程目标3  0  0  0  0...
           └ <function OpsMixin.__ne__ at 0x000001FF32DCA040>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000001FF33BDACA0>
           └        1  2  3  4  5  6  7
             题号                        
             课程目标1  0  0  0  0  0  0  0
             课程目标2  0  0  1  0  0  1  0
             课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1  2  3  4  5  6  7
    │             │   │                    题号                        
    │             │   │                    课程目标1  0  0  0  0  0  0  0
    │             │   │                    课程目标2  0  0  1  0  0  1  0
    │             │   │                    课程目标3  0  0  0  0...
    │             │   └ <function align_method_FRAME at 0x000001FF32D5CD30>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1  2  3  4  5  6  7
      题号                        
      课程目标1  0  0  0  0  0  0  0
      课程目标2  0  0  1  0  0  1  0
      课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000001FF361DCA60>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 7: given 4
2022-05-17 22:18:24.879 | INFO     | src.get_info:read_sheet:117 - 出现异常
2022-05-17 22:19:15.212 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:19:15.685 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:19:15.685 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001D5377F9B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001D5377F7430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000001D5377F2670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000001D5354314F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__ne__ at 0x000001D53462C0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000001D53543AD30>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x000001D5345BDDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000001D537A38A60>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:19:15.861 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:19:15.861 | ERROR    | src.function:operate_object_sheet:128 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001D5348427C0>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001D5377F9B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001D5377F7430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 114, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000001D5354314F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000001D5351FD860>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000001D535205940>
           └ <pandas.core.indexing._LocIndexer object at 0x000001D537D727C0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000001D5352059D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001D537D727C0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000001D534850CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000001D534852040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000001D534850F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000001D53484D4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:19:15.985 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:19:15.985 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 7: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001D5377F9B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001D5377F7430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └         1   2  3   4   5  6   7
       │          │                  题号                             
       │          │                  小题分数   20  20  5  15  20  5  15
       │          │                  课程目标1   0   0  0   0   0  0  ...
       │          └ <function check_target_num at 0x000001D5377F2670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1  2  3  4  5  6  7
       │              │            题号                        
       │              │            课程目标1  0  0  0  0  0  0  0
       │              │            课程目标2  0  0  1  0  0  1  0
       │              │            课程目标3  0  0  0  0...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000001D5354314F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1  2  3  4  5  6  7
           │        题号                        
           │        课程目标1  0  0  0  0  0  0  0
           │        课程目标2  0  0  1  0  0  1  0
           │        课程目标3  0  0  0  0...
           └ <function OpsMixin.__ne__ at 0x000001D53462C0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000001D53543AD30>
           └        1  2  3  4  5  6  7
             题号                        
             课程目标1  0  0  0  0  0  0  0
             课程目标2  0  0  1  0  0  1  0
             课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1  2  3  4  5  6  7
    │             │   │                    题号                        
    │             │   │                    课程目标1  0  0  0  0  0  0  0
    │             │   │                    课程目标2  0  0  1  0  0  1  0
    │             │   │                    课程目标3  0  0  0  0...
    │             │   └ <function align_method_FRAME at 0x000001D5345BDDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1  2  3  4  5  6  7
      题号                        
      课程目标1  0  0  0  0  0  0  0
      课程目标2  0  0  1  0  0  1  0
      课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000001D537A38A60>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 7: given 4
2022-05-17 22:19:16.108 | ERROR    | __main__:<module>:18 - An error has been caught in function '<module>', process 'MainProcess' (10640), thread 'MainThread' (22204):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001D5377F9B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 106, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x000001D5377F93A0>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
                                              │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                              │        │                       │                │   │                 │     考核方式                                                          ...
                                              │        │                       │                │   │                 └ 0
                                              │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                       │                │     参数设置                                   ...
                                              │        │                       │                └ 0
                                              │        │                       └ [       1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                              │        │                         题号                                         ...
                                              │        └ <function count_object_evaluation at 0x000001D5377F7820>
                                              └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 145, in count_object_evaluation
    df_scores = single_scores.dot(count_param.T)
                │             │   │           └ <property object at 0x000001D53542AEF0>
                │             │   └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                │             │     考核方式                                       ....
                │             └ <function DataFrame.dot at 0x000001D5354350D0>
                └           1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                  参数设置                                    ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 1244, in dot
    raise ValueError("matrices are not aligned")

ValueError: matrices are not aligned
2022-05-17 22:21:26.027 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:21:26.499 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:21:26.499 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002A841F09A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002A841F08310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000002A841F01550>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000002A83FB404F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__ne__ at 0x000002A83ED3B0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000002A83FB49D30>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x000002A83ECCCDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000002A84214B9D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:21:26.676 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:21:26.676 | ERROR    | src.function:operate_object_sheet:128 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000002A83EF53640>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002A841F09A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002A841F08310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 114, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000002A83FB404F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000002A83F90D860>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000002A83F915940>
           └ <pandas.core.indexing._LocIndexer object at 0x000002A842682220>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000002A83F9159D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002A842682220>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000002A83EF60CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000002A83EF62040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000002A83EF60F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000002A83EF5D4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:21:26.796 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:21:26.796 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 7: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002A841F09A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002A841F08310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └         1   2  3   4   5  6   7
       │          │                  题号                             
       │          │                  小题分数   20  20  5  15  20  5  15
       │          │                  课程目标1   0   0  0   0   0  0  ...
       │          └ <function check_target_num at 0x000002A841F01550>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1  2  3  4  5  6  7
       │              │            题号                        
       │              │            课程目标1  0  0  0  0  0  0  0
       │              │            课程目标2  0  0  1  0  0  1  0
       │              │            课程目标3  0  0  0  0...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000002A83FB404F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1  2  3  4  5  6  7
           │        题号                        
           │        课程目标1  0  0  0  0  0  0  0
           │        课程目标2  0  0  1  0  0  1  0
           │        课程目标3  0  0  0  0...
           └ <function OpsMixin.__ne__ at 0x000002A83ED3B0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000002A83FB49D30>
           └        1  2  3  4  5  6  7
             题号                        
             课程目标1  0  0  0  0  0  0  0
             课程目标2  0  0  1  0  0  1  0
             课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1  2  3  4  5  6  7
    │             │   │                    题号                        
    │             │   │                    课程目标1  0  0  0  0  0  0  0
    │             │   │                    课程目标2  0  0  1  0  0  1  0
    │             │   │                    课程目标3  0  0  0  0...
    │             │   └ <function align_method_FRAME at 0x000002A83ECCCDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1  2  3  4  5  6  7
      题号                        
      课程目标1  0  0  0  0  0  0  0
      课程目标2  0  0  1  0  0  1  0
      课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000002A84214BAF0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 7: given 4
2022-05-17 22:21:26.911 | ERROR    | __main__:<module>:18 - An error has been caught in function '<module>', process 'MainProcess' (10220), thread 'MainThread' (5900):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002A841F09A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 106, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x000002A841F09280>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
                                              │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                              │        │                       │                │   │                 │     考核方式                                                          ...
                                              │        │                       │                │   │                 └ 0
                                              │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                       │                │     参数设置                                   ...
                                              │        │                       │                └ 0
                                              │        │                       └ [       1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                              │        │                         题号                                         ...
                                              │        └ <function count_object_evaluation at 0x000002A841F08700>
                                              └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 145, in count_object_evaluation
    df_scores = single_scores.dot(count_param.T)
                │             │   │           └ <property object at 0x000002A83FB39EA0>
                │             │   └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                │             │     考核方式                                       ....
                │             └ <function DataFrame.dot at 0x000002A83FB440D0>
                └           1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                  参数设置                                    ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 1244, in dot
    raise ValueError("matrices are not aligned")

ValueError: matrices are not aligned
2022-05-17 22:24:01.765 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:24:02.234 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:24:02.234 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002090CB7AA60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002090CB79310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000002090CB71550>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000002097FF904F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__ne__ at 0x000002097F98B0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000002097FF99D30>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x000002097F91DDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000002090CDBB9D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:24:02.410 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:24:02.410 | ERROR    | src.function:operate_object_sheet:128 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000002097FBA36C0>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002090CB7AA60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002090CB79310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 116, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000002097FF904F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000002097FD5E7C0>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000002097FD65940>
           └ <pandas.core.indexing._LocIndexer object at 0x000002090D0CB9F0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000002097FD659D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002090D0CB9F0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000002097FBB0CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000002097FBB2040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000002097FBB0F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000002097FBAD4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:24:02.530 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:24:02.530 | ERROR    | src.function:operate_object_sheet:128 - Unable to coerce to Series, length must be 7: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002090CB7AA60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002090CB79310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └         1   2  3   4   5  6   7
       │          │                  题号                             
       │          │                  小题分数   20  20  5  15  20  5  15
       │          │                  课程目标1   0   0  0   0   0  0  ...
       │          └ <function check_target_num at 0x000002090CB71550>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1  2  3  4  5  6  7
       │              │            题号                        
       │              │            课程目标1  0  0  0  0  0  0  0
       │              │            课程目标2  0  0  1  0  0  1  0
       │              │            课程目标3  0  0  0  0...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000002097FF904F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1  2  3  4  5  6  7
           │        题号                        
           │        课程目标1  0  0  0  0  0  0  0
           │        课程目标2  0  0  1  0  0  1  0
           │        课程目标3  0  0  0  0...
           └ <function OpsMixin.__ne__ at 0x000002097F98B0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000002097FF99D30>
           └        1  2  3  4  5  6  7
             题号                        
             课程目标1  0  0  0  0  0  0  0
             课程目标2  0  0  1  0  0  1  0
             课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1  2  3  4  5  6  7
    │             │   │                    题号                        
    │             │   │                    课程目标1  0  0  0  0  0  0  0
    │             │   │                    课程目标2  0  0  1  0  0  1  0
    │             │   │                    课程目标3  0  0  0  0...
    │             │   └ <function align_method_FRAME at 0x000002097F91DDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1  2  3  4  5  6  7
      题号                        
      课程目标1  0  0  0  0  0  0  0
      课程目标2  0  0  1  0  0  1  0
      课程目标3  0  0  0  0...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000002090CDBBAF0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 7: given 4
2022-05-17 22:24:02.646 | ERROR    | __main__:<module>:18 - An error has been caught in function '<module>', process 'MainProcess' (17508), thread 'MainThread' (19160):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002090CB7AA60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 106, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x000002090CB7A280>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
                                              │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                              │        │                       │                │   │                 │     考核方式                                                          ...
                                              │        │                       │                │   │                 └ 0
                                              │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                       │                │     参数设置                                   ...
                                              │        │                       │                └ 0
                                              │        │                       └ [       1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                              │        │                         题号                                         ...
                                              │        └ <function count_object_evaluation at 0x000002090CB79700>
                                              └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 145, in count_object_evaluation
    df_scores = single_scores.dot(count_param.T)
                │             │   │           └ <property object at 0x000002097FF89E50>
                │             │   └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                │             │     考核方式                                       ....
                │             └ <function DataFrame.dot at 0x000002097FF940D0>
                └           1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                  参数设置                                    ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 1244, in dot
    raise ValueError("matrices are not aligned")

ValueError: matrices are not aligned
2022-05-17 22:24:33.373 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:24:33.843 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:24:33.843 | ERROR    | src.function:operate_object_sheet:128 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x00000296E28A3780>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000296E5859A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000296E5857310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 116, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x00000296E34904F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x00000296E325E720>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x00000296E3265940>
           └ <pandas.core.indexing._LocIndexer object at 0x00000296E5C2F1D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x00000296E32659D0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000296E5C2F1D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x00000296E28B0CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x00000296E28B2040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x00000296E28B0F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x00000296E28AD4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:24:33.970 | ERROR    | __main__:<module>:18 - An error has been caught in function '<module>', process 'MainProcess' (15908), thread 'MainThread' (20032):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000296E5859A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 106, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x00000296E5859280>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
                                              │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                              │        │                       │                │   │                 │     考核方式                                                          ...
                                              │        │                       │                │   │                 └ 0
                                              │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                       │                │     参数设置                                   ...
                                              │        │                       │                └ 0
                                              │        │                       └ [       1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                              │        │                         题号                                         ...
                                              │        └ <function count_object_evaluation at 0x00000296E5857700>
                                              └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 145, in count_object_evaluation
    df_scores = single_scores.dot(count_param.T)
                │             │   │           └ <property object at 0x00000296E3489D60>
                │             │   └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                │             │     考核方式                                       ....
                │             └ <function DataFrame.dot at 0x00000296E347D0D0>
                └           1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                  参数设置                                    ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 1244, in dot
    raise ValueError("matrices are not aligned")

ValueError: matrices are not aligned
2022-05-17 22:24:55.378 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:24:55.845 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:24:55.845 | ERROR    | src.function:operate_object_sheet:128 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001A5BCFA27C0>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001A5BFF59A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001A5BFF57310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 116, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000001A5BDB904F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000001A5BD960680>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000001A5BD965940>
           └ <pandas.core.indexing._LocIndexer object at 0x000001A5C032FB30>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000001A5BD9659D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001A5C032FB30>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000001A5BCFB0CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000001A5BCFB2040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000001A5BCFB0F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000001A5BCFAD4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:26:29.913 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:26:30.379 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:26:30.379 | ERROR    | src.function:operate_object_sheet:130 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x00000259EB941940>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000259EE8F9A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000259EE8F8310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 116, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x00000259EC5304F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x00000259EC300680>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x00000259EC305940>
           └ <pandas.core.indexing._LocIndexer object at 0x00000259EEB87BD0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x00000259EC3059D0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000259EEB87BD0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x00000259EB951CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x00000259EB952040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x00000259EB951F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x00000259EB94D4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:30:14.896 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:30:15.370 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:30:15.370 | ERROR    | src.function:operate_object_sheet:130 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002A8DE8A8AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002A8DE8A63A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000002A8DE8A25E0>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000002A8DC4E04F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__ne__ at 0x000002A8DB6DB0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000002A8DC4E9D30>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x000002A8DB66CDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000002A8DEAE9940>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:30:57.641 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:30:58.111 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:30:58.111 | ERROR    | src.function:operate_object_sheet:130 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000290AC308B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000290AC306430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x00000290AC302670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 58, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │              │            题号                                       ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x00000290A9F404F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
           │        题号                                       ...
           └ <function OpsMixin.__ne__ at 0x00000290A913B0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x00000290A9F49D30>
           └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
             题号                                       ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
    │             │   │                    题号                                       ...
    │             │   └ <function align_method_FRAME at 0x00000290A90CCDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
      题号                                       ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x00000290AC54C940>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:31:13.649 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:31:14.125 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:31:14.125 | ERROR    | src.function:operate_object_sheet:130 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001AA2C978B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001AA2C976430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000001AA2C972670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 59, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000001AA2A5B04F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__ne__ at 0x000001AA297AB0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000001AA2A5B9D30>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x000001AA2973CDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000001AA2CBBFA60>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:31:43.463 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:31:43.958 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:31:43.958 | ERROR    | src.function:operate_object_sheet:130 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002A6E3FD8B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002A6E3FD6430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000002A6E3FD2670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 59, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000002A6E1C104F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__ne__ at 0x000002A6E0E0B0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000002A6E1C18D30>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x000002A6E0D9CDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000002A6E4220CA0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:32:09.488 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:32:09.977 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:32:09.977 | ERROR    | src.function:operate_object_sheet:130 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002291A155B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002291A156430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000002291A152670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 59, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x0000022917D904F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__ne__ at 0x0000022916F8B0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x0000022917D99D30>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x0000022916F1CDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000002291A3424C0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:32:40.218 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:32:40.702 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:32:40.702 | ERROR    | src.function:operate_object_sheet:130 - Unable to coerce to Series, length must be 15: given 4
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002438F018B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002438F016430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000002438F012670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 59, in check_target_num
    if df_test_weight.columns != object_parameter:
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000002438CC504F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\common.py", line 65, in new_method
    return method(self, other)
           │      │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │      └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
           │        题号                                           ...
           └ <function OpsMixin.__ne__ at 0x00000243FFE4B0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\arraylike.py", line 33, in __ne__
    return self._cmp_method(other, operator.ne)
           │    │           │      │        └ <built-in function ne>
           │    │           │      └ <module 'operator' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\operator.py'>
           │    │           └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function DataFrame._cmp_method at 0x000002438CC59D30>
           └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
             题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 5968, in _cmp_method
    self, other = ops.align_method_FRAME(self, other, axis, flex=False, level=None)
    │             │   │                  │     │      └ 1
    │             │   │                  │     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │             │   │                  └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
    │             │   │                    题号                                           ...
    │             │   └ <function align_method_FRAME at 0x00000243FFDDCDC0>
    │             └ <module 'pandas.core.ops' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\core\\ops\\__init__.py'>
    └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
      题号                                           ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 262, in align_method_FRAME
    right = to_series(right)
            │         └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
            └ <function align_method_FRAME.<locals>.to_series at 0x000002438F25C940>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\ops\__init__.py", line 219, in to_series
    raise ValueError(

ValueError: Unable to coerce to Series, length must be 15: given 4
2022-05-17 22:32:55.130 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:32:55.622 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:32:55.622 | ERROR    | src.function:operate_object_sheet:130 - The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000019FBCCC5B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000019FBCCC6430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x0000019FBCCC2670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 59, in check_target_num
    if df_test_weight.columns != object_parameter.index:
       │              │          │                └ <pandas._libs.properties.AxisProperty object at 0x0000019FBA9003A0>
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x0000019FBA9004F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2022-05-17 22:33:34.267 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:33:34.737 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:33:34.737 | ERROR    | src.function:operate_object_sheet:130 - The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001FAA9148B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001FAA9146430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x000001FAA9142670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 56, in check_target_num
    if df_test_weight.columns != object_parameter.index:
       │              │          │                └ <pandas._libs.properties.AxisProperty object at 0x000001FAA6D803A0>
       │              │          └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │            题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x000001FAA6D804F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2022-05-17 22:34:34.230 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:34:34.702 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:34:34.703 | ERROR    | src.function:operate_object_sheet:130 - The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000023DA8168B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000023DA8166430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x0000023DA8162670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 56, in check_target_num
    if df_test_weight.columns.values != object_parameter.index.values:
       │              │                 │                └ <pandas._libs.properties.AxisProperty object at 0x0000023DA5DA03A0>
       │              │                 └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │                   题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x0000023DA5DA04F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2022-05-17 22:34:45.846 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:34:46.318 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:34:46.318 | ERROR    | src.function:operate_object_sheet:130 - The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000201B2148B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000201B2146430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    if check_data.check_target_num(object_parameter, df_test_weight):
       │          │                │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
       │          │                │                   课程目标达成情况评价报告                        
       │          │                │                   随堂测验           0.1   0.1   0.1   0.1
       │          │                │                   作业            ...
       │          │                └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
       │          │                  题号                                       ...
       │          └ <function check_target_num at 0x00000201B2142670>
       └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 56, in check_target_num
    if df_test_weight.columns.values != object_parameter.index.values:
       │              │                 │                └ <pandas._libs.properties.AxisProperty object at 0x00000201AFD803A0>
       │              │                 └        1    2    3    4    5    6    7    8    9    10   11   12   13   14   15
       │              │                   题号                                           ...
       │              └ <pandas._libs.properties.AxisProperty object at 0x00000201AFD804F0>
       └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
         课程目标达成情况评价报告                        
         随堂测验           0.1   0.1   0.1   0.1
         作业            ...

ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2022-05-17 22:35:16.743 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:35:17.217 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-17 22:35:17.217 | ERROR    | src.function:operate_object_sheet:130 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x00000184D7AD3740>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000184DAA99B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000184DAA97430>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 116, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x00000184D86C04F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x00000184D848E770>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x00000184D8495940>
           └ <pandas.core.indexing._LocIndexer object at 0x00000184DB2CB6D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x00000184D84959D0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000184DB2CB6D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x00000184D7AE0CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x00000184D7AE2040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x00000184D7AE0F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x00000184D7ADD4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-17 22:36:25.129 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:36:25.597 | DEBUG    | src.function:operate_object_sheet:121 - 课程目标个数不一致，程序终止
2022-05-17 22:36:25.597 | ERROR    | src.function:operate_object_sheet:122 - 不一致索引
NoneType: None
2022-05-17 22:38:22.117 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:38:22.591 | DEBUG    | src.function:operate_object_sheet:121 - 课程目标个数不一致，程序终止
2022-05-17 22:38:22.592 | ERROR    | src.function:operate_object_sheet:124 - 不一致索引:
NoneType: None
2022-05-17 22:38:50.952 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:38:51.426 | DEBUG    | src.function:operate_object_sheet:121 - 课程目标个数不一致，程序终止
2022-05-17 22:38:51.426 | ERROR    | src.function:operate_object_sheet:125 - 不一致索引:
NoneType: None
2022-05-17 22:39:35.628 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:39:36.101 | DEBUG    | src.function:operate_object_sheet:121 - 课程目标个数不一致，程序终止
2022-05-17 22:39:36.101 | ERROR    | src.function:operate_object_sheet:125 - 不一致索引:{'课程目标3'}
NoneType: None
2022-05-17 22:40:02.168 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:40:02.642 | DEBUG    | src.function:operate_object_sheet:121 - 课程目标个数不一致，程序终止
2022-05-17 22:41:03.059 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-17 22:41:03.545 | DEBUG    | src.function:operate_object_sheet:121 - 课程目标个数不一致，程序终止
2022-05-17 22:41:03.545 | ERROR    | src.function:operate_object_sheet:125 - 不一致索引:{'课程目标3'}
2022-05-18 14:37:25.272 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:37:25.744 | DEBUG    | src.function:operate_object_sheet:121 - 课程目标个数不一致，程序终止
2022-05-18 14:37:25.744 | ERROR    | src.function:operate_object_sheet:125 - 不一致索引:{'课程目标3'}
2022-05-18 14:44:14.169 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:44:14.643 | DEBUG    | src.function:operate_object_sheet:116 - 课程目标个数不一致，程序终止
2022-05-18 14:44:14.643 | ERROR    | src.function:operate_object_sheet:120 - 多出索引:{'小题分数'}
2022-05-18 14:46:05.105 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:46:05.580 | DEBUG    | src.function:operate_object_sheet:116 - 课程目标个数不一致，程序终止
2022-05-18 14:46:05.580 | ERROR    | src.function:operate_object_sheet:120 - 多出索引:{'小题分数'}
2022-05-18 14:47:17.369 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:47:17.841 | DEBUG    | src.function:operate_object_sheet:116 - 课程目标个数不一致，程序终止
2022-05-18 14:47:17.842 | ERROR    | src.function:operate_object_sheet:118 - 缺少索引:{'课程目标3'}
2022-05-18 14:48:26.673 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:48:27.151 | DEBUG    | src.function:operate_object_sheet:125 - 课程目标个数不一致
2022-05-18 14:48:27.151 | ERROR    | src.function:operate_object_sheet:129 - 多出索引:{'小题分数'}
2022-05-18 14:48:27.151 | ERROR    | src.function:operate_object_sheet:130 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000020DFF4553C0>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000020D82408AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000020D824073A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 111, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x0000020D800404F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x0000020DFFE0D720>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x0000020DFFE15940>
           └ <pandas.core.indexing._LocIndexer object at 0x0000020D829A39F0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x0000020DFFE159D0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000020D829A39F0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x0000020DFF460CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x0000020DFF462040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x0000020DFF460F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x0000020DFF45D4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-18 14:49:39.372 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:49:39.845 | DEBUG    | src.function:operate_object_sheet:125 - 课程目标个数不一致
2022-05-18 14:49:39.845 | ERROR    | src.function:operate_object_sheet:131 - 多出索引:{'小题分数'}
2022-05-18 14:49:39.845 | ERROR    | src.function:operate_object_sheet:132 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000024BCF125440>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000024BD20D9A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000024BD20D7310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 111, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x0000024BCFD104F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x0000024BCFADE770>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x0000024BCFAE5940>
           └ <pandas.core.indexing._LocIndexer object at 0x0000024BCFDCD630>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x0000024BCFAE59D0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000024BCFDCD630>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x0000024BCF130CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x0000024BCF132040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x0000024BCF130F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x0000024BCF12D4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-18 14:50:12.930 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:50:13.407 | DEBUG    | src.function:operate_object_sheet:125 - 课程目标个数不一致
2022-05-18 14:50:13.407 | ERROR    | src.function:operate_object_sheet:131 - 多出索引:{'小题分数'}
2022-05-18 14:50:13.407 | ERROR    | src.function:operate_object_sheet:132 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001EF8D1836C0>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001EF90138AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001EF901373A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 111, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000001EF8DD704F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000001EF8DB3D810>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000001EF8DB45940>
           └ <pandas.core.indexing._LocIndexer object at 0x000001EF906D69A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000001EF8DB459D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001EF906D69A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000001EF8D190CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000001EF8D192040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000001EF8D190F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000001EF8D18D4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-18 14:51:48.817 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:51:49.305 | DEBUG    | src.function:operate_object_sheet:126 - 课程目标个数不一致
2022-05-18 14:51:49.305 | ERROR    | src.function:operate_object_sheet:132 - 多出索引:{'小题分数'}
2022-05-18 14:51:49.305 | ERROR    | src.function:operate_object_sheet:133 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000019723663740>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000019726619A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000019726618310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 111, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x00000197242504F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x00000197240205E0>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x0000019724025940>
           └ <pandas.core.indexing._LocIndexer object at 0x0000019724FFD590>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x00000197240259D0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000019724FFD590>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x0000019723670CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x0000019723672040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x0000019723670F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000001972366D4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-18 14:52:24.409 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:52:24.886 | DEBUG    | src.function:operate_object_sheet:126 - 课程目标个数不一致
2022-05-18 14:52:24.886 | ERROR    | src.function:operate_object_sheet:132 - 多出索引:{'小题分数'}
2022-05-18 14:52:24.886 | ERROR    | src.function:operate_object_sheet:133 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x00000258B1CE5500>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000258B4C99A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000258B4C98310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 111, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x00000258B28D04F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x00000258B26A0630>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x00000258B26A5940>
           └ <pandas.core.indexing._LocIndexer object at 0x00000258B5235950>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x00000258B26A59D0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000258B5235950>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x00000258B1CF0CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x00000258B1CF2040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x00000258B1CF0F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x00000258B1CED4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-18 14:52:43.098 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:52:43.571 | DEBUG    | src.function:operate_object_sheet:125 - 课程目标个数不一致
2022-05-18 14:52:43.571 | ERROR    | src.function:operate_object_sheet:131 - 多出索引:{'小题分数'}
2022-05-18 14:52:43.571 | ERROR    | src.function:operate_object_sheet:132 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000024A5C0D4580>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000024A5F08AA60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000024A5F088310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 111, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x0000024A5CCC04F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x0000024A5CA8E6D0>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x0000024A5CA95940>
           └ <pandas.core.indexing._LocIndexer object at 0x0000024A5F628AE0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x0000024A5CA959D0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000024A5F628AE0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x0000024A5C0E0CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x0000024A5C0E2040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x0000024A5C0E0F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x0000024A5C0DD4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-18 14:53:01.972 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:53:02.447 | DEBUG    | src.function:operate_object_sheet:125 - 课程目标个数不一致
2022-05-18 14:53:02.447 | ERROR    | src.function:operate_object_sheet:131 - 多出索引:{'小题分数'}
2022-05-18 14:53:02.447 | ERROR    | src.function:operate_object_sheet:132 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000023BB90B35C0>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000023BBC069A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000023BBC068310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 111, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x0000023BB9CA04F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x0000023BB9A6E770>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x0000023BB9A75940>
           └ <pandas.core.indexing._LocIndexer object at 0x0000023BBC171B30>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x0000023BB9A759D0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000023BBC171B30>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x0000023BB90C0CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x0000023BB90C2040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x0000023BB90C0F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x0000023BB90BD4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-18 14:54:21.875 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:54:22.376 | DEBUG    | src.function:operate_object_sheet:126 - 课程目标个数不一致
2022-05-18 14:54:22.376 | ERROR    | src.function:operate_object_sheet:132 - 多出索引:{'小题分数'}
2022-05-18 14:54:22.376 | ERROR    | src.function:operate_object_sheet:133 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000022994F83800>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000022997F39A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000022997F38310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 112, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x0000022995B704F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000002299593E6D0>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x0000022995945940>
           └ <pandas.core.indexing._LocIndexer object at 0x0000022998432F90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x00000229959459D0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000022998432F90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x0000022994F91CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x0000022994F92040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x0000022994F91F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x0000022994F8D4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-18 14:56:30.916 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:56:31.382 | DEBUG    | src.function:operate_object_sheet:128 - 课程目标个数不一致
2022-05-18 14:56:31.382 | ERROR    | src.get_info:read_sheet:101 - An error has been caught in function 'read_sheet', process 'MainProcess' (14972), thread 'MainThread' (12920):
Traceback (most recent call last):

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 113, in operate_object_sheet
    object_parameter = pd.concat([object_parameter_scores, object_parameter_target])
                       │  │       │                        └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
                       │  │       │                          题号                                        .....
                       │  │       └ 参数
                       │  │         1        10
                       │  │         1.0    10.0
                       │  │         1.0     2.0
                       │  │         2.0     8.0
                       │  │         1.0    10.0
                       │  │         1.0    10.0
                       │  │         1.0     2.0
                       │  │         2.0     8.0
                       │  │         1.0     5.0
                       │  │         2.0     5.0
                       │  │         1....
                       │  └ <function concat at 0x000001A37FB9DB80>
                       └ <module 'pandas' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\__init__.py'>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\reshape\concat.py", line 298, in concat
    return op.get_result()
           │  └ <function _Concatenator.get_result at 0x000001A37FB9DD30>
           └ <pandas.core.reshape.concat._Concatenator object at 0x000001A3024858E0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\reshape\concat.py", line 516, in get_result
    indexers[ax] = obj_labels.get_indexer(new_labels)
    │        │     │          │           └ Index([0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 2.0, 2.0,
    │        │     │          │                    2.0],
    │        │     │          │                   dtype='object')
    │        │     │          └ <function Index.get_indexer at 0x000001A37F0CD550>
    │        │     └ Index([1, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0,
    │        │              1.0],
    │        │             dtype='object', name='参数')
    │        └ 0
    └ {}

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3171, in get_indexer
    raise InvalidIndexError(
          └ <class 'pandas.errors.InvalidIndexError'>

pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001A302079AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

> File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001A3020763A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 129, in operate_object_sheet
    if len(set(df_test_weight.columns.values)) > len(set(object_parameter.index.values)):
               │              └ <pandas._libs.properties.AxisProperty object at 0x000001A37FCB04F0>
               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                 课程目标达成情况评价报告                        
                 随堂测验           0.1   0.1   0.1   0.1
                 作业            ...

UnboundLocalError: local variable 'object_parameter' referenced before assignment
2022-05-18 14:56:31.555 | ERROR    | __main__:<module>:18 - An error has been caught in function '<module>', process 'MainProcess' (14972), thread 'MainThread' (12920):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001A302079AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001A3020763A0>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

TypeError: cannot unpack non-iterable NoneType object
2022-05-18 14:57:11.715 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:57:12.195 | DEBUG    | src.function:operate_object_sheet:128 - 课程目标个数不一致
2022-05-18 14:57:12.195 | ERROR    | src.function:operate_object_sheet:134 - 多出索引:{'课程目标5'}
2022-05-18 14:57:12.195 | ERROR    | src.function:operate_object_sheet:135 - Reindexing only valid with uniquely valued Index objects
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000021053639A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000021053638310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 113, in operate_object_sheet
    object_parameter = pd.concat([object_parameter_scores, object_parameter])
                       │  │       │                        └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
                       │  │       │                          题号                                        .....
                       │  │       └ 参数
                       │  │         1        10
                       │  │         1.0    10.0
                       │  │         1.0     2.0
                       │  │         2.0     8.0
                       │  │         1.0    10.0
                       │  │         1.0    10.0
                       │  │         1.0     2.0
                       │  │         2.0     8.0
                       │  │         1.0     5.0
                       │  │         2.0     5.0
                       │  │         1....
                       │  └ <function concat at 0x000002105115DB80>
                       └ <module 'pandas' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\__init__.py'>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\reshape\concat.py", line 298, in concat
    return op.get_result()
           │  └ <function _Concatenator.get_result at 0x000002105115DD30>
           └ <pandas.core.reshape.concat._Concatenator object at 0x0000021053A468E0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\reshape\concat.py", line 516, in get_result
    indexers[ax] = obj_labels.get_indexer(new_labels)
    │        │     │          │           └ Index([0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 2.0, 2.0,
    │        │     │          │                    2.0],
    │        │     │          │                   dtype='object')
    │        │     │          └ <function Index.get_indexer at 0x000002105068D550>
    │        │     └ Index([1, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0,
    │        │              1.0],
    │        │             dtype='object', name='参数')
    │        └ 0
    └ {}

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3171, in get_indexer
    raise InvalidIndexError(
          └ <class 'pandas.errors.InvalidIndexError'>

pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects
2022-05-18 14:57:43.469 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:57:43.944 | DEBUG    | src.function:operate_object_sheet:128 - 课程目标个数不一致
2022-05-18 14:57:43.944 | ERROR    | src.function:operate_object_sheet:134 - 多出索引:{'课程目标5'}
2022-05-18 14:57:43.944 | ERROR    | src.function:operate_object_sheet:135 - Reindexing only valid with uniquely valued Index objects
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000024AE1939A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000024AE1938310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 113, in operate_object_sheet
    object_parameter = pd.concat((object_parameter_scores, object_parameter))
                       │  │       │                        └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
                       │  │       │                          题号                                        .....
                       │  │       └ 参数
                       │  │         1        10
                       │  │         1.0    10.0
                       │  │         1.0     2.0
                       │  │         2.0     8.0
                       │  │         1.0    10.0
                       │  │         1.0    10.0
                       │  │         1.0     2.0
                       │  │         2.0     8.0
                       │  │         1.0     5.0
                       │  │         2.0     5.0
                       │  │         1....
                       │  └ <function concat at 0x0000024ADF45DB80>
                       └ <module 'pandas' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\__init__.py'>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\reshape\concat.py", line 298, in concat
    return op.get_result()
           │  └ <function _Concatenator.get_result at 0x0000024ADF45DD30>
           └ <pandas.core.reshape.concat._Concatenator object at 0x0000024AE1D458E0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\reshape\concat.py", line 516, in get_result
    indexers[ax] = obj_labels.get_indexer(new_labels)
    │        │     │          │           └ Index([0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 2.0, 2.0,
    │        │     │          │                    2.0],
    │        │     │          │                   dtype='object')
    │        │     │          └ <function Index.get_indexer at 0x0000024ADE98D550>
    │        │     └ Index([1, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0,
    │        │              1.0],
    │        │             dtype='object', name='参数')
    │        └ 0
    └ {}

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3171, in get_indexer
    raise InvalidIndexError(
          └ <class 'pandas.errors.InvalidIndexError'>

pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects
2022-05-18 14:58:04.949 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:58:05.434 | DEBUG    | src.function:operate_object_sheet:130 - 课程目标个数不一致
2022-05-18 14:58:05.435 | ERROR    | src.function:operate_object_sheet:136 - 多出索引:{'课程目标5'}
2022-05-18 14:58:05.435 | ERROR    | src.function:operate_object_sheet:137 - Reindexing only valid with uniquely valued Index objects
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000239F4A59A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x00000239F4A58310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 115, in operate_object_sheet
    object_parameter = pd.concat((object_parameter_scores, object_parameter))
                       │  │       │                        └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
                       │  │       │                          题号                                        .....
                       │  │       └ 参数
                       │  │         1        10
                       │  │         1.0    10.0
                       │  │         1.0     2.0
                       │  │         2.0     8.0
                       │  │         1.0    10.0
                       │  │         1.0    10.0
                       │  │         1.0     2.0
                       │  │         2.0     8.0
                       │  │         1.0     5.0
                       │  │         2.0     5.0
                       │  │         1....
                       │  └ <function concat at 0x00000239F257DB80>
                       └ <module 'pandas' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\__init__.py'>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\reshape\concat.py", line 298, in concat
    return op.get_result()
           │  └ <function _Concatenator.get_result at 0x00000239F257DD30>
           └ <pandas.core.reshape.concat._Concatenator object at 0x00000239F516D6D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\reshape\concat.py", line 516, in get_result
    indexers[ax] = obj_labels.get_indexer(new_labels)
    │        │     │          │           └ Index([0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 2.0, 2.0,
    │        │     │          │                    2.0],
    │        │     │          │                   dtype='object')
    │        │     │          └ <function Index.get_indexer at 0x00000239F1AAD550>
    │        │     └ Index([1, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0,
    │        │              1.0],
    │        │             dtype='object', name='参数')
    │        └ 0
    └ {}

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3171, in get_indexer
    raise InvalidIndexError(
          └ <class 'pandas.errors.InvalidIndexError'>

pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects
2022-05-18 14:59:56.291 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 14:59:56.770 | DEBUG    | src.function:operate_object_sheet:130 - 课程目标个数不一致
2022-05-18 14:59:56.770 | ERROR    | src.function:operate_object_sheet:136 - 多出索引:{'课程目标5'}
2022-05-18 14:59:56.770 | ERROR    | src.function:operate_object_sheet:137 - The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001F6DF139A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001F6DF138310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 115, in operate_object_sheet
    object_parameter.insert(0, '小题分数', object_parameter_scores, object_parameter)
    │                │                 │                        └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
    │                │                 │                          题号                                        .....
    │                │                 └ 参数
    │                │                   1        10
    │                │                   1.0    10.0
    │                │                   1.0     2.0
    │                │                   2.0     8.0
    │                │                   1.0    10.0
    │                │                   1.0    10.0
    │                │                   1.0     2.0
    │                │                   2.0     8.0
    │                │                   1.0     5.0
    │                │                   2.0     5.0
    │                │                   1....
    │                └ <function DataFrame.insert at 0x000001F6DCD76820>
    └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
      题号                                        .....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3756, in insert
    if allow_duplicates and not self.flags.allows_duplicate_labels:
       │                        │    └ <property object at 0x000001F6DCB294A0>
       │                        └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
       │                          题号                                        .....
       └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
         题号                                        .....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 1442, in __nonzero__
    raise ValueError(

ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2022-05-18 15:00:16.225 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:00:16.711 | DEBUG    | src.function:operate_object_sheet:130 - 课程目标个数不一致
2022-05-18 15:00:16.711 | ERROR    | src.function:operate_object_sheet:136 - 多出索引:{'课程目标5'}
2022-05-18 15:00:16.711 | ERROR    | src.function:operate_object_sheet:137 - cannot reindex from a duplicate axis
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000020FDB219A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000020FDB218310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 115, in operate_object_sheet
    object_parameter.insert(0, '小题分数', object_parameter_scores)
    │                │                 └ 参数
    │                │                   1        10
    │                │                   1.0    10.0
    │                │                   1.0     2.0
    │                │                   2.0     8.0
    │                │                   1.0    10.0
    │                │                   1.0    10.0
    │                │                   1.0     2.0
    │                │                   2.0     8.0
    │                │                   1.0     5.0
    │                │                   2.0     5.0
    │                │                   1....
    │                └ <function DataFrame.insert at 0x0000020FD8E56820>
    └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
      题号                                        .....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3762, in insert
    value = self._sanitize_column(column, value, broadcast=False)
            │    │                │       └ 参数
            │    │                │         1        10
            │    │                │         1.0    10.0
            │    │                │         1.0     2.0
            │    │                │         2.0     8.0
            │    │                │         1.0    10.0
            │    │                │         1.0    10.0
            │    │                │         1.0     2.0
            │    │                │         2.0     8.0
            │    │                │         1.0     5.0
            │    │                │         2.0     5.0
            │    │                │         1....
            │    │                └ '小题分数'
            │    └ <function DataFrame._sanitize_column at 0x0000020FD8E56940>
            └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
              题号                                        .....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3876, in _sanitize_column
    value = reindexer(value)
            │         └ 参数
            │           1        10
            │           1.0    10.0
            │           1.0     2.0
            │           2.0     8.0
            │           1.0    10.0
            │           1.0    10.0
            │           1.0     2.0
            │           2.0     8.0
            │           1.0     5.0
            │           2.0     5.0
            │           1....
            └ <function DataFrame._sanitize_column.<locals>.reindexer at 0x0000020FDB45CA60>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3867, in reindexer
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3862, in reindexer
    value = value.reindex(self.index)._values
            │     │       │    └ <pandas._libs.properties.AxisProperty object at 0x0000020FD8E503A0>
            │     │       └ 参数     1.0  1.0  1.0  2.0  1.0  1.0  1.0  ...  1.0  2.0  1.0  2.0  1.0  2.0  1.0
            │     │         题号                                        .....
            │     └ <function Series.reindex at 0x0000020FD8E30C10>
            └ 参数
              1        10
              1.0    10.0
              1.0     2.0
              2.0     8.0
              1.0    10.0
              1.0    10.0
              1.0     2.0
              2.0     8.0
              1.0     5.0
              2.0     5.0
              1....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\series.py", line 4345, in reindex
    return super().reindex(index=index, **kwargs)
                                 │        └ {}
                                 └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5'], dtype='object', name='题号')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 4811, in reindex
    return self._reindex_axes(
           │    └ <function NDFrame._reindex_axes at 0x0000020FD8DC1940>
           └ 参数
             1        10
             1.0    10.0
             1.0     2.0
             2.0     8.0
             1.0    10.0
             1.0    10.0
             1.0     2.0
             2.0     8.0
             1.0     5.0
             2.0     5.0
             1....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 4832, in _reindex_axes
    obj = obj._reindex_with_indexers(
          │   └ <function NDFrame._reindex_with_indexers at 0x0000020FD8DC1B80>
          └ 参数
            1        10
            1.0    10.0
            1.0     2.0
            2.0     8.0
            1.0    10.0
            1.0    10.0
            1.0     2.0
            2.0     8.0
            1.0     5.0
            2.0     5.0
            1....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 4877, in _reindex_with_indexers
    new_data = new_data.reindex_indexer(
               │        └ <function BlockManager.reindex_indexer at 0x0000020FD8CBB820>
               └ SingleBlockManager
                 Items: Index([1, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0,
                        1.0],
                       dtype...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 1301, in reindex_indexer
    self.axes[axis]._can_reindex(indexer)
    │    │    │                  └ array([-1, -1, -1, -1, -1], dtype=int64)
    │    │    └ 0
    │    └ <member 'axes' of 'BlockManager' objects>
    └ SingleBlockManager
      Items: Index([1, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0,
             1.0],
            dtype...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3476, in _can_reindex
    raise ValueError("cannot reindex from a duplicate axis")

ValueError: cannot reindex from a duplicate axis
2022-05-18 15:02:20.239 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:02:20.727 | DEBUG    | src.function:operate_object_sheet:126 - 课程目标个数不一致
2022-05-18 15:02:20.727 | ERROR    | src.function:operate_object_sheet:132 - 多出索引:{'小题分数'}
2022-05-18 15:02:20.727 | ERROR    | src.function:operate_object_sheet:133 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001C710433780>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001C7133E9A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001C7133E8310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 111, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000001C7110204F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000001C710DED810>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000001C710DF5940>
           └ <pandas.core.indexing._LocIndexer object at 0x000001C7139858B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000001C710DF59D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001C7139858B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000001C710440CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000001C710442040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000001C710440F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000001C71043D4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-18 15:02:34.738 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:02:35.221 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致
2022-05-18 15:02:35.222 | ERROR    | src.function:operate_object_sheet:133 - 多出索引:{'小题分数'}
2022-05-18 15:02:35.222 | ERROR    | src.function:operate_object_sheet:134 - '课程目标4'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '课程目标4'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000002B84A9D5580>
           └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                        nan,     nan,
                    ...
                       ...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '课程目标4'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002B84D989A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002B84D987310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 111, in operate_object_sheet
    object_parameter = object_data.loc['小题分数':list(df_test_weight.columns.values)[-1]]
                       │           │               │              └ <pandas._libs.properties.AxisProperty object at 0x000002B84B5C04F0>
                       │           │               └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                       │           │                 课程目标达成情况评价报告                        
                       │           │                 随堂测验           0.1   0.1   0.1   0.1
                       │           │                 作业            ...
                       │           └ <property object at 0x000002B84B38D810>
                       └ 参数     目标1  目标4  目标4  目标4  目标4  目标4  目标3  目标3  目标4  目标4
                         题号                                                     
                         题号     目标1  目...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._getitem_axis at 0x000002B84B395940>
           └ <pandas.core.indexing._LocIndexer object at 0x000002B84A181860>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1102, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           │    │               │         └ 0
           │    │               └ slice('小题分数', '课程目标4', None)
           │    └ <function _LocIndexer._get_slice_axis at 0x000002B84B3959D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002B84A181860>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1136, in _get_slice_axis
    indexer = labels.slice_indexer(
              │      └ <function Index.slice_indexer at 0x000002B84A9E0CA0>
              └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                           nan,     nan,
                       ...
                          ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5277, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
                             │    │          │      │         │          └ 'loc'
                             │    │          │      │         └ None
                             │    │          │      └ '课程目标4'
                             │    │          └ '小题分数'
                             │    └ <function Index.slice_locs at 0x000002B84A9E2040>
                             └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                                          nan,     nan,
                                      ...
                                         ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5482, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
                │    │               │             └ 'loc'
                │    │               └ '课程目标4'
                │    └ <function Index.get_slice_bound at 0x000002B84A9E0F70>
                └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                             nan,     nan,
                         ...
                            ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5396, in get_slice_bound
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 5390, in get_slice_bound
    slc = self.get_loc(label)
          │    │       └ '课程目标4'
          │    └ <function Index.get_loc at 0x000002B84A9DD4C0>
          └ Index([   '题号',  '小题分数', '课程目标1', '课程目标2', '课程目标3',     nan,  '学生姓名',     nan,
                       nan,     nan,
                   ...
                      ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '课程目标4'

KeyError: '课程目标4'
2022-05-18 15:06:00.764 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:06:01.232 | DEBUG    | src.function:operate_object_sheet:133 - 课程目标个数不一致
2022-05-18 15:06:01.232 | ERROR    | src.function:operate_object_sheet:139 - 多出索引:{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15}
2022-05-18 15:06:01.232 | ERROR    | src.function:operate_object_sheet:140 - cannot reindex from a duplicate axis
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002CF0C1B9A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000002CF0C1B7310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 117, in operate_object_sheet
    object_parameter.insert(0, '小题分数', object_parameter_scores.T)
    │                │                 │                       └ <property object at 0x000002CF090573B0>
    │                │                 └ 参数
    │                │                   1        10
    │                │                   1.0    10.0
    │                │                   1.0     2.0
    │                │                   2.0     8.0
    │                │                   1.0    10.0
    │                │                   1.0    10.0
    │                │                   1.0     2.0
    │                │                   2.0     8.0
    │                │                   1.0     5.0
    │                │                   2.0     5.0
    │                │                   1....
    │                └ <function DataFrame.insert at 0x000002CF09DF6820>
    └ 题号 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
      1      1   NaN   NaN   NaN   NaN
      2    1.0   NaN   NaN   NaN   NaN
      3    NaN   1.0   NaN   NaN...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3762, in insert
    value = self._sanitize_column(column, value, broadcast=False)
            │    │                │       └ 参数
            │    │                │         1        10
            │    │                │         1.0    10.0
            │    │                │         1.0     2.0
            │    │                │         2.0     8.0
            │    │                │         1.0    10.0
            │    │                │         1.0    10.0
            │    │                │         1.0     2.0
            │    │                │         2.0     8.0
            │    │                │         1.0     5.0
            │    │                │         2.0     5.0
            │    │                │         1....
            │    │                └ '小题分数'
            │    └ <function DataFrame._sanitize_column at 0x000002CF09DF6940>
            └ 题号 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
              1      1   NaN   NaN   NaN   NaN
              2    1.0   NaN   NaN   NaN   NaN
              3    NaN   1.0   NaN   NaN...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3876, in _sanitize_column
    value = reindexer(value)
            │         └ 参数
            │           1        10
            │           1.0    10.0
            │           1.0     2.0
            │           2.0     8.0
            │           1.0    10.0
            │           1.0    10.0
            │           1.0     2.0
            │           2.0     8.0
            │           1.0     5.0
            │           2.0     5.0
            │           1....
            └ <function DataFrame._sanitize_column.<locals>.reindexer at 0x000002CF0C3FD0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3867, in reindexer
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3862, in reindexer
    value = value.reindex(self.index)._values
            │     │       │    └ <pandas._libs.properties.AxisProperty object at 0x000002CF09DF03A0>
            │     │       └ 题号 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
            │     │         1      1   NaN   NaN   NaN   NaN
            │     │         2    1.0   NaN   NaN   NaN   NaN
            │     │         3    NaN   1.0   NaN   NaN...
            │     └ <function Series.reindex at 0x000002CF09DD0C10>
            └ 参数
              1        10
              1.0    10.0
              1.0     2.0
              2.0     8.0
              1.0    10.0
              1.0    10.0
              1.0     2.0
              2.0     8.0
              1.0     5.0
              2.0     5.0
              1....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\series.py", line 4345, in reindex
    return super().reindex(index=index, **kwargs)
                                 │        └ {}
                                 └ RangeIndex(start=1, stop=16, step=1)

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 4811, in reindex
    return self._reindex_axes(
           │    └ <function NDFrame._reindex_axes at 0x000002CF09D62940>
           └ 参数
             1        10
             1.0    10.0
             1.0     2.0
             2.0     8.0
             1.0    10.0
             1.0    10.0
             1.0     2.0
             2.0     8.0
             1.0     5.0
             2.0     5.0
             1....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 4832, in _reindex_axes
    obj = obj._reindex_with_indexers(
          │   └ <function NDFrame._reindex_with_indexers at 0x000002CF09D62B80>
          └ 参数
            1        10
            1.0    10.0
            1.0     2.0
            2.0     8.0
            1.0    10.0
            1.0    10.0
            1.0     2.0
            2.0     8.0
            1.0     5.0
            2.0     5.0
            1....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 4877, in _reindex_with_indexers
    new_data = new_data.reindex_indexer(
               │        └ <function BlockManager.reindex_indexer at 0x000002CF09C5C820>
               └ SingleBlockManager
                 Items: Index([1, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0,
                        1.0],
                       dtype...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 1301, in reindex_indexer
    self.axes[axis]._can_reindex(indexer)
    │    │    │                  └ array([ 0,  1,  2,  4,  5,  6,  8, 10, 12, 14,  3,  7,  9, 11, 13, -1, -1,
    │    │    │                           -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1]...
    │    │    └ 0
    │    └ <member 'axes' of 'BlockManager' objects>
    └ SingleBlockManager
      Items: Index([1, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0,
             1.0],
            dtype...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3476, in _can_reindex
    raise ValueError("cannot reindex from a duplicate axis")

ValueError: cannot reindex from a duplicate axis
2022-05-18 15:06:54.715 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:06:55.202 | DEBUG    | src.function:operate_object_sheet:135 - 课程目标个数不一致
2022-05-18 15:06:55.202 | ERROR    | src.function:operate_object_sheet:141 - 多出索引:{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15}
2022-05-18 15:06:55.202 | ERROR    | src.function:operate_object_sheet:142 - cannot reindex from a duplicate axis
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001840C589A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x000001840C588310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 119, in operate_object_sheet
    object_parameter.insert(0, '小题分数', object_parameter_scores.T)
    │                │                 │                       └ <property object at 0x000001847F426450>
    │                │                 └ 参数
    │                │                   1        10
    │                │                   1.0    10.0
    │                │                   1.0     2.0
    │                │                   2.0     8.0
    │                │                   1.0    10.0
    │                │                   1.0    10.0
    │                │                   1.0     2.0
    │                │                   2.0     8.0
    │                │                   1.0     5.0
    │                │                   2.0     5.0
    │                │                   1....
    │                └ <function DataFrame.insert at 0x000001840A1C6820>
    └ 题号 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
      1      1   NaN   NaN   NaN   NaN
      2    1.0   NaN   NaN   NaN   NaN
      3    NaN   1.0   NaN   NaN...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3762, in insert
    value = self._sanitize_column(column, value, broadcast=False)
            │    │                │       └ 参数
            │    │                │         1        10
            │    │                │         1.0    10.0
            │    │                │         1.0     2.0
            │    │                │         2.0     8.0
            │    │                │         1.0    10.0
            │    │                │         1.0    10.0
            │    │                │         1.0     2.0
            │    │                │         2.0     8.0
            │    │                │         1.0     5.0
            │    │                │         2.0     5.0
            │    │                │         1....
            │    │                └ '小题分数'
            │    └ <function DataFrame._sanitize_column at 0x000001840A1C6940>
            └ 题号 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
              1      1   NaN   NaN   NaN   NaN
              2    1.0   NaN   NaN   NaN   NaN
              3    NaN   1.0   NaN   NaN...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3876, in _sanitize_column
    value = reindexer(value)
            │         └ 参数
            │           1        10
            │           1.0    10.0
            │           1.0     2.0
            │           2.0     8.0
            │           1.0    10.0
            │           1.0    10.0
            │           1.0     2.0
            │           2.0     8.0
            │           1.0     5.0
            │           2.0     5.0
            │           1....
            └ <function DataFrame._sanitize_column.<locals>.reindexer at 0x000001840C7CC0D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3867, in reindexer
    raise err

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3862, in reindexer
    value = value.reindex(self.index)._values
            │     │       │    └ <pandas._libs.properties.AxisProperty object at 0x000001840A1C03A0>
            │     │       └ 题号 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
            │     │         1      1   NaN   NaN   NaN   NaN
            │     │         2    1.0   NaN   NaN   NaN   NaN
            │     │         3    NaN   1.0   NaN   NaN...
            │     └ <function Series.reindex at 0x000001840A1A0C10>
            └ 参数
              1        10
              1.0    10.0
              1.0     2.0
              2.0     8.0
              1.0    10.0
              1.0    10.0
              1.0     2.0
              2.0     8.0
              1.0     5.0
              2.0     5.0
              1....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\series.py", line 4345, in reindex
    return super().reindex(index=index, **kwargs)
                                 │        └ {}
                                 └ RangeIndex(start=1, stop=16, step=1)

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 4811, in reindex
    return self._reindex_axes(
           │    └ <function NDFrame._reindex_axes at 0x000001840A132940>
           └ 参数
             1        10
             1.0    10.0
             1.0     2.0
             2.0     8.0
             1.0    10.0
             1.0    10.0
             1.0     2.0
             2.0     8.0
             1.0     5.0
             2.0     5.0
             1....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 4832, in _reindex_axes
    obj = obj._reindex_with_indexers(
          │   └ <function NDFrame._reindex_with_indexers at 0x000001840A132B80>
          └ 参数
            1        10
            1.0    10.0
            1.0     2.0
            2.0     8.0
            1.0    10.0
            1.0    10.0
            1.0     2.0
            2.0     8.0
            1.0     5.0
            2.0     5.0
            1....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 4877, in _reindex_with_indexers
    new_data = new_data.reindex_indexer(
               │        └ <function BlockManager.reindex_indexer at 0x000001840A02C820>
               └ SingleBlockManager
                 Items: Index([1, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0,
                        1.0],
                       dtype...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 1301, in reindex_indexer
    self.axes[axis]._can_reindex(indexer)
    │    │    │                  └ array([ 0,  1,  2,  4,  5,  6,  8, 10, 12, 14,  3,  7,  9, 11, 13, -1, -1,
    │    │    │                           -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1]...
    │    │    └ 0
    │    └ <member 'axes' of 'BlockManager' objects>
    └ SingleBlockManager
      Items: Index([1, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0,
             1.0],
            dtype...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3476, in _can_reindex
    raise ValueError("cannot reindex from a duplicate axis")

ValueError: cannot reindex from a duplicate axis
2022-05-18 15:08:00.269 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:08:00.753 | DEBUG    | src.function:operate_object_sheet:127 - 课程目标个数不一致，程序终止
2022-05-18 15:08:00.754 | ERROR    | src.function:operate_object_sheet:131 - 多出索引:{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15}
2022-05-18 15:08:33.900 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:08:34.371 | DEBUG    | src.function:operate_object_sheet:134 - 课程目标个数不一致
2022-05-18 15:08:34.371 | ERROR    | src.function:operate_object_sheet:140 - 多出索引:{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15}
2022-05-18 15:08:34.371 | ERROR    | src.function:operate_object_sheet:141 - 'NoneType' object has no attribute 'T'
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000019DB82D9A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 101, in read_sheet
    object_all_param, object_all_scores = function.operate_object_sheet(object_evaluation, df_test_weight, student_id)
                                          │        │                    │                  │               └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                          │        │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                          │        │                    │                    课程目标达成情况评价报告                        
                                          │        │                    │                    随堂测验           0.1   0.1   0.1   0.1
                                          │        │                    │                    作业            ...
                                          │        │                    └ [         Unnamed: 1  测验1   测验2  测验3  ...  达成度  Unnamed: 23  Unnamed: 24  Unnamed: 25
                                          │        │                      参数设置                                 .....
                                          │        └ <function operate_object_sheet at 0x0000019DB82D8310>
                                          └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

> File "E:\python\2021.9.17\database_excel_test\src\function.py", line 118, in operate_object_sheet
    object_parameter = (object_parameter.insert(0, '小题分数', object_parameter_scores.T)).T
                        │                │                 │                       └ <property object at 0x0000019DB5178360>
                        │                │                 └ 1       10
                        │                │                   2     10.0
                        │                │                   3      2.0
                        │                │                   4      8.0
                        │                │                   5     10.0
                        │                │                   6     10.0
                        │                │                   7      2.0
                        │                │                   8      8.0
                        │                │                   9      5.0
                        │                │                   10     5.0
                        │                │                   11     5.0
                        │                │                   12  ...
                        │                └ <function DataFrame.insert at 0x0000019DB5F16820>
                        └ 题号  小题分数 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                          1     10     1   NaN   NaN   NaN   NaN
                          2   10.0   1.0   NaN   NaN   NaN   NaN
                          3    2.0...

AttributeError: 'NoneType' object has no attribute 'T'
2022-05-18 15:08:56.571 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:08:57.056 | DEBUG    | src.function:operate_object_sheet:125 - 课程目标个数不一致，程序终止
2022-05-18 15:08:57.056 | ERROR    | src.function:operate_object_sheet:129 - 多出索引:{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15}
2022-05-18 15:10:54.177 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:10:54.652 | DEBUG    | src.function:operate_object_sheet:125 - 课程目标个数不一致，程序终止
2022-05-18 15:10:54.652 | ERROR    | src.function:operate_object_sheet:129 - 多出索引:{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15}
2022-05-18 15:27:31.181 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:27:31.634 | DEBUG    | src.function:operate_object_sheet:119 - 课程目标个数不一致，程序终止
2022-05-18 15:27:31.635 | ERROR    | src.function:operate_object_sheet:123 - 多出索引:{'课程目标5', '小题分数'}
2022-05-18 15:30:25.567 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:30:26.023 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:30:26.023 | ERROR    | src.check_data:check_target_num:62 - 多出索引:{'课程目标5'}
2022-05-18 15:31:05.226 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:31:05.691 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:31:05.691 | ERROR    | src.check_data:check_target_num:60 - 缺少索引:{'课程目标4'}
2022-05-18 15:32:37.789 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:32:38.255 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:32:38.255 | ERROR    | src.check_data:check_target_num:60 - 缺少索引:{'课程目标4'}
2022-05-18 15:34:20.931 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:34:21.396 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:34:21.396 | ERROR    | src.check_data:check_target_num:60 - 随堂测验缺少索引:{'课程目标4'}
2022-05-18 15:36:02.742 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:36:03.218 | ERROR    | __main__:<module>:18 - An error has been caught in function '<module>', process 'MainProcess' (17660), thread 'MainThread' (5312):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000014F3D3B8B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 106, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x0000014F3D3B83A0>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
    │               │                         │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
    │               │                         │        │                       │                │   │                 │     考核方式                                                          ...
    │               │                         │        │                       │                │   │                 └ 1
    │               │                         │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
    │               │                         │        │                       │                │     参数设置                                   ...
    │               │                         │        │                       │                └ 1
    │               │                         │        │                       └ [       1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
    │               │                         │        │                         题号                                      ...
    │               │                         │        └ <function count_object_evaluation at 0x0000014F3D3B9820>
    │               │                         └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>
    │               └ 考核方式     课程目标1 课程目标2 课程目标3 课程目标4
    │                 参数设置                            
    │                 66652645  12.0  12.0   8.0  26.0
    │                 66666664  11.0  10.0   8.0...
    └ 考核方式      课程目标1  课程目标2  课程目标3  课程目标4
      参数设置                                
      66652645  0.600  0.632  0.533  0.565
      66666664  0.55...

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 137, in count_object_evaluation
    count_param = single_param.loc[df_weight.index]
                  │            │   │         └ <pandas._libs.properties.AxisProperty object at 0x0000014F3AFF03A0>
                  │            │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                  │            │     考核方式                                                          ...
                  │            └ <property object at 0x0000014F3ADBD810>
                  └        1   2   3   4   5   6   7   8   9   10
                    题号                                           
                    小题分数   10  10  10  10  10  10  10...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function _LocIndexer._getitem_axis at 0x0000014F3ADC5940>
           └ <pandas.core.indexing._LocIndexer object at 0x0000014F3DBE3A40>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1113, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
           │    │                 │         └ 0
           │    │                 └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function _LocIndexer._getitem_iterable at 0x0000014F3ADC5700>
           └ <pandas.core.indexing._LocIndexer object at 0x0000014F3DBE3A40>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1053, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis, raise_missing=False)
                      │    │                     │    └ 0
                      │    │                     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
                      │    └ <function _LocIndexer._get_listlike_indexer at 0x0000014F3ADC5AF0>
                      └ <pandas.core.indexing._LocIndexer object at 0x0000014F3DBE3A40>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1266, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis, raise_missing=raise_missing)
    │    │                      │       │        │                   └ False
    │    │                      │       │        └ 0
    │    │                      │       └ array([ 1,  2,  3, -1], dtype=int64)
    │    │                      └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │    └ <function _LocIndexer._validate_read_indexer at 0x0000014F3ADC5B80>
    └ <pandas.core.indexing._LocIndexer object at 0x0000014F3DBE3A40>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1321, in _validate_read_indexer
    raise KeyError(

KeyError: "Passing list-likes to .loc or [] with any missing labels is no longer supported. The following labels were missing: Index(['课程目标4'], dtype='object', name='考核方式'). See https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#deprecate-loc-reindex-listlike"
2022-05-18 15:37:12.580 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:37:13.052 | ERROR    | __main__:<module>:18 - An error has been caught in function '<module>', process 'MainProcess' (7384), thread 'MainThread' (10656):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000023775879A60>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 106, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x0000023775879280>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
    │               │                         │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
    │               │                         │        │                       │                │   │                 │     考核方式                                                          ...
    │               │                         │        │                       │                │   │                 └ 1
    │               │                         │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
    │               │                         │        │                       │                │     参数设置                                   ...
    │               │                         │        │                       │                └ 1
    │               │                         │        │                       └ [       1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
    │               │                         │        │                         题号                                      ...
    │               │                         │        └ <function count_object_evaluation at 0x0000023775878700>
    │               │                         └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>
    │               └ 考核方式     课程目标1 课程目标2 课程目标3 课程目标4
    │                 参数设置                            
    │                 66652645  12.0  12.0   8.0  26.0
    │                 66666664  11.0  10.0   8.0...
    └ 考核方式      课程目标1  课程目标2  课程目标3  课程目标4
      参数设置                                
      66652645  0.600  0.632  0.533  0.565
      66666664  0.55...

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 136, in count_object_evaluation
    count_param = single_param.loc[df_weight.index]
                  │            │   │         └ <pandas._libs.properties.AxisProperty object at 0x00000237734A03A0>
                  │            │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                  │            │     考核方式                                                          ...
                  │            └ <property object at 0x000002377326E7C0>
                  └        1   2   3   4   5   6   7   8   9   10
                    题号                                           
                    小题分数   10  10  10  10  10  10  10...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function _LocIndexer._getitem_axis at 0x0000023773275940>
           └ <pandas.core.indexing._LocIndexer object at 0x0000023775FF5900>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1113, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
           │    │                 │         └ 0
           │    │                 └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function _LocIndexer._getitem_iterable at 0x0000023773275700>
           └ <pandas.core.indexing._LocIndexer object at 0x0000023775FF5900>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1053, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis, raise_missing=False)
                      │    │                     │    └ 0
                      │    │                     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
                      │    └ <function _LocIndexer._get_listlike_indexer at 0x0000023773275AF0>
                      └ <pandas.core.indexing._LocIndexer object at 0x0000023775FF5900>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1266, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis, raise_missing=raise_missing)
    │    │                      │       │        │                   └ False
    │    │                      │       │        └ 0
    │    │                      │       └ array([ 1,  2,  3, -1], dtype=int64)
    │    │                      └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │    └ <function _LocIndexer._validate_read_indexer at 0x0000023773275B80>
    └ <pandas.core.indexing._LocIndexer object at 0x0000023775FF5900>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1321, in _validate_read_indexer
    raise KeyError(

KeyError: "Passing list-likes to .loc or [] with any missing labels is no longer supported. The following labels were missing: Index(['课程目标4'], dtype='object', name='考核方式'). See https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#deprecate-loc-reindex-listlike"
2022-05-18 15:39:34.575 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:39:35.035 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:39:35.035 | ERROR    | src.check_data:check_target_num:60 - 随堂测验页帧缺少索引:{'课程目标4'}
2022-05-18 15:45:40.500 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:45:40.969 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:45:40.969 | ERROR    | src.check_data:check_target_num:60 - 考试页帧缺少索引:{'课程目标4'}
2022-05-18 15:46:34.813 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:46:35.281 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:46:35.281 | ERROR    | src.check_data:check_target_num:60 - 考试页帧缺少索引:{'课程目标4'}
2022-05-18 15:46:49.988 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:46:50.449 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:46:50.449 | ERROR    | src.check_data:check_target_num:60 - 考试页帧缺少索引:{'课程目标4'}
2022-05-18 15:47:03.709 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:47:04.176 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:47:04.176 | ERROR    | src.check_data:check_target_num:60 - 考试页帧缺少索引:{'课程目标4'}
2022-05-18 15:47:49.713 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:47:50.183 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:47:50.183 | ERROR    | src.check_data:check_target_num:60 - 考试页帧缺少索引:{'课程目标4'}
2022-05-18 15:48:12.031 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:48:12.494 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:48:12.494 | ERROR    | src.check_data:check_target_num:60 - 考试页帧缺少索引:{'课程目标4'}
2022-05-18 15:48:40.448 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:48:40.923 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 15:48:40.923 | ERROR    | src.check_data:check_target_num:60 - 作业页帧缺少索引:{'课程目标4'}
2022-05-18 15:49:30.112 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:49:30.594 | ERROR    | __main__:<module>:18 - An error has been caught in function '<module>', process 'MainProcess' (7808), thread 'MainThread' (2464):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x00000176C5B18B80>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 106, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x00000176C5B183A0>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
    │               │                         │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
    │               │                         │        │                       │                │   │                 │     考核方式                                                          ...
    │               │                         │        │                       │                │   │                 └ 3
    │               │                         │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
    │               │                         │        │                       │                │     参数设置                                   ...
    │               │                         │        │                       │                └ 3
    │               │                         │        │                       └ [       1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
    │               │                         │        │                         题号                                      ...
    │               │                         │        └ <function count_object_evaluation at 0x00000176C5B16820>
    │               │                         └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>
    │               └ 考核方式     课程目标1 课程目标2 课程目标3 课程目标4
    │                 参数设置                            
    │                 66652645     0     9     0    75
    │                 66666664     0    10     0...
    └ 考核方式     课程目标1  课程目标2 课程目标3  课程目标4
      参数设置                              
      66652645   nan  0.900   nan  0.833
      66666664   nan  1.00...

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 138, in count_object_evaluation
    count_param = single_param.loc[df_weight.index]
                  │            │   │         └ <pandas._libs.properties.AxisProperty object at 0x00000176C37503A0>
                  │            │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                  │            │     考核方式                                                          ...
                  │            └ <property object at 0x00000176C351E7C0>
                  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                    题号                                         ....

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 895, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           │    │             │                    └ 0
           │    │             └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function _LocIndexer._getitem_axis at 0x00000176C3525940>
           └ <pandas.core.indexing._LocIndexer object at 0x00000176C6166E50>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1113, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
           │    │                 │         └ 0
           │    │                 └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
           │    └ <function _LocIndexer._getitem_iterable at 0x00000176C3525700>
           └ <pandas.core.indexing._LocIndexer object at 0x00000176C6166E50>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1053, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis, raise_missing=False)
                      │    │                     │    └ 0
                      │    │                     └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
                      │    └ <function _LocIndexer._get_listlike_indexer at 0x00000176C3525AF0>
                      └ <pandas.core.indexing._LocIndexer object at 0x00000176C6166E50>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1266, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis, raise_missing=raise_missing)
    │    │                      │       │        │                   └ False
    │    │                      │       │        └ 0
    │    │                      │       └ array([ 1,  2, -1,  3], dtype=int64)
    │    │                      └ Index(['课程目标1', '课程目标2', '课程目标3', '课程目标4'], dtype='object', name='考核方式')
    │    └ <function _LocIndexer._validate_read_indexer at 0x00000176C3525B80>
    └ <pandas.core.indexing._LocIndexer object at 0x00000176C6166E50>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1321, in _validate_read_indexer
    raise KeyError(

KeyError: "Passing list-likes to .loc or [] with any missing labels is no longer supported. The following labels were missing: Index(['课程目标3'], dtype='object', name='考核方式'). See https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#deprecate-loc-reindex-listlike"
2022-05-18 15:58:05.992 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 15:58:06.477 | ERROR    | src.get_info:read_sheet:104 - An error has been caught in function 'read_sheet', process 'MainProcess' (11116), thread 'MainThread' (10904):
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000019CA49B9AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

> File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 104, in read_sheet
    object_param, object_all_scores = function.back_list(object_all_param, object_all_scores, df_test_weight, k,
                                      │        │         │                 │                  │               └ 3
                                      │        │         │                 │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                      │        │         │                 │                    课程目标达成情况评价报告                        
                                      │        │         │                 │                    随堂测验           0.1   0.1   0.1   0.1
                                      │        │         │                 │                    作业            ...
                                      │        │         │                 └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                                      │        │         │                   参数设置                                   ...
                                      │        │         └ [       1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
                                      │        │           题号                                      ...
                                      │        └ <function back_list at 0x0000019CA49B84C0>
                                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 133, in back_list
    check_data.check_target_num(df_param, df_test_weight)
    │          │                │         └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
    │          │                │           课程目标达成情况评价报告                        
    │          │                │           随堂测验           0.1   0.1   0.1   0.1
    │          │                │           作业            ...
    │          │                └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
    │          │                  题号                                         ....
    │          └ <function check_target_num at 0x0000019CA49B25E0>
    └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

TypeError: check_target_num() missing 1 required positional argument: 'sheet'
2022-05-18 15:58:06.673 | ERROR    | __main__:<module>:18 - An error has been caught in function '<module>', process 'MainProcess' (11116), thread 'MainThread' (10904):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 18, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000019CA49B9AF0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 104, in read_sheet
    object_param, object_all_scores = function.back_list(object_all_param, object_all_scores, df_test_weight, k,
                                      │        │         │                 │                  │               └ 3
                                      │        │         │                 │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                      │        │         │                 │                    课程目标达成情况评价报告                        
                                      │        │         │                 │                    随堂测验           0.1   0.1   0.1   0.1
                                      │        │         │                 │                    作业            ...
                                      │        │         │                 └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                                      │        │         │                   参数设置                                   ...
                                      │        │         └ [       1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
                                      │        │           题号                                      ...
                                      │        └ <function back_list at 0x0000019CA49B84C0>
                                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

TypeError: cannot unpack non-iterable NoneType object
2022-05-18 16:01:32.127 | INFO     | __main__:<module>:14 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:01:32.595 | DEBUG    | src.check_data:check_target_num:58 - 课程目标个数不一致，程序终止
2022-05-18 16:01:32.595 | ERROR    | src.check_data:check_target_num:60 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:05:15.007 | INFO     | src.check_data:check_cover:34 -                 1
0                
课程编号  4MSCT041055
课程名称     数据库原理及应用
开课学期  2021-2022-1
任课教师           刘钢
2022-05-18 16:06:42.425 | INFO     | src.check_data:check_cover:34 -                 1
0                
课程编号  4MSCT041055
课程名称     数据库原理及应用
开课学期  2021-2022-1
任课教师           刘钢
2022-05-18 16:07:06.369 | INFO     | src.check_data:check_cover:34 -                 1
0                
课程编号  4MSCT041055
课程名称     数据库原理及应用
开课学期  2021-2022-1
任课教师           刘钢
2022-05-18 16:07:20.718 | INFO     | src.check_data:check_cover:34 -                 1
0                
课程编号  4MSCT041055
课程名称     数据库原理及应用
开课学期  2021-2022-1
任课教师           刘钢
2022-05-18 16:07:20.728 | ERROR    | src.check_data:check_cover:47 - 课程目标达成情况报告页帧【开课学期】数据与封皮页帧数据不一致，程序终止运行
2022-05-18 16:08:03.647 | ERROR    | src.check_data:check_cover:46 - 课程目标达成情况报告页帧【开课学期】数据与封皮页帧数据不一致，程序终止运行
2022-05-18 16:22:32.314 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:22:32.789 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:22:32.789 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:23:43.550 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:23:44.021 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:23:44.022 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:24:13.985 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:24:14.459 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:24:14.460 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:24:52.444 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:24:52.915 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:24:52.915 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:25:05.254 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:25:05.724 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:25:05.725 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:26:08.992 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:26:09.473 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:26:09.474 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:26:24.246 | ERROR    | src.get_info:get_data:46 - The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):

  File "E:/python/2021.9.17/database_excel_test/src/main.py", line 15, in <module>
    df_weight, df_test_weight, df_index_values = get_info.get_weight(file)
                                                 │        │          └ '..\\data\\原表修改.xls'
                                                 │        └ <function get_weight at 0x000002188F159820>
                                                 └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 87, in get_weight
    df_test_weight, df_index_values, data_weight = get_data(sheet)
                                                   │        └ '..\\data\\原表修改.xls'
                                                   └ <function get_data at 0x000002188F159700>

> File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 43, in get_data
    check_data.check_weight_sum(df_test_weight)
    │          │                └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
    │          │                  课程目标达成情况评价报告                        
    │          │                  随堂测验           0.1   0.1   0.1   0.1
    │          │                  作业            ...
    │          └ <function check_weight_sum at 0x000002188F152700>
    └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 67, in check_weight_sum
    if a.values == 1:
       │ └ <property object at 0x000002188CD61EA0>
       └ 考核方式
         课程目标1    1.0
         课程目标2    1.0
         课程目标3    2.0
         课程目标4    1.0
         dtype: float64

ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2022-05-18 16:26:24.260 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:26:24.725 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:26:24.725 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:26:37.686 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:26:38.172 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:26:38.172 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:26:59.284 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:26:59.747 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:26:59.747 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:27:25.243 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:27:25.710 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:27:25.711 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:27:58.489 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:27:58.962 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:27:58.962 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:28:17.753 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:28:18.228 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:28:18.228 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:28:54.285 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:28:54.756 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:28:54.756 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:29:04.181 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:29:04.653 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:29:04.654 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:30:36.488 | ERROR    | src.check_data:check_weight_sum:69 - 课程目标3权重和不为1，程序终止运行
2022-05-18 16:30:36.491 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.6  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:30:36.958 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:30:36.958 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:30:50.293 | ERROR    | src.check_data:check_weight_sum:69 - 课程目标3权重和不为1，程序终止运行
2022-05-18 16:34:36.516 | DEBUG    | src.check_data:check_weight_sum:69 - 权重和数据不合法
2022-05-18 16:34:36.516 | ERROR    | src.check_data:check_weight_sum:70 - 课程目标3权重和不为1，程序终止运行
2022-05-18 16:44:20.433 | DEBUG    | src.check_data:check_weight_sum:69 - 权重和数据不合法
2022-05-18 16:44:20.433 | ERROR    | src.check_data:check_weight_sum:70 - 课程目标3权重和不为1，程序终止运行
2022-05-18 16:44:35.773 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:44:36.274 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:44:36.275 | ERROR    | src.check_data:check_target_num:59 - 达成度 （学生自评法）页帧缺少索引:{'课程目标3'}
2022-05-18 16:45:18.474 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:45:18.954 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:45:18.954 | ERROR    | src.check_data:check_target_num:59 - 随堂测验页帧缺少索引:{'课程目标3'}
2022-05-18 16:46:27.315 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:46:27.809 | DEBUG    | src.check_data:check_target_num:59 - 课程目标个数不一致，程序终止
2022-05-18 16:46:27.810 | ERROR    | src.check_data:check_target_num:61 - 随堂测验页帧缺少索引:{'课程目标3'}
2022-05-18 16:47:54.431 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:47:54.896 | DEBUG    | src.check_data:check_target_num:59 - 课程目标个数不一致，程序终止
2022-05-18 16:47:54.896 | ERROR    | src.check_data:check_target_num:61 - 随堂测验页帧缺少索引:{'随堂测验', '考试', '作业', '实验'}
2022-05-18 16:48:31.639 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:48:32.112 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:48:32.112 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:50:34.110 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:50:34.577 | DEBUG    | src.check_data:check_target_num:57 - 课程目标个数不一致，程序终止
2022-05-18 16:50:34.577 | ERROR    | src.check_data:check_target_num:59 - 考试页帧缺少索引:{'课程目标3'}
2022-05-18 16:50:58.335 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:50:58.958 | INFO     | __main__:<module>:25 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.771
66666664  0.725  0.636  0.864  0.861
66662208  0.543  0.663  0.492  0.604
66662209  0.750  0.951  0.636  0.805
66662210  0.743  0.845  0.804  0.815
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.604
66662333  0.730  0.709  0.564  0.618
66662334  0.752  0.846  0.600  0.656
66662335  0.828  0.821  0.592  0.701
平均值       0.752  0.800  0.658  0.697

[139 rows x 4 columns]
2022-05-18 16:50:58.964 | INFO     | __main__:<module>:26 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   65.0
单项目标未达成人数       33   24.0   93.0   73.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-18 16:50:58.968 | INFO     | __main__:<module>:27 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  47.10%
单项目标未达成人数    23.91%  17.39%  67.39%  52.90%
2022-05-18 16:50:58.971 | INFO     | __main__:<module>:28 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-18 16:52:14.229 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:52:14.700 | ERROR    | __main__:<module>:20 - An error has been caught in function '<module>', process 'MainProcess' (7340), thread 'MainThread' (2936):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 20, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x0000027F6A89AD30>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 108, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x0000027F6A89A550>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
                                              │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                              │        │                       │                │   │                 │     考核方式                                                          ...
                                              │        │                       │                │   │                 └ 0
                                              │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                       │                │     参数设置                                   ...
                                              │        │                       │                └ 0
                                              │        │                       └ [       1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                         题号                                      ...
                                              │        └ <function count_object_evaluation at 0x0000027F6A8959D0>
                                              └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 136, in count_object_evaluation
    check_data.check_out(single_param)
    │          │         └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
    │          │           题号                                       ...
    │          └ <function check_out at 0x0000027F6A892820>
    └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

  File "E:\python\2021.9.17\database_excel_test\src\check_data.py", line 74, in check_out
    out = df_param['小题分数'].sum()
          └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
            题号                                       ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 3024, in __getitem__
    indexer = self.columns.get_loc(key)
              │    │               └ '小题分数'
              │    └ <pandas._libs.properties.AxisProperty object at 0x0000027F684CF550>
              └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
                题号                                       ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\range.py", line 354, in get_loc
    raise KeyError(key)
                   └ '小题分数'

KeyError: '小题分数'
2022-05-18 16:52:44.709 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:52:45.304 | INFO     | __main__:<module>:25 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.771
66666664  0.725  0.636  0.864  0.861
66662208  0.543  0.663  0.492  0.604
66662209  0.750  0.951  0.636  0.805
66662210  0.743  0.845  0.804  0.815
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.604
66662333  0.730  0.709  0.564  0.618
66662334  0.752  0.846  0.600  0.656
66662335  0.828  0.821  0.592  0.701
平均值       0.752  0.800  0.658  0.697

[139 rows x 4 columns]
2022-05-18 16:52:45.309 | INFO     | __main__:<module>:26 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   65.0
单项目标未达成人数       33   24.0   93.0   73.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-18 16:52:45.313 | INFO     | __main__:<module>:27 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  47.10%
单项目标未达成人数    23.91%  17.39%  67.39%  52.90%
2022-05-18 16:52:45.316 | INFO     | __main__:<module>:28 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-18 16:54:05.647 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:54:06.234 | INFO     | __main__:<module>:25 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.771
66666664  0.725  0.636  0.864  0.861
66662208  0.543  0.663  0.492  0.604
66662209  0.750  0.951  0.636  0.805
66662210  0.743  0.845  0.804  0.815
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.604
66662333  0.730  0.709  0.564  0.618
66662334  0.752  0.846  0.600  0.656
66662335  0.828  0.821  0.592  0.701
平均值       0.752  0.800  0.658  0.697

[139 rows x 4 columns]
2022-05-18 16:54:06.240 | INFO     | __main__:<module>:26 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   65.0
单项目标未达成人数       33   24.0   93.0   73.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-18 16:54:06.244 | INFO     | __main__:<module>:27 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  47.10%
单项目标未达成人数    23.91%  17.39%  67.39%  52.90%
2022-05-18 16:54:06.247 | INFO     | __main__:<module>:28 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-18 16:57:51.555 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:57:52.033 | ERROR    | __main__:<module>:20 - An error has been caught in function '<module>', process 'MainProcess' (13348), thread 'MainThread' (14732):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 20, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001D6D035ACA0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 108, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x000001D6D035A4C0>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
                                              │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                              │        │                       │                │   │                 │     考核方式                                                          ...
                                              │        │                       │                │   │                 └ 0
                                              │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                       │                │     参数设置                                   ...
                                              │        │                       │                └ 0
                                              │        │                       └ [       1     2    3    4     5     6    7   ...   9    10   11   12   13   14   15
                                              │        │                         题号                                       ...
                                              │        └ <function count_object_evaluation at 0x000001D6D0355940>
                                              └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 139, in count_object_evaluation
    check_data.check_out(single_param)
    │          │         └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14   15
    │          │           题号                                        ...
    │          └ <function check_out at 0x000001D6D0352790>
    └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

TypeError: check_out() missing 1 required positional argument: 'sheet'
2022-05-18 16:58:08.749 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:58:09.220 | ERROR    | __main__:<module>:20 - An error has been caught in function '<module>', process 'MainProcess' (13084), thread 'MainThread' (12352):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 20, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000001E890179CA0>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 108, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x000001E8901794C0>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
                                              │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                              │        │                       │                │   │                 │     考核方式                                                          ...
                                              │        │                       │                │   │                 └ 0
                                              │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                       │                │     参数设置                                   ...
                                              │        │                       │                └ 0
                                              │        │                       └ [       1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                         题号                                      ...
                                              │        └ <function count_object_evaluation at 0x000001E890176940>
                                              └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 139, in count_object_evaluation
    check_data.check_out(single_param)
    │          │         └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
    │          │           题号                                       ...
    │          └ <function check_out at 0x000001E890171790>
    └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

TypeError: check_out() missing 1 required positional argument: 'sheet'
2022-05-18 16:59:20.813 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 16:59:21.286 | ERROR    | src.check_data:check_out:75 - 考试页帧小题分数设置不合法
2022-05-18 16:59:21.287 | ERROR    | __main__:<module>:20 - An error has been caught in function '<module>', process 'MainProcess' (2104), thread 'MainThread' (10548):
Traceback (most recent call last):

> File "E:/python/2021.9.17/database_excel_test/src/main.py", line 20, in <module>
    target_achieve, object_evaluation_out, object_all_param, unobject_scores, unobject_param, object_all_scores, object_param, unobject_evaluation, all_target_data = get_info.read_sheet(df_test_weight, sheet_name, df_index_values, student_id, k, df_param, df_score, df_weight, file)
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         │          └ '..\\data\\原表修改.xls'
                                                                                                                                                                      │        │          │               │           │                │           │  │         │         └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                                                                                                                                                      │        │          │               │           │                │           │  │         │           考核方式                                                          ...
                                                                                                                                                                      │        │          │               │           │                │           │  │         └            1    2    3    4    5   6    7    8   ... 15 16  17   18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │  │           学生学号                                   ...
                                                                                                                                                                      │        │          │               │           │                │           │  └        1    2    3    4    5   6   7   8   ...  15  16  17  18  19  20   21   22
                                                                                                                                                                      │        │          │               │           │                │           │    题号                                         ....
                                                                                                                                                                      │        │          │               │           │                │           └ 3
                                                                                                                                                                      │        │          │               │           │                └ [66652645, 66666664, 66662208, 66662209, 66662210, 66662211, 66662212, 66662213, 66662214, 66662215, 66662216, 66662217, 6666...
                                                                                                                                                                      │        │          │               │           └ ['达成度 （教师评价法）', '达成度 （学生自评法）']
                                                                                                                                                                      │        │          │               └ '考试'
                                                                                                                                                                      │        │          └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4
                                                                                                                                                                      │        │            课程目标达成情况评价报告                        
                                                                                                                                                                      │        │            随堂测验           0.1   0.1   0.1   0.1
                                                                                                                                                                      │        │            作业            ...
                                                                                                                                                                      │        └ <function read_sheet at 0x000002AA0409AD30>
                                                                                                                                                                      └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\get_info.py'>

  File "E:\python\2021.9.17\database_excel_test\src\get_info.py", line 108, in read_sheet
    object_evaluation_achieve, object_evaluation_out, object_all_param = to_function.count_object_target(
                                                                         │           └ <function count_object_target at 0x000002AA0409A550>
                                                                         └ <module 'src.to_function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\to_function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\to_function.py", line 10, in count_object_target
    single_achieve, single_out, count_param = function.count_object_evaluation(object_all_param[i], object_all_scores[i], df_weight,
                                              │        │                       │                │   │                 │   └ 课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
                                              │        │                       │                │   │                 │     考核方式                                                          ...
                                              │        │                       │                │   │                 └ 0
                                              │        │                       │                │   └ [          1    2    3    4    5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                       │                │     参数设置                                   ...
                                              │        │                       │                └ 0
                                              │        │                       └ [       1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
                                              │        │                         题号                                      ...
                                              │        └ <function count_object_evaluation at 0x000002AA040959D0>
                                              └ <module 'src.function' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\function.py'>

  File "E:\python\2021.9.17\database_excel_test\src\function.py", line 139, in count_object_evaluation
    check_data.check_out(single_param)
    │          │         └        1     2    3    4     5     6    7   ...   9    10   11   12   13   14    15
    │          │           题号                                       ...
    │          └ <function check_out at 0x000002AA04091820>
    └ <module 'src.check_data' from 'E:\\python\\2021.9.17\\database_excel_test\\src\\check_data.py'>

TypeError: check_out() missing 1 required positional argument: 'sheet'
2022-05-18 17:00:11.093 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 17:00:11.563 | ERROR    | src.check_data:check_out:75 - 考试页帧小题分数设置不合法
2022-05-18 17:00:11.688 | INFO     | __main__:<module>:25 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.780
66666664  0.725  0.636  0.864  0.873
66662208  0.543  0.663  0.492  0.611
66662209  0.750  0.951  0.636  0.813
66662210  0.743  0.845  0.804  0.825
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.607
66662333  0.730  0.709  0.564  0.622
66662334  0.752  0.846  0.600  0.659
66662335  0.828  0.821  0.592  0.707
平均值       0.752  0.800  0.658  0.703

[139 rows x 4 columns]
2022-05-18 17:00:11.694 | INFO     | __main__:<module>:26 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   67.0
单项目标未达成人数       33   24.0   93.0   71.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-18 17:00:11.697 | INFO     | __main__:<module>:27 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  48.55%
单项目标未达成人数    23.91%  17.39%  67.39%  51.45%
2022-05-18 17:00:11.701 | INFO     | __main__:<module>:28 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-18 17:00:48.576 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 17:00:49.056 | ERROR    | src.check_data:check_out:75 - 考试页帧小题分数设置不合法
2022-05-18 17:00:49.181 | INFO     | __main__:<module>:25 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.780
66666664  0.725  0.636  0.864  0.873
66662208  0.543  0.663  0.492  0.611
66662209  0.750  0.951  0.636  0.813
66662210  0.743  0.845  0.804  0.825
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.607
66662333  0.730  0.709  0.564  0.622
66662334  0.752  0.846  0.600  0.659
66662335  0.828  0.821  0.592  0.707
平均值       0.752  0.800  0.658  0.703

[139 rows x 4 columns]
2022-05-18 17:00:49.186 | INFO     | __main__:<module>:26 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   67.0
单项目标未达成人数       33   24.0   93.0   71.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       30    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-18 17:00:49.190 | INFO     | __main__:<module>:27 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  48.55%
单项目标未达成人数    23.91%  17.39%  67.39%  51.45%
2022-05-18 17:00:49.193 | INFO     | __main__:<module>:28 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      21.74%
所有目标均未达成人数      7.97%
dtype: object
2022-05-18 17:02:15.593 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 17:02:16.058 | ERROR    | src.check_data:check_out:75 - 作业页帧小题分数设置不合法
2022-05-18 17:02:16.063 | ERROR    | src.check_data:check_out:75 - 考试页帧小题分数设置不合法
2022-05-18 17:02:16.188 | INFO     | __main__:<module>:25 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4
66652645  0.634  0.920  0.628  0.791
66666664  0.725  0.636  0.864  0.884
66662208  0.543  0.663  0.492  0.622
66662209  0.750  0.951  0.636  0.824
66662210  0.743  0.845  0.804  0.836
...         ...    ...    ...    ...
66662332  0.836  0.871  0.648  0.619
66662333  0.730  0.709  0.564  0.633
66662334  0.752  0.846  0.600  0.671
66662335  0.828  0.821  0.592  0.718
平均值       0.752  0.800  0.658  0.714

[139 rows x 4 columns]
2022-05-18 17:02:16.194 | INFO     | __main__:<module>:26 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4
单项目标超过平均值人数     70   80.0   59.0   66.0
单项目标达成人数       105  114.0   45.0   72.0
单项目标未达成人数       33   24.0   93.0   66.0
所有目标超过平均值人数     27    NaN    NaN    NaN
所有目标均达成人数       32    NaN    NaN    NaN
所有目标均未达成人数      11    NaN    NaN    NaN
2022-05-18 17:02:16.198 | INFO     | __main__:<module>:27 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4
单项目标超过平均值人数  50.72%  57.97%  42.75%  47.83%
单项目标达成人数     76.09%  82.61%  32.61%  52.17%
单项目标未达成人数    23.91%  17.39%  67.39%  47.83%
2022-05-18 17:02:16.201 | INFO     | __main__:<module>:28 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    19.57%
所有目标均达成人数      23.19%
所有目标均未达成人数      7.97%
dtype: object
2022-05-18 17:02:36.395 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 17:02:36.858 | ERROR    | src.check_data:check_out:75 - 作业页帧小题分数设置不合法
2022-05-18 17:02:54.623 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 17:02:55.112 | ERROR    | src.check_data:check_out:75 - 考试页帧小题分数设置不合法
2022-05-18 17:03:10.681 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-18 17:03:11.157 | ERROR    | src.check_data:check_out:76 - 考试页帧小题分数设置不合法
2022-05-19 20:47:05.948 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告  随堂测验    作业    实验    考试  达成度 （教师评价法）  达成度 （学生自评法）
考核方式                                                          
课程目标1         0.06  0.12   0.0  0.42          0.2          0.2
课程目标2         0.06   0.0  0.18  0.36          0.2          0.2
课程目标3         0.06  0.18   0.0  0.36          0.2          0.2
课程目标4         0.06  0.12  0.12   0.3          0.2          0.2
2022-05-19 20:47:06.417 | ERROR    | src.check_data:check_out:75 - 考试页帧小题分数设置不合法
