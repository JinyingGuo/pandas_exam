2022-06-13 13:04:44.273 | ERROR    | src.check_data:check_cover:42 - 课程目标达成情况报告页帧不存在【课程编号】，程序终止运行
2022-06-13 13:05:10.136 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:05:10.217 | ERROR    | src.function:operate_object_sheet:130 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000020461C15640>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000020464B31280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x0000020464B305E0>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 177, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x0000020464B301F0>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 116, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x0000020461DDAD10>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x0000020461DE0EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000020464CFFF90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x0000020461DE05E0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000020464CFFF90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x0000020461DE40D0>
              └ <pandas.core.indexing._LocIndexer object at 0x0000020464CFFF90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x0000020461DE0F70>
           └ <pandas.core.indexing._LocIndexer object at 0x0000020464CFFF90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x0000020464CFFF90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x0000020461C1CC10>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:05:10.281 | ERROR    | src.check_data:check_object_out:71 - 教师评价页帧参数['目标1', '目标2', '目标3', '目标4', '目标5']满分设置不合法, 程序终止
2022-06-13 13:06:30.624 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:06:30.702 | ERROR    | src.function:operate_object_sheet:130 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000002410CD24400>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000002410FC510D0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x000002410FC50430>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 177, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x000002410FC50040>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 116, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x000002410CEEDAE0>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000002410CEF1E50>
           └ <pandas.core.indexing._LocIndexer object at 0x000002410FE1FF90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000002410CEF1550>
           └ <pandas.core.indexing._LocIndexer object at 0x000002410FE1FF90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x000002410CEF4040>
              └ <pandas.core.indexing._LocIndexer object at 0x000002410FE1FF90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x000002410CEF1EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002410FE1FF90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000002410FE1FF90>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x000002410CD2BB80>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:07:21.393 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:07:21.470 | ERROR    | src.function:operate_object_sheet:131 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x00000219254562C0>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x00000219283700D0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x000002192836F430>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 178, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x000002192836F040>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 117, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x000002192561AB30>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x0000021925620E50>
           └ <pandas.core.indexing._LocIndexer object at 0x000002192853D270>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x0000021925620550>
           └ <pandas.core.indexing._LocIndexer object at 0x000002192853D270>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x0000021925623040>
              └ <pandas.core.indexing._LocIndexer object at 0x000002192853D270>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x0000021925620EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002192853D270>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000002192853D270>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x000002192545CB80>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:12:26.079 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:12:26.157 | ERROR    | src.function:operate_object_sheet:132 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001F6DBB86240>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001F6DEAC00D0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x000001F6DEABF430>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 179, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x000001F6DEABF040>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 116, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x000001F6DBD4AC20>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000001F6DBD50E50>
           └ <pandas.core.indexing._LocIndexer object at 0x000001F6DEC8D220>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000001F6DBD50550>
           └ <pandas.core.indexing._LocIndexer object at 0x000001F6DEC8D220>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x000001F6DBD53040>
              └ <pandas.core.indexing._LocIndexer object at 0x000001F6DEC8D220>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x000001F6DBD50EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001F6DEC8D220>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000001F6DEC8D220>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x000001F6DBB8CB80>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:12:43.301 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:12:43.380 | ERROR    | src.function:operate_object_sheet:132 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001B765B55440>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001B768A800D0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x000001B768A7F430>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 179, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x000001B768A7F040>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 117, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x000001B765D1AA90>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000001B765D20E50>
           └ <pandas.core.indexing._LocIndexer object at 0x000001B768C4D270>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000001B765D20550>
           └ <pandas.core.indexing._LocIndexer object at 0x000001B768C4D270>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x000001B765D24040>
              └ <pandas.core.indexing._LocIndexer object at 0x000001B768C4D270>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x000001B765D20EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001B768C4D270>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000001B768C4D270>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x000001B765B5CB80>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:13:14.855 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:13:14.936 | ERROR    | src.function:operate_object_sheet:133 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000018FE5EF6240>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000018FE8E100D0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x0000018FE8E0F430>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 180, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x0000018FE8E0F040>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 118, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x0000018FE60BAC20>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x0000018FE60C0E50>
           └ <pandas.core.indexing._LocIndexer object at 0x0000018FE8FDEE00>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x0000018FE60C0550>
           └ <pandas.core.indexing._LocIndexer object at 0x0000018FE8FDEE00>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x0000018FE60C3040>
              └ <pandas.core.indexing._LocIndexer object at 0x0000018FE8FDEE00>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x0000018FE60C0EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000018FE8FDEE00>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x0000018FE8FDEE00>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x0000018FE5EFCB80>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:15:24.758 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:15:24.835 | ERROR    | src.function:operate_object_sheet:133 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001F048BB53C0>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001F04BAE00D0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x000001F04BADF430>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 180, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x000001F04BADF040>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 116, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x000001F048D7AB80>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000001F048D80E50>
           └ <pandas.core.indexing._LocIndexer object at 0x000001F04BCAD180>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000001F048D80550>
           └ <pandas.core.indexing._LocIndexer object at 0x000001F04BCAD180>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x000001F048D84040>
              └ <pandas.core.indexing._LocIndexer object at 0x000001F04BCAD180>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x000001F048D80EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001F04BCAD180>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000001F04BCAD180>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x000001F048BBCB80>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:15:41.537 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:15:41.616 | ERROR    | src.function:operate_object_sheet:135 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000002A1A1A054C0>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000002A1A49300D0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x000002A1A492F430>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 182, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x000002A1A492F040>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 118, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x000002A1A1BCAB30>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000002A1A1BD0E50>
           └ <pandas.core.indexing._LocIndexer object at 0x000002A1A4B37E50>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000002A1A1BD0550>
           └ <pandas.core.indexing._LocIndexer object at 0x000002A1A4B37E50>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x000002A1A1BD4040>
              └ <pandas.core.indexing._LocIndexer object at 0x000002A1A4B37E50>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x000002A1A1BD0EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002A1A4B37E50>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000002A1A4B37E50>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x000002A1A1A0CB80>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:16:09.040 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:16:09.120 | ERROR    | src.function:operate_object_sheet:134 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x000002A895575440>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000002A8984B10D0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x000002A8984AF430>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 181, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x000002A8984AF040>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 117, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x000002A89573AA40>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000002A895740E50>
           └ <pandas.core.indexing._LocIndexer object at 0x000002A89867DC70>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000002A895740550>
           └ <pandas.core.indexing._LocIndexer object at 0x000002A89867DC70>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x000002A895744040>
              └ <pandas.core.indexing._LocIndexer object at 0x000002A89867DC70>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x000002A895740EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002A89867DC70>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000002A89867DC70>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x000002A89557CB80>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:16:48.143 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:16:48.239 | ERROR    | src.function:operate_object_sheet:135 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000029A71C56200>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000029A74BC00D0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x0000029A74BBF430>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 182, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x0000029A74BBF040>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 118, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x0000029A71E1AB80>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x0000029A71E20E50>
           └ <pandas.core.indexing._LocIndexer object at 0x0000029A74D8D1D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x0000029A71E20550>
           └ <pandas.core.indexing._LocIndexer object at 0x0000029A74D8D1D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x0000029A71E23040>
              └ <pandas.core.indexing._LocIndexer object at 0x0000029A74D8D1D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x0000029A71E20EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000029A74D8D1D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x0000029A74D8D1D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x0000029A71C5CB80>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:17:29.887 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:17:29.992 | ERROR    | src.function:operate_object_sheet:137 - '小题分数'
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ '小题分数'
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000022EDE6570C0>
           └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                    '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 96, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index.pyx", line 133, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "pandas\_libs\index.pyx", line 150, in pandas._libs.index.IndexEngine._unpack_bool_indexer

KeyError: '小题分数'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000022EE15700D0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 92, in operate_sheet
    object_all_params, object_all_scores = function.read_object_sheet(df_test_weight, sheet_name, student_id, k, df_param, df_score, sheet)
                                           │        │                 │               │           │           │  │         │         └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                           │        │                 │               │           │           │  │         └             1    2    3    4
                                           │        │                 │               │           │           │  │           学生学号                        
                                           │        │                 │               │           │           │  │           20152540.0  7  3.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172657.0  5  5.0  6.0  4.0
                                           │        │                 │               │           │           │  │           20172658....
                                           │        │                 │               │           │           │  └        1    2    3    4
                                           │        │                 │               │           │           │    题号                     
                                           │        │                 │               │           │           │    小题分数   7  8.0  6.0  9.0
                                           │        │                 │               │           │           │    课程目标1  1  0.0  0.0  0.0
                                           │        │                 │               │           │           │    课程目标2  0  0.0  1.0  0.0
                                           │        │                 │               │           │           │    课程目标3...
                                           │        │                 │               │           │           └ 0
                                           │        │                 │               │           └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                           │        │                 │               └ '作业'
                                           │        │                 └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                           │        │                   课程目标达成情况评价报告                              
                                           │        │                   作业               1     1     1     1   ...
                                           │        └ <function read_object_sheet at 0x0000022EE156F430>
                                           └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 184, in read_object_sheet
    object_all_param, object_all_scores = operate_object_sheet(object_evaluation, df_test_weight, student_id, k, df_param, df_score)
                                          │                    │                  │               │           │  │         └             1    2    3    4
                                          │                    │                  │               │           │  │           学生学号                        
                                          │                    │                  │               │           │  │           20152540.0  7  3.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172657.0  5  5.0  6.0  4.0
                                          │                    │                  │               │           │  │           20172658....
                                          │                    │                  │               │           │  └        1    2    3    4
                                          │                    │                  │               │           │    题号                     
                                          │                    │                  │               │           │    小题分数   7  8.0  6.0  9.0
                                          │                    │                  │               │           │    课程目标1  1  0.0  0.0  0.0
                                          │                    │                  │               │           │    课程目标2  0  0.0  1.0  0.0
                                          │                    │                  │               │           │    课程目标3...
                                          │                    │                  │               │           └ 0
                                          │                    │                  │               └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                                          │                    │                  └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                          │                    │                    课程目标达成情况评价报告                              
                                          │                    │                    作业               1     1     1     1   ...
                                          │                    └ [       Unnamed: 1 Unnamed: 2    作业1  Unnamed: 4    作业2  Unnamed: 6
                                          │                      参数设置                                                     ...
                                          └ <function operate_object_sheet at 0x0000022EE156F040>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 120, in operate_object_sheet
    object_parameter_scores = object_data.loc['小题分数', :]
                              │           └ <property object at 0x0000022EDE81AB80>
                              └             1       2
                                题号                   
                                满分        NaN      70
                                课程目标1     NaN     NaN
                                课程目标2     NaN     NaN
                                课程目标3     NaN  ...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ ('小题分数', slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x0000022EDE820E50>
           └ <pandas.core.indexing._LocIndexer object at 0x0000022EE173D0E0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ ('小题分数', slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x0000022EDE820550>
           └ <pandas.core.indexing._LocIndexer object at 0x0000022EE173D0E0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ '小题分数'
              │    └ <function _LocIndexer._getitem_axis at 0x0000022EDE823040>
              └ <pandas.core.indexing._LocIndexer object at 0x0000022EE173D0E0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ '小题分数'
           │    └ <function _LocIndexer._get_label at 0x0000022EDE820EE0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000022EE173D0E0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ '小题分数'
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x0000022EE173D0E0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ '小题分数'
          │     └ <function Index.get_loc at 0x0000022EDE65BB80>
          └ Index(['满分', '课程目标1', '课程目标2', '课程目标3', '课程目标4', '课程目标5', '学生姓名', '吴世海', '肖君豪',
                   '李寒', '罗金宇', '骆杰', '满禹伋', '孟凡啸', '朴春光'...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ '小题分数'

KeyError: '小题分数'
2022-06-13 13:22:42.467 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:23:06.419 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:23:52.086 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:24:15.783 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:25:03.098 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:25:54.632 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:26:18.049 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:27:01.191 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:27:36.393 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:28:20.816 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:28:32.295 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:28:45.722 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:29:00.496 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:29:50.247 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:30:27.700 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:30:27.809 | ERROR    | src.function:concat_data:238 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000018B8D2911F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x0000018B8D290790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 233, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x0000018BFFF13B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x0000018BFFF13B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x0000018BFFC39160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:31:13.888 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:31:14.000 | ERROR    | src.function:concat_data:239 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000002553FC811F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x000002553FC7F790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 234, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x000002553D253B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x000002553D253B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x000002553CF79160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:31:45.579 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:31:45.690 | ERROR    | src.function:concat_data:240 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000022295C501F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x0000022295C4F790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 235, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x0000022293273B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x0000022293273B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x0000022292F99160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:33:16.898 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:33:17.031 | ERROR    | src.function:concat_data:240 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001519C3801F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x000001519C37E790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 235, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x0000015199983B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x0000015199983B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x00000151996A9160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:35:07.528 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:35:07.637 | ERROR    | src.function:concat_data:238 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x00000241D9DD11F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x00000241D9DD0790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 233, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x00000241D73A3B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x00000241D73A3B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x00000241D70C9160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:35:25.274 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:35:25.383 | ERROR    | src.function:concat_data:239 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000002118BBF01F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x000002118BBEF790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 234, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x00000211891E3B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x00000211891E3B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x0000021188F09160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:37:39.039 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:37:39.150 | ERROR    | src.function:concat_data:239 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x00000114949011F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x0000011494900790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 234, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x00000114FFD83B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x00000114FFD83B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x00000114FFAA9160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:38:46.246 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:38:46.359 | ERROR    | src.function:concat_data:240 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000027C2BCC01F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x0000027C2BCBF790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 235, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x0000027C29293B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x0000027C29293B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x0000027C28FB9160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:40:05.195 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:40:05.305 | ERROR    | src.function:concat_data:239 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x00000130D8E511F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x00000130D8E50790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 234, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x00000130D6433B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x00000130D6433B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x00000130D6159160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:40:58.943 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:40:59.054 | ERROR    | src.function:concat_data:240 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000022203921280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x0000022203920820>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 235, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x0000022200F23B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x0000022200F23B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x0000022200C49160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:41:58.930 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:41:59.050 | ERROR    | src.function:concat_data:240 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001DBBB151280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x000001DBBB150820>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 235, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x000001DBB8763B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x000001DBB8763B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x000001DBB8489160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:42:25.378 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:42:25.497 | ERROR    | src.function:concat_data:240 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000002249AB10280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 98, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x000002249AB0F820>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 235, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x00000224FFFE3B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x00000224FFFE3B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x00000224FFD09160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:43:12.570 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:43:12.685 | ERROR    | src.function:concat_data:240 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000026B6A9711F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 99, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x0000026B6A970790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 235, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x0000026B67F53B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x0000026B67F53B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x0000026B67C79160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:43:50.026 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:43:50.157 | ERROR    | src.function:concat_data:241 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001C68A3E01F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 99, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x000001C68A3DF790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 236, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x000001C6879B3B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x000001C6879B3B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x000001C6876D9160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:44:14.063 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:44:14.183 | ERROR    | src.function:concat_data:241 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x00000236EDC51280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 99, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x00000236EDC50820>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 236, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x00000236EB213B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x00000236EB213B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x00000236EAF39160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:44:44.236 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:44:44.357 | ERROR    | src.function:concat_data:241 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000020BD21F01F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 99, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x0000020BD21EF790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 236, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x0000020BCF813B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x0000020BCF813B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x0000020BCF539160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:45:18.743 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:45:18.861 | ERROR    | src.function:concat_data:242 - Length mismatch: Expected axis has 3 elements, new values have 4 elements
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001C435FD01F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 99, in operate_sheet
    all_target_data = function.concat_data(df_weight, object_evaluation_achieve, unobject_scores, student_id)
                      │        │           │          │                          │                └ [20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 2017...
                      │        │           │          │                          └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                      │        │           │          │                            0                                     
                      │        │           │          │                            20152540     1   0.3     1   0.3   0.8
                      │        │           │          │                            2017265...
                      │        │           │          └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                      │        │           │            学生学号                                        
                      │        │           │            20152540.0  1.000  1.000  0.375  0...
                      │        │           └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                      │        │             考核方式                                
                      │        │             课程目标1         0.64   0.0  0.16   0.2
                      │        │             课程目标2         ...
                      │        └ <function concat_data at 0x000001C435FCF790>
                      └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 237, in concat_data
    all_achieve_data.columns = df_weight.columns
    │                │         │         └ <pandas._libs.properties.AxisProperty object at 0x000001C4335D3B20>
    │                │         └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
    │                │           考核方式                                
    │                │           课程目标1         0.64   0.0  0.16   0.2
    │                │           课程目标2         ...
    │                └ <pandas._libs.properties.AxisProperty object at 0x000001C4335D3B20>
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5478, in __setattr__
    return object.__setattr__(self, name, value)
                              │     │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
                              │     └ 'columns'
                              └          课程目标1_x 课程目标1_y 课程目标1
                                20152540   1.000     nan     1
                                20172657   0.714     nan   0.8
                                20172658   0.714     nan   0.8
                                2...

  File "pandas\_libs\properties.pyx", line 66, in pandas._libs.properties.AxisProperty.__set__

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 670, in _set_axis
    self._mgr.set_axis(axis, labels)
    │    │    │        │     └ Index(['作业', '报告', '教师评价', '学生自评'], dtype='object', name='课程目标达成情况评价报告')
    │    │    │        └ 0
    │    │    └ <function BlockManager.set_axis at 0x000001C4332F9160>
    │    └ BlockManager
    │      Items: Index(['课程目标1_x', '课程目标1_y', '课程目标1'], dtype='object')
    │      Axis 1: Index([20152540, 20172657, 20172658, 20172...
    └          课程目标1_x 课程目标1_y 课程目标1
      20152540   1.000     nan     1
      20172657   0.714     nan   0.8
      20172658   0.714     nan   0.8
      2...

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\internals\managers.py", line 220, in set_axis
    raise ValueError(

ValueError: Length mismatch: Expected axis has 3 elements, new values have 4 elements
2022-06-13 13:47:23.049 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:47:23.301 | INFO     | src.get_info:operate_sheet:109 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
20172718  1.000  0.928  0.840  0.786  0.809
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 13:47:23.308 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 13:47:23.310 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 13:47:23.311 | INFO     | src.get_info:operate_sheet:112 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 13:47:25.854 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001BDB4320280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 114, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001BDB1723550>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409', '190407']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x000001BDB431E310>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001BDB158B9F0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN...

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 13:49:53.113 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:49:53.338 | INFO     | src.get_info:operate_sheet:110 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
20172718  1.000  0.928  0.840  0.786  0.809
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 13:49:53.345 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 13:49:53.347 | INFO     | src.get_info:operate_sheet:112 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 13:49:53.348 | INFO     | src.get_info:operate_sheet:113 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 13:49:55.981 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000025FA4FB1280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 115, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x0000025FA2396550>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409', '190407']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x0000025FA4FAF310>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x0000025FA223AA90>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN...

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 13:51:13.783 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:51:14.019 | INFO     | src.get_info:operate_sheet:109 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
20172718  1.000  0.928  0.840  0.786  0.809
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 13:51:14.026 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 13:51:14.028 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 13:51:14.029 | INFO     | src.get_info:operate_sheet:112 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 13:51:16.843 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x00000242EE271280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 114, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x00000242EB625550>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409', '190407']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x00000242EE26F310>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x00000242EB50ABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN...

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 13:53:58.260 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:53:58.483 | INFO     | src.get_info:operate_sheet:109 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 13:53:58.490 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 13:53:58.492 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 13:53:58.493 | INFO     | src.get_info:operate_sheet:112 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 13:54:01.099 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000024E19550280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 114, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x0000024E168C3550>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.849  0.856  0.696  0.709    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x0000024E1954E310>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x0000024E7FFAABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.849  0.856  0.696  0.709    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 13:56:48.668 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:56:48.887 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 13:56:48.895 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 13:56:48.897 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 13:56:48.898 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 13:56:51.406 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x00000162C0700280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x00000162BDB23550>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.849  0.856  0.696  0.709    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x00000162C06FE310>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x00000162BD98AB80>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.849  0.856  0.696  0.709    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 13:57:18.705 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:57:18.867 | DEBUG    | src.function:count_class_unobject:287 - 主观计算出现异常
2022-06-13 13:57:18.867 | ERROR    | src.function:count_class_unobject:288 - 'DataFrame' object has no attribute 'type'
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001C3EE260160>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 104, in operate_sheet
    all_everyclass_achieve, class_avg, class_ach = function.get_class_info(object_evaluation_out, object_all_params, unobject_scores, unobject_params, df_weight, class_id, everyclass_student)
                                                   │        │              │                      │                  │                │                │          │         └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                                                   │        │              │                      │                  │                │                │          └ ['170408', '170409']
                                                   │        │              │                      │                  │                │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                   │        │              │                      │                  │                │                  考核方式                                
                                                   │        │              │                      │                  │                │                  课程目标1         0.64   0.0  0.16   0.2
                                                   │        │              │                      │                  │                │                  课程目标2         ...
                                                   │        │              │                      │                  │                └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │              │                      │                  │                  满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                                                   │        │              │                      │                  │                  满分   7   8   6   9  70]
                                                   │        │              │                      │                  └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │              │                      │                    0                                     
                                                   │        │              │                      │                    20152540     1   0.3     1   0.3   0.8
                                                   │        │              │                      │                    2017265...
                                                   │        │              │                      └ [       1    2    3    4
                                                   │        │              │                        题号                     
                                                   │        │              │                        小题分数   7  8.0  6.0  9.0
                                                   │        │              │                        课程目标1  1  0.0  0.0  0.0
                                                   │        │              │                        课程目标2  0  0.0  1.0  0.0
                                                   │        │              │                        课程目标...
                                                   │        │              └ [题号         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │                学生学号                                    
                                                   │        │                20152540.0   7.0   6.0   3.0   4.0   0.0
                                                   │        │                2...
                                                   │        └ <function get_class_info at 0x000001C3EE25FDC0>
                                                   └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 330, in get_class_info
    class_ach, class_avg = count_class_avg_ach(object_evaluation_out, object_all_param, unobject_scores, unobject_param, df_weight, class_id, everyclass_student)
                           │                   │                      │                 │                │               │          │         └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                           │                   │                      │                 │                │               │          └ ['170408', '170409']
                           │                   │                      │                 │                │               └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                           │                   │                      │                 │                │                 考核方式                                
                           │                   │                      │                 │                │                 课程目标1         0.64   0.0  0.16   0.2
                           │                   │                      │                 │                │                 课程目标2         ...
                           │                   │                      │                 │                └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                   │                      │                 │                  满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                           │                   │                      │                 │                  满分   7   8   6   9  70]
                           │                   │                      │                 └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                   │                      │                   0                                     
                           │                   │                      │                   20152540     1   0.3     1   0.3   0.8
                           │                   │                      │                   2017265...
                           │                   │                      └ [       1    2    3    4
                           │                   │                        题号                     
                           │                   │                        小题分数   7  8.0  6.0  9.0
                           │                   │                        课程目标1  1  0.0  0.0  0.0
                           │                   │                        课程目标2  0  0.0  1.0  0.0
                           │                   │                        课程目标...
                           │                   └ [题号         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                     学生学号                                    
                           │                     20152540.0   7.0   6.0   3.0   4.0   0.0
                           │                     2...
                           └ <function count_class_avg_ach at 0x000001C3EE25FC10>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 305, in count_class_avg_ach
    class_achieve, class_average = count_class_unobject(unobject_scores[i], unobject_param[i], everyclass_student, class_unobjachieve, class_unobjaverage)
                                   │                    │               │   │              │   │                   │                   └ 考核方式
                                   │                    │               │   │              │   │                   │                     课程目标1    NaN
                                   │                    │               │   │              │   │                   │                     课程目标2    NaN
                                   │                    │               │   │              │   │                   │                     课程目标3    NaN
                                   │                    │               │   │              │   │                   │                     课程目标4    NaN
                                   │                    │               │   │              │   │                   │                     课程目标5    NaN
                                   │                    │               │   │              │   │                   │                     dtype: object
                                   │                    │               │   │              │   │                   └ 考核方式
                                   │                    │               │   │              │   │                     课程目标1    NaN
                                   │                    │               │   │              │   │                     课程目标2    NaN
                                   │                    │               │   │              │   │                     课程目标3    NaN
                                   │                    │               │   │              │   │                     课程目标4    NaN
                                   │                    │               │   │              │   │                     课程目标5    NaN
                                   │                    │               │   │              │   │                     dtype: object
                                   │                    │               │   │              │   └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                                   │                    │               │   │              └ 0
                                   │                    │               │   └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                   │                    │               │     满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                                   │                    │               │     满分   7   8   6   9  70]
                                   │                    │               └ 0
                                   │                    └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                   │                      0                                     
                                   │                      20152540     1   0.3     1   0.3   0.8
                                   │                      2017265...
                                   └ <function count_class_unobject at 0x000001C3EE25F940>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 282, in count_class_unobject
    print(achieve.type)
          └ 考核方式     课程目标1    课程目标2  课程目标3     课程目标4     课程目标5
            满分    0.114286  0.07125  0.125  0.063333  0.009571

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5465, in __getattr__
    return object.__getattribute__(self, name)
                                   │     └ 'type'
                                   └ 考核方式     课程目标1    课程目标2  课程目标3     课程目标4     课程目标5
                                     满分    0.114286  0.07125  0.125  0.063333  0.009571

AttributeError: 'DataFrame' object has no attribute 'type'
2022-06-13 13:57:32.896 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:57:33.062 | DEBUG    | src.function:count_class_unobject:287 - 主观计算出现异常
2022-06-13 13:57:33.062 | ERROR    | src.function:count_class_unobject:288 - 'DataFrame' object has no attribute 'dtype'
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001426FE70160>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 104, in operate_sheet
    all_everyclass_achieve, class_avg, class_ach = function.get_class_info(object_evaluation_out, object_all_params, unobject_scores, unobject_params, df_weight, class_id, everyclass_student)
                                                   │        │              │                      │                  │                │                │          │         └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                                                   │        │              │                      │                  │                │                │          └ ['170408', '170409']
                                                   │        │              │                      │                  │                │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                   │        │              │                      │                  │                │                  考核方式                                
                                                   │        │              │                      │                  │                │                  课程目标1         0.64   0.0  0.16   0.2
                                                   │        │              │                      │                  │                │                  课程目标2         ...
                                                   │        │              │                      │                  │                └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │              │                      │                  │                  满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                                                   │        │              │                      │                  │                  满分   7   8   6   9  70]
                                                   │        │              │                      │                  └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │              │                      │                    0                                     
                                                   │        │              │                      │                    20152540     1   0.3     1   0.3   0.8
                                                   │        │              │                      │                    2017265...
                                                   │        │              │                      └ [       1    2    3    4
                                                   │        │              │                        题号                     
                                                   │        │              │                        小题分数   7  8.0  6.0  9.0
                                                   │        │              │                        课程目标1  1  0.0  0.0  0.0
                                                   │        │              │                        课程目标2  0  0.0  1.0  0.0
                                                   │        │              │                        课程目标...
                                                   │        │              └ [题号         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │                学生学号                                    
                                                   │        │                20152540.0   7.0   6.0   3.0   4.0   0.0
                                                   │        │                2...
                                                   │        └ <function get_class_info at 0x000001426FE6FDC0>
                                                   └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 330, in get_class_info
    class_ach, class_avg = count_class_avg_ach(object_evaluation_out, object_all_param, unobject_scores, unobject_param, df_weight, class_id, everyclass_student)
                           │                   │                      │                 │                │               │          │         └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                           │                   │                      │                 │                │               │          └ ['170408', '170409']
                           │                   │                      │                 │                │               └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                           │                   │                      │                 │                │                 考核方式                                
                           │                   │                      │                 │                │                 课程目标1         0.64   0.0  0.16   0.2
                           │                   │                      │                 │                │                 课程目标2         ...
                           │                   │                      │                 │                └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                   │                      │                 │                  满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                           │                   │                      │                 │                  满分   7   8   6   9  70]
                           │                   │                      │                 └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                   │                      │                   0                                     
                           │                   │                      │                   20152540     1   0.3     1   0.3   0.8
                           │                   │                      │                   2017265...
                           │                   │                      └ [       1    2    3    4
                           │                   │                        题号                     
                           │                   │                        小题分数   7  8.0  6.0  9.0
                           │                   │                        课程目标1  1  0.0  0.0  0.0
                           │                   │                        课程目标2  0  0.0  1.0  0.0
                           │                   │                        课程目标...
                           │                   └ [题号         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                     学生学号                                    
                           │                     20152540.0   7.0   6.0   3.0   4.0   0.0
                           │                     2...
                           └ <function count_class_avg_ach at 0x000001426FE6FC10>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 305, in count_class_avg_ach
    class_achieve, class_average = count_class_unobject(unobject_scores[i], unobject_param[i], everyclass_student, class_unobjachieve, class_unobjaverage)
                                   │                    │               │   │              │   │                   │                   └ 考核方式
                                   │                    │               │   │              │   │                   │                     课程目标1    NaN
                                   │                    │               │   │              │   │                   │                     课程目标2    NaN
                                   │                    │               │   │              │   │                   │                     课程目标3    NaN
                                   │                    │               │   │              │   │                   │                     课程目标4    NaN
                                   │                    │               │   │              │   │                   │                     课程目标5    NaN
                                   │                    │               │   │              │   │                   │                     dtype: object
                                   │                    │               │   │              │   │                   └ 考核方式
                                   │                    │               │   │              │   │                     课程目标1    NaN
                                   │                    │               │   │              │   │                     课程目标2    NaN
                                   │                    │               │   │              │   │                     课程目标3    NaN
                                   │                    │               │   │              │   │                     课程目标4    NaN
                                   │                    │               │   │              │   │                     课程目标5    NaN
                                   │                    │               │   │              │   │                     dtype: object
                                   │                    │               │   │              │   └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                                   │                    │               │   │              └ 0
                                   │                    │               │   └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                   │                    │               │     满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                                   │                    │               │     满分   7   8   6   9  70]
                                   │                    │               └ 0
                                   │                    └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                   │                      0                                     
                                   │                      20152540     1   0.3     1   0.3   0.8
                                   │                      2017265...
                                   └ <function count_class_unobject at 0x000001426FE6F940>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 282, in count_class_unobject
    print(achieve.dtype)
          └ 考核方式     课程目标1    课程目标2  课程目标3     课程目标4     课程目标5
            满分    0.114286  0.07125  0.125  0.063333  0.009571

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5465, in __getattr__
    return object.__getattribute__(self, name)
                                   │     └ 'dtype'
                                   └ 考核方式     课程目标1    课程目标2  课程目标3     课程目标4     课程目标5
                                     满分    0.114286  0.07125  0.125  0.063333  0.009571

AttributeError: 'DataFrame' object has no attribute 'dtype'
2022-06-13 13:59:56.975 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 13:59:57.136 | DEBUG    | src.function:count_class_unobject:287 - 主观计算出现异常
2022-06-13 13:59:57.137 | ERROR    | src.function:count_class_unobject:288 - 'DataFrame' object has no attribute 'dtype'
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001DEB11B01F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 104, in operate_sheet
    all_everyclass_achieve, class_avg, class_ach = function.get_class_info(object_evaluation_out, object_all_params, unobject_scores, unobject_params, df_weight, class_id, everyclass_student)
                                                   │        │              │                      │                  │                │                │          │         └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                                                   │        │              │                      │                  │                │                │          └ ['170408', '170409']
                                                   │        │              │                      │                  │                │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                   │        │              │                      │                  │                │                  考核方式                                
                                                   │        │              │                      │                  │                │                  课程目标1         0.64   0.0  0.16   0.2
                                                   │        │              │                      │                  │                │                  课程目标2         ...
                                                   │        │              │                      │                  │                └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │              │                      │                  │                  满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                                                   │        │              │                      │                  │                  满分   7   8   6   9  70]
                                                   │        │              │                      │                  └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │              │                      │                    0                                     
                                                   │        │              │                      │                    20152540     1   0.3     1   0.3   0.8
                                                   │        │              │                      │                    2017265...
                                                   │        │              │                      └ [       1    2    3    4
                                                   │        │              │                        题号                     
                                                   │        │              │                        小题分数   7  8.0  6.0  9.0
                                                   │        │              │                        课程目标1  1  0.0  0.0  0.0
                                                   │        │              │                        课程目标2  0  0.0  1.0  0.0
                                                   │        │              │                        课程目标...
                                                   │        │              └ [题号         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │                学生学号                                    
                                                   │        │                20152540.0   7.0   6.0   3.0   4.0   0.0
                                                   │        │                2...
                                                   │        └ <function get_class_info at 0x000001DEB11AFE50>
                                                   └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 330, in get_class_info
    class_ach, class_avg = count_class_avg_ach(object_evaluation_out, object_all_param, unobject_scores, unobject_param, df_weight, class_id, everyclass_student)
                           │                   │                      │                 │                │               │          │         └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                           │                   │                      │                 │                │               │          └ ['170408', '170409']
                           │                   │                      │                 │                │               └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                           │                   │                      │                 │                │                 考核方式                                
                           │                   │                      │                 │                │                 课程目标1         0.64   0.0  0.16   0.2
                           │                   │                      │                 │                │                 课程目标2         ...
                           │                   │                      │                 │                └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                   │                      │                 │                  满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                           │                   │                      │                 │                  满分   7   8   6   9  70]
                           │                   │                      │                 └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                   │                      │                   0                                     
                           │                   │                      │                   20152540     1   0.3     1   0.3   0.8
                           │                   │                      │                   2017265...
                           │                   │                      └ [       1    2    3    4
                           │                   │                        题号                     
                           │                   │                        小题分数   7  8.0  6.0  9.0
                           │                   │                        课程目标1  1  0.0  0.0  0.0
                           │                   │                        课程目标2  0  0.0  1.0  0.0
                           │                   │                        课程目标...
                           │                   └ [题号         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                     学生学号                                    
                           │                     20152540.0   7.0   6.0   3.0   4.0   0.0
                           │                     2...
                           └ <function count_class_avg_ach at 0x000001DEB11AFCA0>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 305, in count_class_avg_ach
    class_achieve, class_average = count_class_unobject(unobject_scores[i], unobject_param[i], everyclass_student, class_unobjachieve, class_unobjaverage)
                                   │                    │               │   │              │   │                   │                   └ 考核方式
                                   │                    │               │   │              │   │                   │                     课程目标1    NaN
                                   │                    │               │   │              │   │                   │                     课程目标2    NaN
                                   │                    │               │   │              │   │                   │                     课程目标3    NaN
                                   │                    │               │   │              │   │                   │                     课程目标4    NaN
                                   │                    │               │   │              │   │                   │                     课程目标5    NaN
                                   │                    │               │   │              │   │                   │                     dtype: object
                                   │                    │               │   │              │   │                   └ 考核方式
                                   │                    │               │   │              │   │                     课程目标1    NaN
                                   │                    │               │   │              │   │                     课程目标2    NaN
                                   │                    │               │   │              │   │                     课程目标3    NaN
                                   │                    │               │   │              │   │                     课程目标4    NaN
                                   │                    │               │   │              │   │                     课程目标5    NaN
                                   │                    │               │   │              │   │                     dtype: object
                                   │                    │               │   │              │   └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                                   │                    │               │   │              └ 0
                                   │                    │               │   └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                   │                    │               │     满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                                   │                    │               │     满分   7   8   6   9  70]
                                   │                    │               └ 0
                                   │                    └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                   │                      0                                     
                                   │                      20152540     1   0.3     1   0.3   0.8
                                   │                      2017265...
                                   └ <function count_class_unobject at 0x000001DEB11AF9D0>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 282, in count_class_unobject
    print(achieve.dtype)
          └ 考核方式     课程目标1    课程目标2  课程目标3     课程目标4     课程目标5
            满分    0.114286  0.07125  0.125  0.063333  0.009571

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 5465, in __getattr__
    return object.__getattribute__(self, name)
                                   │     └ 'dtype'
                                   └ 考核方式     课程目标1    课程目标2  课程目标3     课程目标4     课程目标5
                                     满分    0.114286  0.07125  0.125  0.063333  0.009571

AttributeError: 'DataFrame' object has no attribute 'dtype'
2022-06-13 14:00:15.367 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:00:15.558 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 14:00:15.565 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 14:00:15.567 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 14:00:15.568 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 14:00:18.349 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001BB99A30160>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001BB96DCA430>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.849  0.856  0.696  0.709    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x000001BB99A2E1F0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001BB96CAAA90>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.849  0.856  0.696  0.709    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 14:01:27.203 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:01:27.365 | DEBUG    | src.function:count_class_unobject:288 - 主观计算出现异常
2022-06-13 14:01:27.365 | ERROR    | src.function:count_class_unobject:289 - loop of ufunc does not support argument 0 of type float which has no callable rint method
AttributeError: 'float' object has no attribute 'rint'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x00000249F9260160>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 104, in operate_sheet
    all_everyclass_achieve, class_avg, class_ach = function.get_class_info(object_evaluation_out, object_all_params, unobject_scores, unobject_params, df_weight, class_id, everyclass_student)
                                                   │        │              │                      │                  │                │                │          │         └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                                                   │        │              │                      │                  │                │                │          └ ['170408', '170409']
                                                   │        │              │                      │                  │                │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                   │        │              │                      │                  │                │                  考核方式                                
                                                   │        │              │                      │                  │                │                  课程目标1         0.64   0.0  0.16   0.2
                                                   │        │              │                      │                  │                │                  课程目标2         ...
                                                   │        │              │                      │                  │                └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │              │                      │                  │                  满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                                                   │        │              │                      │                  │                  满分   7   8   6   9  70]
                                                   │        │              │                      │                  └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │              │                      │                    0                                     
                                                   │        │              │                      │                    20152540     1   0.3     1   0.3   0.8
                                                   │        │              │                      │                    2017265...
                                                   │        │              │                      └ [       1    2    3    4
                                                   │        │              │                        题号                     
                                                   │        │              │                        小题分数   7  8.0  6.0  9.0
                                                   │        │              │                        课程目标1  1  0.0  0.0  0.0
                                                   │        │              │                        课程目标2  0  0.0  1.0  0.0
                                                   │        │              │                        课程目标...
                                                   │        │              └ [题号         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                   │        │                学生学号                                    
                                                   │        │                20152540.0   7.0   6.0   3.0   4.0   0.0
                                                   │        │                2...
                                                   │        └ <function get_class_info at 0x00000249F925FDC0>
                                                   └ <module 'src.function' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\function.py'>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 331, in get_class_info
    class_ach, class_avg = count_class_avg_ach(object_evaluation_out, object_all_param, unobject_scores, unobject_param, df_weight, class_id, everyclass_student)
                           │                   │                      │                 │                │               │          │         └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                           │                   │                      │                 │                │               │          └ ['170408', '170409']
                           │                   │                      │                 │                │               └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                           │                   │                      │                 │                │                 考核方式                                
                           │                   │                      │                 │                │                 课程目标1         0.64   0.0  0.16   0.2
                           │                   │                      │                 │                │                 课程目标2         ...
                           │                   │                      │                 │                └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                   │                      │                 │                  满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                           │                   │                      │                 │                  满分   7   8   6   9  70]
                           │                   │                      │                 └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                   │                      │                   0                                     
                           │                   │                      │                   20152540     1   0.3     1   0.3   0.8
                           │                   │                      │                   2017265...
                           │                   │                      └ [       1    2    3    4
                           │                   │                        题号                     
                           │                   │                        小题分数   7  8.0  6.0  9.0
                           │                   │                        课程目标1  1  0.0  0.0  0.0
                           │                   │                        课程目标2  0  0.0  1.0  0.0
                           │                   │                        课程目标...
                           │                   └ [题号         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                           │                     学生学号                                    
                           │                     20152540.0   7.0   6.0   3.0   4.0   0.0
                           │                     2...
                           └ <function count_class_avg_ach at 0x00000249F925FC10>

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 306, in count_class_avg_ach
    class_achieve, class_average = count_class_unobject(unobject_scores[i], unobject_param[i], everyclass_student, class_unobjachieve, class_unobjaverage)
                                   │                    │               │   │              │   │                   │                   └ 考核方式
                                   │                    │               │   │              │   │                   │                     课程目标1    NaN
                                   │                    │               │   │              │   │                   │                     课程目标2    NaN
                                   │                    │               │   │              │   │                   │                     课程目标3    NaN
                                   │                    │               │   │              │   │                   │                     课程目标4    NaN
                                   │                    │               │   │              │   │                   │                     课程目标5    NaN
                                   │                    │               │   │              │   │                   │                     dtype: object
                                   │                    │               │   │              │   │                   └ 考核方式
                                   │                    │               │   │              │   │                     课程目标1    NaN
                                   │                    │               │   │              │   │                     课程目标2    NaN
                                   │                    │               │   │              │   │                     课程目标3    NaN
                                   │                    │               │   │              │   │                     课程目标4    NaN
                                   │                    │               │   │              │   │                     课程目标5    NaN
                                   │                    │               │   │              │   │                     dtype: object
                                   │                    │               │   │              │   └ [[20152540, 20172657, 20172658, 20172659, 20172661, 20172662, 20172663, 20172664, 20172665, 20172666, 20172667, 20172668, 201...
                                   │                    │               │   │              └ 0
                                   │                    │               │   └ [考核方式 课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                   │                    │               │     满分       7     8     6     9    70, 参数 目标1 目标2 目标3 目标4 目标5
                                   │                    │               │     满分   7   8   6   9  70]
                                   │                    │               └ 0
                                   │                    └ [考核方式     课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                   │                      0                                     
                                   │                      20152540     1   0.3     1   0.3   0.8
                                   │                      2017265...
                                   └ <function count_class_unobject at 0x00000249F925F940>

> File "E:\python\2021.9.17\pandas_excel\src\function.py", line 282, in count_class_unobject
    achieve = achieve.apply(lambda x: round(x, 2))
              │       └ <function DataFrame.apply at 0x00000249F687B0D0>
              └ 考核方式     课程目标1    课程目标2  课程目标3     课程目标4     课程目标5
                满分    0.114286  0.07125  0.125  0.063333  0.009571

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\frame.py", line 7768, in apply
    return op.get_result()
           │  └ <function FrameApply.get_result at 0x00000249F94BBEE0>
           └ <pandas.core.apply.FrameRowApply object at 0x00000249F9317820>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\apply.py", line 185, in get_result
    return self.apply_standard()
           │    └ <function FrameApply.apply_standard at 0x00000249F94C8160>
           └ <pandas.core.apply.FrameRowApply object at 0x00000249F9317820>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\apply.py", line 276, in apply_standard
    results, res_index = self.apply_series_generator()
                         │    └ <function FrameApply.apply_series_generator at 0x00000249F94C81F0>
                         └ <pandas.core.apply.FrameRowApply object at 0x00000249F9317820>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\apply.py", line 290, in apply_series_generator
    results[i] = self.f(v)
    │       │    │    │ └ 满分    0.114286
    │       │    │    │   Name: 课程目标1, dtype: object
    │       │    │    └ <function count_class_unobject.<locals>.<lambda> at 0x00000249F8F7E4C0>
    │       │    └ <pandas.core.apply.FrameRowApply object at 0x00000249F9317820>
    │       └ 0
    └ {}

  File "E:\python\2021.9.17\pandas_excel\src\function.py", line 282, in <lambda>
    achieve = achieve.apply(lambda x: round(x, 2))
                                   │        └ 满分    0.114286
                                   │          Name: 课程目标1, dtype: object
                                   └ 满分    0.114286
                                     Name: 课程目标1, dtype: object

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 1500, in __round__
    return self.round(decimals)
           │    │     └ 2
           │    └ <function Series.round at 0x00000249F684AD30>
           └ 满分    0.114286
             Name: 课程目标1, dtype: object

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\series.py", line 2212, in round
    result = self._values.round(decimals)
             │    │             └ 2
             │    └ <property object at 0x00000249F6847360>
             └ 满分    0.114286
               Name: 课程目标1, dtype: object

TypeError: loop of ufunc does not support argument 0 of type float which has no callable rint method
2022-06-13 14:02:15.644 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:02:15.853 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 14:02:15.860 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 14:02:15.862 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 14:02:15.863 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 14:02:18.498 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000002F2BFF301F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000002F2BD2F54C0>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.849  0.856  0.696  0.709    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x000002F2BFF2E280>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002F2BD1DAB30>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.849  0.856  0.696  0.709    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 14:02:55.241 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:02:55.437 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 14:02:55.444 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 14:02:55.446 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 14:02:55.447 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 14:02:57.938 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000002BA65DE01F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000002BA631B54C0>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.849  0.856  0.696  0.709    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x000002BA65DDE280>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002BA6305ABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.849  0.856  0.696  0.709    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 14:06:25.199 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:06:25.397 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 14:06:25.404 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 14:06:25.405 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 14:06:25.407 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 14:06:28.127 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000015252B2F160>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001524FF0A430>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.849  0.856  0.696  0.709    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x0000015252B2D1F0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001524FDAAB80>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.849  0.856  0.696  0.709    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 14:06:51.490 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:06:51.686 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 14:06:51.693 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 14:06:51.695 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 14:06:51.696 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 14:06:54.267 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001C79DDBF160>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001C79B16A430>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.849  0.856  0.696  0.709    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x000001C79DDBD1F0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001C79B00AA90>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.849  0.856  0.696  0.709    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 14:07:28.140 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:07:28.332 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 14:07:28.339 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 14:07:28.341 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 14:07:28.342 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 14:07:30.785 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001F3861AF160>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001F38356A430>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.849  0.856  0.696  0.709    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x000001F3861AD1F0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001F38340AAE0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.849  0.856  0.696  0.709    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 18:04:52.446 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 18:04:52.636 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 18:04:52.643 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:04:52.645 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 18:04:52.646 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:04:55.230 | ERROR    | src.to_excel:write_reporter:264 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000023D40FAF670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                                          │        │           │                    20172658...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000023D3E390940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.849  0.856  0.696  0.709    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2017级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2017级软工.xls]>
    └ <function write_reporter at 0x0000023D40FAC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    print(class_id)

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 19:00:05.828 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 19:00:06.020 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 19:00:06.027 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 19:00:06.028 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 19:00:06.030 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 20:29:09.747 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 20:29:09.935 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-13 20:29:09.942 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 20:29:09.944 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-13 20:29:09.945 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-14 19:05:16.747 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-14 19:05:16.949 | INFO     | src.get_info:operate_sheet:107 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-14 19:05:16.959 | INFO     | src.get_info:operate_sheet:108 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-14 19:05:16.959 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-14 19:05:16.959 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
2022-06-14 19:17:15.126 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-14 19:17:15.313 | INFO     | src.get_info:operate_sheet:107 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20172718  1.000  0.928  0.840  0.786  0.809
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.819  0.754  0.700  0.652  0.710
2022-06-14 19:17:15.329 | INFO     | src.get_info:operate_sheet:108 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     42   37.0   37.0   27.0   29.0
单项目标达成人数        66   55.0   37.0   27.0   34.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数     10    NaN    NaN    NaN    NaN
所有目标均达成人数       16    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-14 19:17:15.329 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.85%  47.44%  47.44%  34.62%  37.18%
单项目标达成人数     84.62%  70.51%  47.44%  34.62%  43.59%
单项目标未达成人数    15.38%  29.49%  52.56%  65.38%  56.41%
2022-06-14 19:17:15.329 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    12.82%
所有目标均达成人数      20.51%
所有目标均未达成人数      0.00%
dtype: object
