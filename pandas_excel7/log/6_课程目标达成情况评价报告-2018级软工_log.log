2022-06-13 16:55:24.051 | ERROR    | src.check_data:check_cover:42 - 课程目标达成情况报告页帧不存在【课程编号】，程序终止运行
2022-06-13 17:04:14.483 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 17:04:14.776 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20182892  0.876  0.968  0.920  0.786  0.885
20182893  0.705  0.755  0.776  0.897  0.828
20182894  1.000  0.861  0.848  1.000  0.945
20182895  1.000  0.861  0.848  1.000  0.964
20182896  0.876  0.968  0.920  0.786  0.828
20182898  0.876  0.821  0.768  0.786  0.876
20182899  0.876  0.749  0.688  0.643  0.781
20182900  0.705  0.893  0.928  0.897  0.828
20182901  0.876  0.861  0.848  0.897  0.800
20182902  1.000  0.641  0.608  0.643  0.772
20182903  1.000  0.535  0.536  0.786  0.724
20182904  0.876  0.643  0.616  0.786  0.791
20182905  1.000  0.928  0.840  0.786  0.819
20182906  0.876  0.643  0.616  0.786  0.715
20182907  0.876  0.893  0.928  1.000  0.981
20182908  1.000  0.861  0.848  1.000  0.981
20182909  0.876  0.821  0.768  0.786  0.828
20182910  0.705  0.715  0.696  0.786  0.781
20182911  0.705  0.821  0.768  0.643  0.781
20182912  1.000  0.748  0.680  0.572  0.724
20182913  0.876  1.000  1.000  0.897  0.981
20182914  0.876  0.861  0.848  0.897  0.936
20182915  1.000  0.861  0.848  1.000  0.936
20182916  0.705  0.715  0.696  0.786  0.724
20182917  0.581  0.861  0.848  0.643  0.655
20182918  1.000  0.928  0.840  0.786  0.828
20182919  0.705  0.715  0.696  0.786  0.791
20182920  0.705  0.928  0.840  0.572  0.715
20182921  0.876  0.715  0.696  0.897  0.828
20182922  1.000  0.748  0.680  0.572  0.772
20182923  1.000  0.821  0.768  0.897  0.936
20182924  0.876  0.893  0.928  1.000  0.895
20182925  0.876  0.643  0.616  0.786  0.791
20182926  1.000  0.928  0.840  0.786  0.819
20182927  0.876  0.968  0.920  0.786  0.876
20182930  1.000  0.861  0.848  1.000  0.895
20182931  0.876  1.000  1.000  0.897  0.955
20182932  0.876  0.643  0.616  0.786  0.791
20182933  1.000  0.928  0.840  0.786  0.876
20182934  1.000  0.856  0.760  0.643  0.715
20182935  0.876  0.928  0.840  0.643  0.828
20182936  0.876  0.643  0.616  0.786  0.781
20182937  0.581  0.755  0.776  0.786  0.791
20182938  1.000  0.821  0.768  0.897  0.885
20182939  0.705  0.715  0.696  0.786  0.791
20182940  1.000  0.821  0.768  0.897  0.828
20182941  0.876  1.000  1.000  0.897  0.895
20182942  0.876  0.749  0.688  0.643  0.791
20182943  1.000  0.749  0.688  0.786  0.772
20182944  0.876  0.643  0.616  0.786  0.772
20182945  1.000  0.643  0.616  0.897  0.819
20182946  0.705  0.968  0.920  0.643  0.772
20182947  1.000  0.641  0.608  0.643  0.655
20182948  1.000  0.641  0.608  0.643  0.781
20182949  0.876  0.856  0.760  0.572  0.655
20182950  0.876  0.968  0.920  0.786  0.936
20182951  0.876  0.861  0.848  0.897  0.828
20182952  0.705  0.715  0.696  0.786  0.715
20182953  0.876  1.000  1.000  0.897  0.955
20182954  1.000  0.928  0.840  0.786  0.800
20182955  0.705  1.000  1.000  0.786  0.828
20182956  1.000  0.928  0.840  0.786  0.819
20182957  0.876  0.861  0.848  0.897  0.819
20182958  0.876  0.643  0.616  0.786  0.772
20182959  0.705  0.861  0.848  0.786  0.724
20182960  1.000  0.821  0.768  0.897  0.800
20182961  0.876  0.643  0.616  0.786  0.715
20182962  1.000  0.749  0.688  0.786  0.655
20182963  0.876  0.968  0.920  0.786  0.895
20182964  0.705  0.755  0.776  0.897  0.819
20182965  0.705  0.861  0.848  0.786  0.895
20182966  1.000  0.643  0.616  0.897  0.819
20182967  1.000  0.928  0.840  0.786  0.819
20182968  1.000  0.856  0.760  0.643  0.715
平均值       0.883  0.816  0.782  0.800  0.817
2022-06-13 17:04:14.790 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     28   45.0   35.0   25.0   39.0
单项目标达成人数        72   60.0   48.0   59.0   70.0
单项目标未达成人数        2   14.0   26.0   15.0    4.0
所有目标超过平均值人数      5    NaN    NaN    NaN    NaN
所有目标均达成人数       39    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:04:14.793 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  37.84%  60.81%  47.30%  33.78%  52.70%
单项目标达成人数     97.30%  81.08%  64.86%  79.73%  94.59%
单项目标未达成人数     2.70%  18.92%  35.14%  20.27%   5.41%
2022-06-13 17:04:14.795 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     6.76%
所有目标均达成人数      52.70%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:04:20.075 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2018级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001BE59140310>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20182892.0  0.857  1.000  0.875  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20182892.0  6  7.0  6.0  7.0
                                          │        │           │                    20182893.0  5  7.0  4.0  8.0
                                          │        │           │                    20182894...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001BE565275E0>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['180408', '180409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 180408  0.869  0.838  0.775  0.806    NaN
    │              │   │      │                 180409  0.883  0.850  0.753  0.789    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2018级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2018级软工.xls]>
    └ <function write_reporter at 0x000001BE5913E3A0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001BE563CAAE0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            180408  0.869  0.838  0.775  0.806    NaN
            180409  0.883  0.850  0.753  0.789    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:06:10.646 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 17:06:10.954 | INFO     | src.get_info:operate_sheet:107 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20182892  0.876  0.968  0.920  0.786  0.885
20182893  0.705  0.755  0.776  0.897  0.828
20182894  1.000  0.861  0.848  1.000  0.945
20182895  1.000  0.861  0.848  1.000  0.964
20182896  0.876  0.968  0.920  0.786  0.828
20182898  0.876  0.821  0.768  0.786  0.876
20182899  0.876  0.749  0.688  0.643  0.781
20182900  0.705  0.893  0.928  0.897  0.828
20182901  0.876  0.861  0.848  0.897  0.800
20182902  1.000  0.641  0.608  0.643  0.772
20182903  1.000  0.535  0.536  0.786  0.724
20182904  0.876  0.643  0.616  0.786  0.791
20182905  1.000  0.928  0.840  0.786  0.819
20182906  0.876  0.643  0.616  0.786  0.715
20182907  0.876  0.893  0.928  1.000  0.981
20182908  1.000  0.861  0.848  1.000  0.981
20182909  0.876  0.821  0.768  0.786  0.828
20182910  0.705  0.715  0.696  0.786  0.781
20182911  0.705  0.821  0.768  0.643  0.781
20182912  1.000  0.748  0.680  0.572  0.724
20182913  0.876  1.000  1.000  0.897  0.981
20182914  0.876  0.861  0.848  0.897  0.936
20182915  1.000  0.861  0.848  1.000  0.936
20182916  0.705  0.715  0.696  0.786  0.724
20182917  0.581  0.861  0.848  0.643  0.655
20182918  1.000  0.928  0.840  0.786  0.828
20182919  0.705  0.715  0.696  0.786  0.791
20182920  0.705  0.928  0.840  0.572  0.715
20182921  0.876  0.715  0.696  0.897  0.828
20182922  1.000  0.748  0.680  0.572  0.772
20182923  1.000  0.821  0.768  0.897  0.936
20182924  0.876  0.893  0.928  1.000  0.895
20182925  0.876  0.643  0.616  0.786  0.791
20182926  1.000  0.928  0.840  0.786  0.819
20182927  0.876  0.968  0.920  0.786  0.876
20182930  1.000  0.861  0.848  1.000  0.895
20182931  0.876  1.000  1.000  0.897  0.955
20182932  0.876  0.643  0.616  0.786  0.791
20182933  1.000  0.928  0.840  0.786  0.876
20182934  1.000  0.856  0.760  0.643  0.715
20182935  0.876  0.928  0.840  0.643  0.828
20182936  0.876  0.643  0.616  0.786  0.781
20182937  0.581  0.755  0.776  0.786  0.791
20182938  1.000  0.821  0.768  0.897  0.885
20182939  0.705  0.715  0.696  0.786  0.791
20182940  1.000  0.821  0.768  0.897  0.828
20182941  0.876  1.000  1.000  0.897  0.895
20182942  0.876  0.749  0.688  0.643  0.791
20182943  1.000  0.749  0.688  0.786  0.772
20182944  0.876  0.643  0.616  0.786  0.772
20182945  1.000  0.643  0.616  0.897  0.819
20182946  0.705  0.968  0.920  0.643  0.772
20182947  1.000  0.641  0.608  0.643  0.655
20182948  1.000  0.641  0.608  0.643  0.781
20182949  0.876  0.856  0.760  0.572  0.655
20182950  0.876  0.968  0.920  0.786  0.936
20182951  0.876  0.861  0.848  0.897  0.828
20182952  0.705  0.715  0.696  0.786  0.715
20182953  0.876  1.000  1.000  0.897  0.955
20182954  1.000  0.928  0.840  0.786  0.800
20182955  0.705  1.000  1.000  0.786  0.828
20182956  1.000  0.928  0.840  0.786  0.819
20182957  0.876  0.861  0.848  0.897  0.819
20182958  0.876  0.643  0.616  0.786  0.772
20182959  0.705  0.861  0.848  0.786  0.724
20182960  1.000  0.821  0.768  0.897  0.800
20182961  0.876  0.643  0.616  0.786  0.715
20182962  1.000  0.749  0.688  0.786  0.655
20182963  0.876  0.968  0.920  0.786  0.895
20182964  0.705  0.755  0.776  0.897  0.819
20182965  0.705  0.861  0.848  0.786  0.895
20182966  1.000  0.643  0.616  0.897  0.819
20182967  1.000  0.928  0.840  0.786  0.819
20182968  1.000  0.856  0.760  0.643  0.715
平均值       0.883  0.816  0.782  0.800  0.817
2022-06-13 17:06:10.973 | INFO     | src.get_info:operate_sheet:108 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     28   45.0   35.0   25.0   39.0
单项目标达成人数        72   60.0   48.0   59.0   70.0
单项目标未达成人数        2   14.0   26.0   15.0    4.0
所有目标超过平均值人数      5    NaN    NaN    NaN    NaN
所有目标均达成人数       39    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:06:10.978 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  37.84%  60.81%  47.30%  33.78%  52.70%
单项目标达成人数     97.30%  81.08%  64.86%  79.73%  94.59%
单项目标未达成人数     2.70%  18.92%  35.14%  20.27%   5.41%
2022-06-13 17:06:10.981 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     6.76%
所有目标均达成人数      52.70%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:06:15.114 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2018级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001F5D0400310>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 112, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20182892.0  0.857  1.000  0.875  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20182892.0  6  7.0  6.0  7.0
                                          │        │           │                    20182893.0  5  7.0  4.0  8.0
                                          │        │           │                    20182894...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001F5CD8075E0>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['180408', '180409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 180408  0.869  0.838  0.775  0.806    NaN
    │              │   │      │                 180409  0.883  0.850  0.753  0.789    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2018级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2018级软工.xls]>
    └ <function write_reporter at 0x000001F5D03FE3A0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001F5CD6AAC20>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            180408  0.869  0.838  0.775  0.806    NaN
            180409  0.883  0.850  0.753  0.789    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 18:04:15.834 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 18:04:16.021 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20182892  0.876  0.968  0.920  0.786  0.885
20182893  0.705  0.755  0.776  0.897  0.828
20182894  1.000  0.861  0.848  1.000  0.945
20182895  1.000  0.861  0.848  1.000  0.964
20182896  0.876  0.968  0.920  0.786  0.828
20182898  0.876  0.821  0.768  0.786  0.876
20182899  0.876  0.749  0.688  0.643  0.781
20182900  0.705  0.893  0.928  0.897  0.828
20182901  0.876  0.861  0.848  0.897  0.800
20182902  1.000  0.641  0.608  0.643  0.772
20182903  1.000  0.535  0.536  0.786  0.724
20182904  0.876  0.643  0.616  0.786  0.791
20182905  1.000  0.928  0.840  0.786  0.819
20182906  0.876  0.643  0.616  0.786  0.715
20182907  0.876  0.893  0.928  1.000  0.981
20182908  1.000  0.861  0.848  1.000  0.981
20182909  0.876  0.821  0.768  0.786  0.828
20182910  0.705  0.715  0.696  0.786  0.781
20182911  0.705  0.821  0.768  0.643  0.781
20182912  1.000  0.748  0.680  0.572  0.724
20182913  0.876  1.000  1.000  0.897  0.981
20182914  0.876  0.861  0.848  0.897  0.936
20182915  1.000  0.861  0.848  1.000  0.936
20182916  0.705  0.715  0.696  0.786  0.724
20182917  0.581  0.861  0.848  0.643  0.655
20182918  1.000  0.928  0.840  0.786  0.828
20182919  0.705  0.715  0.696  0.786  0.791
20182920  0.705  0.928  0.840  0.572  0.715
20182921  0.876  0.715  0.696  0.897  0.828
20182922  1.000  0.748  0.680  0.572  0.772
20182923  1.000  0.821  0.768  0.897  0.936
20182924  0.876  0.893  0.928  1.000  0.895
20182925  0.876  0.643  0.616  0.786  0.791
20182926  1.000  0.928  0.840  0.786  0.819
20182927  0.876  0.968  0.920  0.786  0.876
20182930  1.000  0.861  0.848  1.000  0.895
20182931  0.876  1.000  1.000  0.897  0.955
20182932  0.876  0.643  0.616  0.786  0.791
20182933  1.000  0.928  0.840  0.786  0.876
20182934  1.000  0.856  0.760  0.643  0.715
20182935  0.876  0.928  0.840  0.643  0.828
20182936  0.876  0.643  0.616  0.786  0.781
20182937  0.581  0.755  0.776  0.786  0.791
20182938  1.000  0.821  0.768  0.897  0.885
20182939  0.705  0.715  0.696  0.786  0.791
20182940  1.000  0.821  0.768  0.897  0.828
20182941  0.876  1.000  1.000  0.897  0.895
20182942  0.876  0.749  0.688  0.643  0.791
20182943  1.000  0.749  0.688  0.786  0.772
20182944  0.876  0.643  0.616  0.786  0.772
20182945  1.000  0.643  0.616  0.897  0.819
20182946  0.705  0.968  0.920  0.643  0.772
20182947  1.000  0.641  0.608  0.643  0.655
20182948  1.000  0.641  0.608  0.643  0.781
20182949  0.876  0.856  0.760  0.572  0.655
20182950  0.876  0.968  0.920  0.786  0.936
20182951  0.876  0.861  0.848  0.897  0.828
20182952  0.705  0.715  0.696  0.786  0.715
20182953  0.876  1.000  1.000  0.897  0.955
20182954  1.000  0.928  0.840  0.786  0.800
20182955  0.705  1.000  1.000  0.786  0.828
20182956  1.000  0.928  0.840  0.786  0.819
20182957  0.876  0.861  0.848  0.897  0.819
20182958  0.876  0.643  0.616  0.786  0.772
20182959  0.705  0.861  0.848  0.786  0.724
20182960  1.000  0.821  0.768  0.897  0.800
20182961  0.876  0.643  0.616  0.786  0.715
20182962  1.000  0.749  0.688  0.786  0.655
20182963  0.876  0.968  0.920  0.786  0.895
20182964  0.705  0.755  0.776  0.897  0.819
20182965  0.705  0.861  0.848  0.786  0.895
20182966  1.000  0.643  0.616  0.897  0.819
20182967  1.000  0.928  0.840  0.786  0.819
20182968  1.000  0.856  0.760  0.643  0.715
平均值       0.883  0.816  0.782  0.800  0.817
2022-06-13 18:04:16.028 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     28   45.0   35.0   25.0   39.0
单项目标达成人数        72   60.0   48.0   59.0   70.0
单项目标未达成人数        2   14.0   26.0   15.0    4.0
所有目标超过平均值人数      5    NaN    NaN    NaN    NaN
所有目标均达成人数       39    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:04:16.029 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  37.84%  60.81%  47.30%  33.78%  52.70%
单项目标达成人数     97.30%  81.08%  64.86%  79.73%  94.59%
单项目标未达成人数     2.70%  18.92%  35.14%  20.27%   5.41%
2022-06-13 18:04:16.030 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     6.76%
所有目标均达成人数      52.70%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:04:18.427 | ERROR    | src.to_excel:write_reporter:264 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2018级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000189050BF670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20182892.0  0.857  1.000  0.875  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20182892.0  6  7.0  6.0  7.0
                                          │        │           │                    20182893.0  5  7.0  4.0  8.0
                                          │        │           │                    20182894...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000018902541940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['180408', '180409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 180408  0.869  0.838  0.775  0.806    NaN
    │              │   │      │                 180409  0.883  0.850  0.753  0.789    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2018级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2018级软工.xls]>
    └ <function write_reporter at 0x00000189050BC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    print(class_id)

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 19:00:31.217 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 19:00:31.406 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20182892  0.876  0.968  0.920  0.786  0.885
20182893  0.705  0.755  0.776  0.897  0.828
20182894  1.000  0.861  0.848  1.000  0.945
20182895  1.000  0.861  0.848  1.000  0.964
20182896  0.876  0.968  0.920  0.786  0.828
20182898  0.876  0.821  0.768  0.786  0.876
20182899  0.876  0.749  0.688  0.643  0.781
20182900  0.705  0.893  0.928  0.897  0.828
20182901  0.876  0.861  0.848  0.897  0.800
20182902  1.000  0.641  0.608  0.643  0.772
20182903  1.000  0.535  0.536  0.786  0.724
20182904  0.876  0.643  0.616  0.786  0.791
20182905  1.000  0.928  0.840  0.786  0.819
20182906  0.876  0.643  0.616  0.786  0.715
20182907  0.876  0.893  0.928  1.000  0.981
20182908  1.000  0.861  0.848  1.000  0.981
20182909  0.876  0.821  0.768  0.786  0.828
20182910  0.705  0.715  0.696  0.786  0.781
20182911  0.705  0.821  0.768  0.643  0.781
20182912  1.000  0.748  0.680  0.572  0.724
20182913  0.876  1.000  1.000  0.897  0.981
20182914  0.876  0.861  0.848  0.897  0.936
20182915  1.000  0.861  0.848  1.000  0.936
20182916  0.705  0.715  0.696  0.786  0.724
20182917  0.581  0.861  0.848  0.643  0.655
20182918  1.000  0.928  0.840  0.786  0.828
20182919  0.705  0.715  0.696  0.786  0.791
20182920  0.705  0.928  0.840  0.572  0.715
20182921  0.876  0.715  0.696  0.897  0.828
20182922  1.000  0.748  0.680  0.572  0.772
20182923  1.000  0.821  0.768  0.897  0.936
20182924  0.876  0.893  0.928  1.000  0.895
20182925  0.876  0.643  0.616  0.786  0.791
20182926  1.000  0.928  0.840  0.786  0.819
20182927  0.876  0.968  0.920  0.786  0.876
20182930  1.000  0.861  0.848  1.000  0.895
20182931  0.876  1.000  1.000  0.897  0.955
20182932  0.876  0.643  0.616  0.786  0.791
20182933  1.000  0.928  0.840  0.786  0.876
20182934  1.000  0.856  0.760  0.643  0.715
20182935  0.876  0.928  0.840  0.643  0.828
20182936  0.876  0.643  0.616  0.786  0.781
20182937  0.581  0.755  0.776  0.786  0.791
20182938  1.000  0.821  0.768  0.897  0.885
20182939  0.705  0.715  0.696  0.786  0.791
20182940  1.000  0.821  0.768  0.897  0.828
20182941  0.876  1.000  1.000  0.897  0.895
20182942  0.876  0.749  0.688  0.643  0.791
20182943  1.000  0.749  0.688  0.786  0.772
20182944  0.876  0.643  0.616  0.786  0.772
20182945  1.000  0.643  0.616  0.897  0.819
20182946  0.705  0.968  0.920  0.643  0.772
20182947  1.000  0.641  0.608  0.643  0.655
20182948  1.000  0.641  0.608  0.643  0.781
20182949  0.876  0.856  0.760  0.572  0.655
20182950  0.876  0.968  0.920  0.786  0.936
20182951  0.876  0.861  0.848  0.897  0.828
20182952  0.705  0.715  0.696  0.786  0.715
20182953  0.876  1.000  1.000  0.897  0.955
20182954  1.000  0.928  0.840  0.786  0.800
20182955  0.705  1.000  1.000  0.786  0.828
20182956  1.000  0.928  0.840  0.786  0.819
20182957  0.876  0.861  0.848  0.897  0.819
20182958  0.876  0.643  0.616  0.786  0.772
20182959  0.705  0.861  0.848  0.786  0.724
20182960  1.000  0.821  0.768  0.897  0.800
20182961  0.876  0.643  0.616  0.786  0.715
20182962  1.000  0.749  0.688  0.786  0.655
20182963  0.876  0.968  0.920  0.786  0.895
20182964  0.705  0.755  0.776  0.897  0.819
20182965  0.705  0.861  0.848  0.786  0.895
20182966  1.000  0.643  0.616  0.897  0.819
20182967  1.000  0.928  0.840  0.786  0.819
20182968  1.000  0.856  0.760  0.643  0.715
平均值       0.883  0.816  0.782  0.800  0.817
2022-06-13 19:00:31.412 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     28   45.0   35.0   25.0   39.0
单项目标达成人数        72   60.0   48.0   59.0   70.0
单项目标未达成人数        2   14.0   26.0   15.0    4.0
所有目标超过平均值人数      5    NaN    NaN    NaN    NaN
所有目标均达成人数       39    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 19:00:31.414 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  37.84%  60.81%  47.30%  33.78%  52.70%
单项目标达成人数     97.30%  81.08%  64.86%  79.73%  94.59%
单项目标未达成人数     2.70%  18.92%  35.14%  20.27%   5.41%
2022-06-13 19:00:31.415 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     6.76%
所有目标均达成人数      52.70%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 20:29:46.668 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 20:29:46.850 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20182892  0.876  0.968  0.920  0.786  0.885
20182893  0.705  0.755  0.776  0.897  0.828
20182894  1.000  0.861  0.848  1.000  0.945
20182895  1.000  0.861  0.848  1.000  0.964
20182896  0.876  0.968  0.920  0.786  0.828
20182898  0.876  0.821  0.768  0.786  0.876
20182899  0.876  0.749  0.688  0.643  0.781
20182900  0.705  0.893  0.928  0.897  0.828
20182901  0.876  0.861  0.848  0.897  0.800
20182902  1.000  0.641  0.608  0.643  0.772
20182903  1.000  0.535  0.536  0.786  0.724
20182904  0.876  0.643  0.616  0.786  0.791
20182905  1.000  0.928  0.840  0.786  0.819
20182906  0.876  0.643  0.616  0.786  0.715
20182907  0.876  0.893  0.928  1.000  0.981
20182908  1.000  0.861  0.848  1.000  0.981
20182909  0.876  0.821  0.768  0.786  0.828
20182910  0.705  0.715  0.696  0.786  0.781
20182911  0.705  0.821  0.768  0.643  0.781
20182912  1.000  0.748  0.680  0.572  0.724
20182913  0.876  1.000  1.000  0.897  0.981
20182914  0.876  0.861  0.848  0.897  0.936
20182915  1.000  0.861  0.848  1.000  0.936
20182916  0.705  0.715  0.696  0.786  0.724
20182917  0.581  0.861  0.848  0.643  0.655
20182918  1.000  0.928  0.840  0.786  0.828
20182919  0.705  0.715  0.696  0.786  0.791
20182920  0.705  0.928  0.840  0.572  0.715
20182921  0.876  0.715  0.696  0.897  0.828
20182922  1.000  0.748  0.680  0.572  0.772
20182923  1.000  0.821  0.768  0.897  0.936
20182924  0.876  0.893  0.928  1.000  0.895
20182925  0.876  0.643  0.616  0.786  0.791
20182926  1.000  0.928  0.840  0.786  0.819
20182927  0.876  0.968  0.920  0.786  0.876
20182930  1.000  0.861  0.848  1.000  0.895
20182931  0.876  1.000  1.000  0.897  0.955
20182932  0.876  0.643  0.616  0.786  0.791
20182933  1.000  0.928  0.840  0.786  0.876
20182934  1.000  0.856  0.760  0.643  0.715
20182935  0.876  0.928  0.840  0.643  0.828
20182936  0.876  0.643  0.616  0.786  0.781
20182937  0.581  0.755  0.776  0.786  0.791
20182938  1.000  0.821  0.768  0.897  0.885
20182939  0.705  0.715  0.696  0.786  0.791
20182940  1.000  0.821  0.768  0.897  0.828
20182941  0.876  1.000  1.000  0.897  0.895
20182942  0.876  0.749  0.688  0.643  0.791
20182943  1.000  0.749  0.688  0.786  0.772
20182944  0.876  0.643  0.616  0.786  0.772
20182945  1.000  0.643  0.616  0.897  0.819
20182946  0.705  0.968  0.920  0.643  0.772
20182947  1.000  0.641  0.608  0.643  0.655
20182948  1.000  0.641  0.608  0.643  0.781
20182949  0.876  0.856  0.760  0.572  0.655
20182950  0.876  0.968  0.920  0.786  0.936
20182951  0.876  0.861  0.848  0.897  0.828
20182952  0.705  0.715  0.696  0.786  0.715
20182953  0.876  1.000  1.000  0.897  0.955
20182954  1.000  0.928  0.840  0.786  0.800
20182955  0.705  1.000  1.000  0.786  0.828
20182956  1.000  0.928  0.840  0.786  0.819
20182957  0.876  0.861  0.848  0.897  0.819
20182958  0.876  0.643  0.616  0.786  0.772
20182959  0.705  0.861  0.848  0.786  0.724
20182960  1.000  0.821  0.768  0.897  0.800
20182961  0.876  0.643  0.616  0.786  0.715
20182962  1.000  0.749  0.688  0.786  0.655
20182963  0.876  0.968  0.920  0.786  0.895
20182964  0.705  0.755  0.776  0.897  0.819
20182965  0.705  0.861  0.848  0.786  0.895
20182966  1.000  0.643  0.616  0.897  0.819
20182967  1.000  0.928  0.840  0.786  0.819
20182968  1.000  0.856  0.760  0.643  0.715
平均值       0.883  0.816  0.782  0.800  0.817
2022-06-13 20:29:46.857 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     28   45.0   35.0   25.0   39.0
单项目标达成人数        72   60.0   48.0   59.0   70.0
单项目标未达成人数        2   14.0   26.0   15.0    4.0
所有目标超过平均值人数      5    NaN    NaN    NaN    NaN
所有目标均达成人数       39    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 20:29:46.859 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  37.84%  60.81%  47.30%  33.78%  52.70%
单项目标达成人数     97.30%  81.08%  64.86%  79.73%  94.59%
单项目标未达成人数     2.70%  18.92%  35.14%  20.27%   5.41%
2022-06-13 20:29:46.860 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     6.76%
所有目标均达成人数      52.70%
所有目标均未达成人数      0.00%
dtype: object
