2022-06-13 17:41:46.118 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:41:46.358 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
20203936  1.000  0.821  0.768  0.897  0.962
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:41:46.368 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:41:46.370 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:41:46.371 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:41:49.414 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000179C9EBF550>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000179C7331820>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410', '210409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.882  0.876  0.757  0.775    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000179C9EBB5E0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x00000179C715AA90>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.882  0.876  0.757  0.775    NaN...

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:45:30.545 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:45:30.788 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
20203936  1.000  0.821  0.768  0.897  0.962
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:45:30.795 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:45:30.796 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:45:30.798 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:45:33.853 | ERROR    | src.to_excel:write_reporter:261 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000195E7CB1670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000195E50C1940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410', '210409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.882  0.876  0.757  0.775    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000195E7CAD700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x00000195E4F2ACC0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.882  0.876  0.757  0.775    NaN...

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:45:58.108 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:45:58.348 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
20203936  1.000  0.821  0.768  0.897  0.962
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:45:58.355 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:45:58.357 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:45:58.358 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:46:01.334 | ERROR    | src.to_excel:write_reporter:262 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000238345E0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000238319B0940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410', '210409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.882  0.876  0.757  0.775    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000238345DC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 216, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002383185AA90>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.882  0.876  0.757  0.775    NaN...

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:47:42.307 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:47:42.550 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
20203936  1.000  0.821  0.768  0.897  0.962
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:47:42.557 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:47:42.559 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:47:42.560 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:47:45.570 | ERROR    | src.to_excel:write_reporter:262 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001B49F670670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001B49CA81940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410', '210409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.882  0.876  0.757  0.775    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001B49F66C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 216, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001B49C91AAE0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.882  0.876  0.757  0.775    NaN...

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:49:39.962 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:49:40.203 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
20203936  1.000  0.821  0.768  0.897  0.962
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:49:40.210 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:49:40.212 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:49:40.213 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:49:43.552 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001EC7B81F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001EC78CA0940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410', '210409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.882  0.876  0.757  0.775    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001EC7B81B700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001EC78ACABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.882  0.876  0.757  0.775    NaN...

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:50:21.307 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:50:21.549 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
20203936  1.000  0.821  0.768  0.897  0.962
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:50:21.556 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:50:21.558 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:50:21.559 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:50:24.543 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001F3B3D80670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001F3B1190940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410', '210409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.882  0.876  0.757  0.775    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001F3B3D7C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001F3B0FFAD10>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.882  0.876  0.757  0.775    NaN...

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:50:46.203 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:50:46.448 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
20203936  1.000  0.821  0.768  0.897  0.962
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:50:46.455 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:50:46.456 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:50:46.458 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:50:49.653 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000204C52D0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000204C2701940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410', '210409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.882  0.876  0.757  0.775    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000204C52CD700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x00000204C256AC20>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.882  0.876  0.757  0.775    NaN...

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:51:38.124 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:51:38.357 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:51:38.364 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:51:38.366 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:51:38.367 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:51:41.145 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000190DAD90670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000190D8191940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000190DAD8C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x00000190D803AB80>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:52:31.573 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:52:31.801 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:52:31.808 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:52:31.810 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:52:31.811 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:52:35.172 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000017F552F0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000017F52701940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000017F552ED700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x0000017F5256AB30>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:53:26.918 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:53:27.150 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:53:27.157 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:53:27.158 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:53:27.159 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:53:30.110 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000024DAB40F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000024DA8820940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000024DAB40C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x0000024DA868AA90>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:53:56.481 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:53:56.708 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:53:56.715 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:53:56.716 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:53:56.717 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:53:59.514 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000023B0CBF0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000023B0C580940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000023B0CBEC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x0000023B7FD2ABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:54:13.007 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:54:13.233 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:54:13.240 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:54:13.241 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:54:13.243 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:54:15.930 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000021BBE7C0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000021BBBBB0940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000021BBE7BC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 212, in write_reporter
    print(class_id)

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:55:02.464 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:55:02.693 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:55:02.700 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:55:02.702 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:55:02.703 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:55:05.571 | ERROR    | src.to_excel:write_reporter:264 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000157FB570670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000157F8931940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000157FB56C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    print(class_id)

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:55:38.376 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:55:38.607 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:55:38.614 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:55:38.616 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:55:38.617 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:55:41.584 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001A8F90B0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001A8F64C1940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001A8F90AC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 212, in write_reporter
    print(class_id)

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:56:04.234 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:56:04.459 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:56:04.466 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:56:04.467 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:56:04.468 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:56:07.320 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000002A0D76D0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000002A0D4B10940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000002A0D76CC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002A0D497AB30>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:57:14.314 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:57:14.540 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:57:14.547 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:57:14.549 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:57:14.550 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:57:17.491 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001BC25CAF670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001BC23081940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001BC25CAB700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001BC22F2AB80>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:58:00.681 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:58:00.910 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:58:00.917 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:58:00.919 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:58:00.920 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:58:03.827 | ERROR    | src.to_excel:write_reporter:265 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000002B2D0140670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000002B2CD531940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000002B2D013D700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 219, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002B2CD3DB9F0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 17:59:34.925 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 17:59:35.156 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 17:59:35.162 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 17:59:35.164 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 17:59:35.166 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 17:59:38.108 | ERROR    | src.to_excel:write_reporter:264 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000002F7F3F10670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000002F7F12F1940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000002F7F3F0C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 218, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002F7F115AA90>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 18:00:11.697 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:00:11.925 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:00:11.932 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:00:11.933 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:00:11.935 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:00:14.887 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000248DE9F0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000248DBD91940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000248DE9EC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x00000248DBC3AC70>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 18:00:36.113 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:00:36.338 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:00:36.345 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:00:36.347 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:00:36.348 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:00:39.081 | ERROR    | src.to_excel:write_reporter:263 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000024852F30670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000024850351940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000024852F2D700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 217, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x00000248501BAB80>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 18:00:56.933 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:00:57.159 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:00:57.166 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:00:57.168 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:00:57.169 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:00:59.935 | ERROR    | src.to_excel:write_reporter:264 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000021CE81E0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000021CE55F1940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000021CE81DC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    print(class_id)

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 18:02:36.993 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:02:37.221 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:02:37.227 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:02:37.229 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:02:37.230 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:07:03.861 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:07:04.088 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:07:04.095 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:07:04.097 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:07:04.098 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:07:07.105 | ERROR    | src.to_excel:write_reporter:265 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000016E1A21F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000016E17640940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000016E1A21B700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 214, in write_reporter
    print(class_id)

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 18:07:54.981 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:07:55.206 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:07:55.213 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:07:55.215 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:07:55.216 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:07:57.998 | ERROR    | src.to_excel:write_reporter:265 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000273C21F0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000273BF5E1940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000273C21ED700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 214, in write_reporter
    print(class_id)

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 18:08:51.018 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:08:51.243 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:08:51.250 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:08:51.252 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:08:51.253 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:08:54.221 | ERROR    | src.to_excel:write_reporter:265 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001F1A7900670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001F1A4D30940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001F1A78FC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 214, in write_reporter
    print(class_id)

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 18:13:02.745 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:13:02.975 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:13:02.983 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:13:02.984 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:13:02.986 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:13:05.551 | ERROR    | src.to_excel:write_reporter:267 - Worksheet named '课程目标达成报告' not found
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001E3A295F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001E39FD61940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001E3A295B700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 207, in write_reporter
    df = pd.read_excel(sheet, sheet_name='课程目标达成报告', index_col=0, header=None)
         │  │          └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
         │  └ <function read_excel at 0x000001E3A00E9310>
         └ <module 'pandas' from 'D:\\anaconda3-5.3.0\\envs\\py38\\lib\\site-packages\\pandas\\__init__.py'>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\util\_decorators.py", line 299, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'sheet_name': '课程目标达成报告', 'index_col': 0, 'header': None}
           │     └ ('..\\data\\6_课程目标达成情况评价报告-2020级软工.xls',)
           └ <function read_excel at 0x000001E3A00A8CA0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\io\excel\_base.py", line 344, in read_excel
    data = io.parse(
           │  └ <function ExcelFile.parse at 0x000001E3A00FF4C0>
           └ <pandas.io.excel._base.ExcelFile object at 0x000001E3A2BF67C0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\io\excel\_base.py", line 1170, in parse
    return self._reader.parse(
           │    │       └ <function BaseExcelReader.parse at 0x000001E3A00E9940>
           │    └ <pandas.io.excel._xlrd.XlrdReader object at 0x000001E3A2B4F730>
           └ <pandas.io.excel._base.ExcelFile object at 0x000001E3A2BF67C0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\io\excel\_base.py", line 488, in parse
    sheet = self.get_sheet_by_name(asheetname)
            │    │                 └ '课程目标达成报告'
            │    └ <function XlrdReader.get_sheet_by_name at 0x000001E3A00FF310>
            └ <pandas.io.excel._xlrd.XlrdReader object at 0x000001E3A2B4F730>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\io\excel\_xlrd.py", line 47, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    │    │                          └ '课程目标达成报告'
    │    └ <function BaseExcelReader.raise_if_bad_sheet_by_name at 0x000001E3A00E98B0>
    └ <pandas.io.excel._xlrd.XlrdReader object at 0x000001E3A2B4F730>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\io\excel\_base.py", line 437, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")

ValueError: Worksheet named '课程目标达成报告' not found
2022-06-13 18:13:49.259 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:13:49.485 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:13:49.492 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:13:49.494 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:13:49.495 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:13:51.941 | ERROR    | src.to_excel:write_reporter:268 - name 'class_id' is not defined
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000025ED4B3F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000025ED1F41940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000025ED4B3C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 222, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x0000025ED1DAAC20>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

NameError: name 'class_id' is not defined
2022-06-13 18:14:26.832 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:14:27.062 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:14:27.069 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:14:27.071 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:14:27.072 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:14:29.546 | ERROR    | src.to_excel:write_reporter:269 - name 'class_id' is not defined
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000002914175F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000002913EB11940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000002914175C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 223, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002913E9BAC20>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

NameError: name 'class_id' is not defined
2022-06-13 18:15:01.663 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:15:01.890 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:15:01.897 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:15:01.899 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:15:01.900 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:15:04.345 | ERROR    | src.to_excel:write_reporter:270 - name 'class_id' is not defined
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000002511966F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000025116A42940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000002511966C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 224, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002511691AC20>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

NameError: name 'class_id' is not defined
2022-06-13 18:15:29.277 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:15:29.506 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:15:29.512 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:15:29.514 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:15:29.516 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:15:32.093 | ERROR    | src.to_excel:write_reporter:271 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x000002128707CF80>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000021289FC0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000212873A1940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000021289FBD700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 225, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x000002128724AB80>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x0000021287252310>
           └ <pandas.core.indexing._LocIndexer object at 0x000002128A4153B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000002128724E9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002128A4153B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x00000212872524C0>
              └ <pandas.core.indexing._LocIndexer object at 0x000002128A4153B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x00000212872523A0>
           └ <pandas.core.indexing._LocIndexer object at 0x000002128A4153B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000002128A4153B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x000002128708D040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:15:41.713 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:15:41.939 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:15:41.946 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:15:41.948 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:15:41.949 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:15:44.489 | ERROR    | src.to_excel:write_reporter:271 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x00000225F93E7400>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000225FC31F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000225F977F940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000225FC31B700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 225, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x00000225F95AAAE0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x00000225F95B2310>
           └ <pandas.core.indexing._LocIndexer object at 0x00000225FC77B6D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x00000225F95AF9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000225FC77B6D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x00000225F95B24C0>
              └ <pandas.core.indexing._LocIndexer object at 0x00000225FC77B6D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x00000225F95B23A0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000225FC77B6D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x00000225FC77B6D0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x00000225F93EE040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:16:48.911 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:16:49.139 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:16:49.146 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:16:49.147 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:16:49.149 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:16:51.601 | ERROR    | src.to_excel:write_reporter:272 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001B836908240>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001B839840670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001B836C21940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001B83983D700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 226, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x000001B836ACAC20>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000001B836AD2310>
           └ <pandas.core.indexing._LocIndexer object at 0x000001B839C91770>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000001B836ACF9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001B839C91770>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x000001B836AD24C0>
              └ <pandas.core.indexing._LocIndexer object at 0x000001B839C91770>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x000001B836AD23A0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001B839C91770>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000001B839C91770>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x000001B83690E040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:17:20.656 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:17:20.884 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:17:20.891 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:17:20.893 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:17:20.894 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:17:23.344 | ERROR    | src.to_excel:write_reporter:272 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000019C481AEE40>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000019C4B0CF670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000019C48510940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000019C4B0CB700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 226, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x0000019C4837AC70>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x0000019C48382310>
           └ <pandas.core.indexing._LocIndexer object at 0x0000019C4B5438B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x0000019C4837E9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000019C4B5438B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x0000019C483824C0>
              └ <pandas.core.indexing._LocIndexer object at 0x0000019C4B5438B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x0000019C483823A0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000019C4B5438B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x0000019C4B5438B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x0000019C481BD040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:19:01.076 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:19:01.301 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:19:01.307 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:19:01.309 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:19:01.310 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:19:03.839 | ERROR    | src.to_excel:write_reporter:272 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000025B7F9A81C0>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000025B1D26E670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000025B1CBD0940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000025B1D26A700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 226, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x0000025B7FB6AB80>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x0000025B7FB72310>
           └ <pandas.core.indexing._LocIndexer object at 0x0000025B1D6908B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x0000025B7FB6F9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000025B1D6908B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x0000025B7FB724C0>
              └ <pandas.core.indexing._LocIndexer object at 0x0000025B1D6908B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x0000025B7FB723A0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000025B1D6908B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x0000025B1D6908B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x0000025B7F9AE040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:19:32.381 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:19:32.610 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:19:32.617 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:19:32.618 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:19:32.620 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:19:35.045 | ERROR    | src.to_excel:write_reporter:273 - 200409.0
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001CD677C6440>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001CD6A70F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001CD67B21940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001CD6A70B700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 227, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409.0
          │          └ <property object at 0x000001CD6798AA90>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409.0, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000001CD67992310>
           └ <pandas.core.indexing._LocIndexer object at 0x000001CD6AB62720>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409.0, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000001CD6798F9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001CD6AB62720>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409.0
              │    └ <function _LocIndexer._getitem_axis at 0x000001CD679924C0>
              └ <pandas.core.indexing._LocIndexer object at 0x000001CD6AB62720>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409.0
           │    └ <function _LocIndexer._get_label at 0x000001CD679923A0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001CD6AB62720>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409.0
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000001CD6AB62720>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409.0
          │     └ <function Index.get_loc at 0x000001CD677CE040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409.0

KeyError: 200409.0
2022-06-13 18:20:28.415 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:20:28.645 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:20:28.651 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:20:28.653 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:20:28.654 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:20:31.074 | ERROR    | src.to_excel:write_reporter:273 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x00000151A2526580>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000151A546F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000151A2881940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000151A546C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 227, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x00000151A26EABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x00000151A26F2310>
           └ <pandas.core.indexing._LocIndexer object at 0x00000151A58B63B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x00000151A26EF9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000151A58B63B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x00000151A26F24C0>
              └ <pandas.core.indexing._LocIndexer object at 0x00000151A58B63B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x00000151A26F23A0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000151A58B63B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x00000151A58B63B0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x00000151A252E040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:21:19.272 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:21:19.500 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:21:19.505 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:21:19.507 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:21:19.508 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:21:21.930 | ERROR    | src.to_excel:write_reporter:274 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001487FAF82C0>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001480335F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000014802CF1940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001480335C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 228, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x000001487FCBAB30>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000001487FCC2310>
           └ <pandas.core.indexing._LocIndexer object at 0x00000148037D24A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000001487FCBF9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000148037D24A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x000001487FCC24C0>
              └ <pandas.core.indexing._LocIndexer object at 0x00000148037D24A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x000001487FCC23A0>
           └ <pandas.core.indexing._LocIndexer object at 0x00000148037D24A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x00000148037D24A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x000001487FAFE040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:21:32.245 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:21:32.472 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:21:32.479 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:21:32.481 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:21:32.482 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:21:34.880 | ERROR    | src.to_excel:write_reporter:274 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001332B348140>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001332E28F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001332B6A1940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001332E28B700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 228, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x000001332B50AAE0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000001332B512310>
           └ <pandas.core.indexing._LocIndexer object at 0x000001332E6D7400>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000001332B50E9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001332E6D7400>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x000001332B5124C0>
              └ <pandas.core.indexing._LocIndexer object at 0x000001332E6D7400>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x000001332B5123A0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001332E6D7400>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000001332E6D7400>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x000001332B34D040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:21:56.064 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:21:56.292 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:21:56.298 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:21:56.300 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:21:56.301 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:24:21.810 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:24:22.040 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:24:22.047 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:24:22.048 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:24:22.049 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:24:24.582 | ERROR    | src.to_excel:write_reporter:274 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x0000027E8AC77300>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000027E8DBBF670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000027E8AFD1940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x0000027E8DBBC700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 228, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x0000027E8AE3ABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x0000027E8AE42310>
           └ <pandas.core.indexing._LocIndexer object at 0x0000027E8E0104A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x0000027E8AE3F9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000027E8E0104A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x0000027E8AE424C0>
              └ <pandas.core.indexing._LocIndexer object at 0x0000027E8E0104A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x0000027E8AE423A0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000027E8E0104A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x0000027E8E0104A0>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x0000027E8AC7E040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:25:13.026 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:25:13.253 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:25:13.260 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:25:13.261 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:25:13.262 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:25:15.706 | ERROR    | src.to_excel:write_reporter:275 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x000001E3C0137480>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001E3C30A0670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001E3C0451940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x000001E3C309D700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 229, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x000001E3C02FAB80>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x000001E3C0302310>
           └ <pandas.core.indexing._LocIndexer object at 0x000001E3C34C2360>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x000001E3C02FF9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001E3C34C2360>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x000001E3C03024C0>
              └ <pandas.core.indexing._LocIndexer object at 0x000001E3C34C2360>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x000001E3C03023A0>
           └ <pandas.core.indexing._LocIndexer object at 0x000001E3C34C2360>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x000001E3C34C2360>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x000001E3C013E040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:25:26.424 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:25:26.654 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:25:26.661 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:25:26.662 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:25:26.663 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:25:29.108 | ERROR    | src.to_excel:write_reporter:275 - 200409
Traceback (most recent call last):

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 200409
           │    └ <pandas._libs.properties.CachedProperty object at 0x00000134FCFD80C0>
           └ Index(['200409', '200410'], dtype='object')

  File "pandas\_libs\index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 200409


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                        
                                                                    │        │             │               │     │                  课程目标1         0.64    0.0    0.0  0...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000134FFF40670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20203894.0  0.714  0.833  1.000  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20203894.0  5  8.0  5.0  8.0
                                          │        │           │                    20203895.0  7  6.0  5.0  8.0
                                          │        │           │                    20203896...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000134FD331940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['200409', '200410']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 200409  0.865  0.824  0.760  0.798    NaN
    │              │   │      │                 200410  0.885  0.875  0.757  0.778    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_课程目标达成情况评价报告-2020级软工.xls'
    │              └ <Book [6_课程目标达成情况评价报告-2020级软工.xls]>
    └ <function write_reporter at 0x00000134FFF3C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 229, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          │   └ 200409
          │          └ <property object at 0x00000134FD19ABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            200409  0.865  0.824  0.760  0.798    NaN
            200410  0.885  0.875  0.757  0.778    NaN

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 889, in __getitem__
    return self._getitem_tuple(key)
           │    │              └ (200409, slice(None, None, None))
           │    └ <function _LocIndexer._getitem_tuple at 0x00000134FD1A2310>
           └ <pandas.core.indexing._LocIndexer object at 0x0000013480442590>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1060, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           │    │                 └ (200409, slice(None, None, None))
           │    └ <function _LocationIndexer._getitem_lowerdim at 0x00000134FD19E9D0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000013480442590>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 807, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              │    │             │         └ 0
              │    │             └ 200409
              │    └ <function _LocIndexer._getitem_axis at 0x00000134FD1A24C0>
              └ <pandas.core.indexing._LocIndexer object at 0x0000013480442590>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1124, in _getitem_axis
    return self._get_label(key, axis=axis)
           │    │          │         └ 0
           │    │          └ 200409
           │    └ <function _LocIndexer._get_label at 0x00000134FD1A23A0>
           └ <pandas.core.indexing._LocIndexer object at 0x0000013480442590>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexing.py", line 1073, in _get_label
    return self.obj.xs(label, axis=axis)
           │    │      │           └ 0
           │    │      └ 200409
           │    └ <attribute 'obj' of 'pandas._libs.indexing.NDFrameIndexerBase' objects>
           └ <pandas.core.indexing._LocIndexer object at 0x0000013480442590>

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\generic.py", line 3739, in xs
    loc = index.get_loc(key)
          │     │       └ 200409
          │     └ <function Index.get_loc at 0x00000134FCFDD040>
          └ Index(['200409', '200410'], dtype='object')

  File "D:\anaconda3-5.3.0\envs\py38\lib\site-packages\pandas\core\indexes\base.py", line 3082, in get_loc
    raise KeyError(key) from err
                   └ 200409

KeyError: 200409
2022-06-13 18:26:27.229 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:26:27.458 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:26:27.465 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:26:27.467 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:26:27.468 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:27:29.234 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 18:27:29.467 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 18:27:29.474 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:27:29.476 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 18:27:29.477 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 19:01:40.412 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 19:01:40.638 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 19:01:40.644 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 19:01:40.646 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 19:01:40.647 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 20:31:15.830 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 20:31:16.052 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 20:31:16.059 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 20:31:16.061 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 20:31:16.062 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 20:37:52.146 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 20:37:52.368 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203936  1.000  0.821  0.768  0.897  0.962
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.880  0.819  0.780  0.789  0.831
2022-06-13 20:37:52.375 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     30   52.0   35.0   30.0   35.0
单项目标达成人数        71   64.0   54.0   54.0   70.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       40    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 20:37:52.377 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  40.54%  70.27%  47.30%  40.54%  47.30%
单项目标达成人数     95.95%  86.49%  72.97%  72.97%  94.59%
单项目标未达成人数     4.05%  13.51%  27.03%  27.03%   5.41%
2022-06-13 20:37:52.378 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.70%
所有目标均达成人数      54.05%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 20:55:05.721 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 20:55:05.939 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.878  0.819  0.780  0.788  0.829
2022-06-13 20:55:05.955 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     29   51.0   35.0   29.0   34.0
单项目标达成人数        70   63.0   53.0   53.0   69.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       39    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 20:55:05.955 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  39.73%  69.86%  47.95%  39.73%  46.58%
单项目标达成人数     95.89%  86.30%  72.60%  72.60%  94.52%
单项目标未达成人数     4.11%  13.70%  27.40%  27.40%   5.48%
2022-06-13 20:55:05.955 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.74%
所有目标均达成人数      53.42%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 20:56:03.550 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业     测试     报告  教师评价  学生自评
考核方式                                        
课程目标1         0.64    0.0    0.0  0.16   0.2
课程目标2         0.64    0.0    0.0  0.16   0.2
课程目标3         0.64    0.0    0.0  0.16   0.2
课程目标4         0.64    0.0    0.0  0.16   0.2
课程目标5          0.0  0.256  0.384  0.16   0.2
2022-06-13 20:56:03.768 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20203894  0.705  0.893  0.928  0.897  0.884
20203895  1.000  0.821  0.768  0.897  0.931
20203896  0.705  0.749  0.688  0.572  0.729
20203897  1.000  0.428  0.348  0.786  0.659
20203898  0.581  0.968  0.920  0.572  0.800
20203899  1.000  0.643  0.616  0.897  0.792
20203900  1.000  0.821  0.768  0.897  0.889
20203901  1.000  0.861  0.848  1.000  0.926
20203902  0.876  0.861  0.848  0.897  0.884
20203903  1.000  0.821  0.768  0.897  0.954
20203904  0.876  0.968  0.920  0.786  0.876
20203905  1.000  0.856  0.760  0.643  0.797
20203906  0.876  0.715  0.696  0.897  0.891
20203907  1.000  0.535  0.536  0.786  0.820
20203908  0.705  0.755  0.776  0.897  0.820
20203909  1.000  0.748  0.680  0.572  0.667
20203910  1.000  0.821  0.768  0.897  0.836
20203911  0.705  0.643  0.616  0.643  0.672
20203912  0.876  0.861  0.848  0.897  0.907
20203913  1.000  0.643  0.616  0.897  0.813
20203914  0.581  0.755  0.776  0.786  0.727
20203915  1.000  0.968  0.920  0.897  0.894
20203916  1.000  0.641  0.608  0.643  0.815
20203917  0.705  0.861  0.848  0.786  0.881
20203918  0.876  0.861  0.848  0.897  0.828
20203919  0.876  0.968  0.920  0.786  0.813
20203920  0.876  0.821  0.768  0.786  0.939
20203921  0.876  0.861  0.848  0.897  0.876
20203922  1.000  0.749  0.688  0.786  0.899
20203923  0.876  0.749  0.688  0.643  0.797
20203924  1.000  0.821  0.768  0.897  0.831
20203925  0.876  0.893  0.928  1.000  0.941
20203926  0.581  0.715  0.696  0.643  0.654
20203927  0.876  0.821  0.768  0.786  0.894
20203928  0.876  0.928  0.840  0.643  0.871
20203929  0.705  0.861  0.848  0.786  0.734
20203930  0.705  0.893  0.928  0.897  0.896
20203931  0.876  0.928  0.840  0.643  0.891
20203932  0.876  0.861  0.848  0.897  0.805
20203933  0.876  0.748  0.680  0.392  0.734
20203935  1.000  0.535  0.536  0.786  0.719
20203937  0.705  0.861  0.848  0.786  0.808
20203938  0.876  0.928  0.840  0.643  0.886
20203939  0.705  0.968  0.920  0.643  0.844
20203940  0.876  0.928  0.840  0.643  0.732
20203941  0.876  0.861  0.848  0.897  0.881
20203943  0.705  1.000  1.000  0.786  0.944
20203944  1.000  0.928  0.840  0.786  0.836
20203945  0.876  0.861  0.848  0.897  0.936
20203946  0.705  0.861  0.848  0.786  0.833
20203947  0.876  0.928  0.840  0.643  0.891
20203948  0.876  0.968  0.920  0.786  0.828
20203949  1.000  0.749  0.688  0.786  0.734
20203950  0.876  0.715  0.696  0.897  0.711
20203951  1.000  0.535  0.536  0.786  0.810
20203952  0.876  0.968  0.920  0.786  0.792
20203953  0.876  0.893  0.928  1.000  0.967
20203954  1.000  0.821  0.768  0.897  0.823
20203955  0.705  0.821  0.768  0.643  0.797
20203956  1.000  0.928  0.840  0.786  0.820
20203957  1.000  0.821  0.768  0.897  0.896
20203958  0.705  0.928  0.840  0.572  0.813
20203959  1.000  0.821  0.768  0.897  0.815
20203960  0.876  0.643  0.616  0.786  0.727
20203961  1.000  0.821  0.768  0.897  0.808
20203962  1.000  0.928  0.840  0.786  0.881
20203963  0.705  0.821  0.768  0.643  0.714
20203964  1.000  0.821  0.768  0.897  0.805
20203965  0.876  0.928  0.840  0.643  0.884
20203966  1.000  0.749  0.688  0.786  0.820
20203967  1.000  0.821  0.768  0.897  0.899
20203968  1.000  0.535  0.536  0.786  0.800
20203969  0.705  0.968  0.920  0.643  0.815
平均值       0.878  0.819  0.780  0.788  0.829
2022-06-13 20:56:03.768 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     29   51.0   35.0   29.0   34.0
单项目标达成人数        70   63.0   53.0   53.0   69.0
单项目标未达成人数        3   10.0   20.0   20.0    4.0
所有目标超过平均值人数      2    NaN    NaN    NaN    NaN
所有目标均达成人数       39    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 20:56:03.768 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  39.73%  69.86%  47.95%  39.73%  46.58%
单项目标达成人数     95.89%  86.30%  72.60%  72.60%  94.52%
单项目标未达成人数     4.11%  13.70%  27.40%  27.40%   5.48%
2022-06-13 20:56:03.768 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数     2.74%
所有目标均达成人数      53.42%
所有目标均未达成人数      0.00%
dtype: object
