2022-06-13 14:03:49.860 | ERROR    | src.check_data:check_cover:42 - 课程目标达成情况报告页帧不存在【课程编号】，程序终止运行
2022-06-13 14:04:09.801 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:04:09.990 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 14:04:10.001 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 14:04:10.002 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 14:04:10.003 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 14:04:12.866 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001A8E64AF280>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001A8E38C4550>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000001A8E64AD310>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001A8E372AAE0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 14:07:49.025 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:07:49.218 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 14:07:49.225 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 14:07:49.226 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 14:07:49.228 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 14:07:51.798 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000028100B5F1F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x00000281002044C0>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x0000028100B5D280>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002817DB4AB80>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 14:47:54.392 | INFO     | src.main:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:47:54.685 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 14:47:54.695 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 14:47:54.696 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 14:47:54.700 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 14:47:59.685 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/tests/test_final.py", line 3, in <module>
    from src.main import new_path, df_weight, df_test_weight, student_id, k, df_index_values

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "E:\python\2021.9.17\pandas_excel\src\main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001B258836A60>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001B255748940>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000001B258833AF0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001B255C50220>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 14:48:06.025 | DEBUG    | test_final:test_class_avg:14 - 
正在执行测试模块-----页帧个数是否满足需求
2022-06-13 14:48:06.069 | ERROR    | test_final:test_class_avg:33 - 多出页帧：['计算评价']
2022-06-13 14:48:06.288 | DEBUG    | test_final:test_report:41 - 
正在执行测试模块-----'课程目标达成情况报告'页帧是否满足需求
2022-06-13 14:48:06.314 | ERROR    | test_final:test_report:61 - []评价方式达成度未写入
2022-06-13 14:48:06.320 | DEBUG    | test_final:test_object_sheet:80 - 
正在执行测试模块-----客观评鉴页帧是否满足需求
2022-06-13 14:50:33.376 | INFO     | src.main:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 14:50:33.679 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 14:50:33.689 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 14:50:33.689 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 14:50:33.693 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 14:50:38.231 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/tests/test_final.py", line 3, in <module>
    from src.main import new_path, df_weight, df_test_weight, student_id, k, df_index_values

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "E:\python\2021.9.17\pandas_excel\src\main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001D771A67A60>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001D76E9B8940>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000001D771A63AF0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001D76EEB0220>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 14:50:44.280 | DEBUG    | test_final:test_class_avg:14 - 
正在执行测试模块-----页帧个数是否满足需求
2022-06-13 14:50:44.350 | ERROR    | test_final:test_class_avg:33 - 多出页帧：['计算评价']
2022-06-13 14:50:44.559 | DEBUG    | test_final:test_report:41 - 
正在执行测试模块-----'课程目标达成情况报告'页帧是否满足需求
2022-06-13 14:50:44.587 | INFO     | test_final:test_report:50 - 班级达成度数据均已写入
2022-06-13 14:50:44.591 | INFO     | test_final:test_report:66 - 目标个数一致
2022-06-13 14:50:44.591 | INFO     | test_final:test_report:71 - 班级达成度数据写入合法
2022-06-13 14:50:44.640 | DEBUG    | test_final:test_object_sheet:80 - 
正在执行测试模块-----客观评鉴页帧是否满足需求
2022-06-13 15:51:01.313 | INFO     | src.main:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 15:51:01.606 | INFO     | src.get_info:operate_sheet:109 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 15:51:01.616 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 15:51:01.619 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 15:51:01.619 | INFO     | src.get_info:operate_sheet:112 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 15:51:06.768 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/tests/test_final.py", line 3, in <module>
    from src.main import new_path, df_weight, df_test_weight, student_id, k, df_index_values

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "E:\python\2021.9.17\pandas_excel\src\main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x0000025A3B036A60>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 114, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x0000025A37F59940>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x0000025A3B033AF0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x0000025A38460400>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 15:52:39.429 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 15:52:39.727 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 15:52:39.737 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 15:52:39.741 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 15:52:39.741 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 15:52:44.607 | ERROR    | src.to_excel:write_reporter:259 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001AE04C311F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001AE020274C0>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000001AE04C2E280>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 214, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001AE7FE6ABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 15:53:32.224 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 15:53:32.560 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 15:53:32.573 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 15:53:32.578 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 15:53:32.583 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 15:53:37.636 | ERROR    | src.to_excel:write_reporter:257 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001571DBF01F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001571AFC44C0>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000001571DBEE280>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 212, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001571AE6ABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 15:53:52.123 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 15:53:52.415 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 15:53:52.426 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 15:53:52.427 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 15:53:52.427 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 15:53:57.472 | ERROR    | src.to_excel:write_reporter:257 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x00000290234CF1F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x00000290208A44C0>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x00000290234CD280>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 212, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002902074AB30>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:02:06.448 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 16:02:06.740 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 16:02:06.750 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 16:02:06.752 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 16:02:06.756 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 16:02:11.413 | ERROR    | src.to_excel:write_reporter:257 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001671E7FF1F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001671E1534C0>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000001671E7FD280>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 212, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001677F93AC20>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:04:08.549 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 16:04:08.847 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 16:04:08.857 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 16:04:08.861 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 16:04:08.861 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 16:04:13.778 | ERROR    | src.to_excel:write_reporter:258 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000002452D10F160>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000002452A4EA430>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000002452D10D1F0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002452A38AB30>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:29:56.488 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 16:29:56.822 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 16:29:56.842 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 16:29:56.846 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 16:29:56.852 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 16:30:01.455 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                    │        │             │               │     │                │            教师评价     0.16
                                                    │        │             │               │     │                │            学生自评      0.2
                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                    │        │             │               │     │                  考核方式                                
                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                    │        │             │               │     │                  课程目标2         ...
                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                    │        │               课程目标达成情况评价报告                              
                                                    │        │               作业               1     1     1     1   ...
                                                    │        └ <function operate_sheet at 0x000001C8F4D101F0>
                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                          │        │           │                  │                    学生学号                                        
                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                          │        │           │                  └ [            1    2    3    4
                          │        │           │                    学生学号                        
                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                          │        │           │                    20172658...
                          │        │           └ [       1    2    3    4
                          │        │             题号                     
                          │        │             小题分数   7  8.0  6.0  9.0
                          │        │             课程目标1  1  0.0  0.0  0.0
                          │        │             课程目标2  0  0.0  1.0  0.0
                          │        │             课程目标...
                          │        └ <function write_excel at 0x000001C8F20EB4C0>
                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000001C8F4D0E280>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001C8F1F9AB80>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:31:26.679 | INFO     | __main__:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 16:31:26.976 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 16:31:26.986 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 16:31:26.990 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 16:31:26.994 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 16:31:31.220 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000154ABFD01F0>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                                          │        │           │                    20172658...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000154A93864C0>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x00000154ABFCE280>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x00000154A926ABD0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:33:03.323 | INFO     | src.main:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 16:33:03.599 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 16:33:03.605 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 16:33:03.610 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 16:33:03.614 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 16:33:07.748 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/tests/test_data_false.py", line 3, in <module>
    from src.main import object_all_out

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "E:\python\2021.9.17\pandas_excel\src\main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x00000274B83629D0>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                                          │        │           │                    20172658...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000274B52B78B0>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x00000274B7E9EA60>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x00000274B57AF360>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:33:13.978 | DEBUG    | test_data_false:test_class_avg:13 - 
正在执行测试模块-----作业页帧总分
2022-06-13 16:33:13.981 | DEBUG    | test_final:test_class_avg:14 - 
正在执行测试模块-----页帧个数是否满足需求
2022-06-13 16:33:14.078 | ERROR    | test_final:test_class_avg:33 - 多出页帧：['计算评价']
2022-06-13 16:33:14.297 | DEBUG    | test_final:test_report:41 - 
正在执行测试模块-----'课程目标达成情况报告'页帧是否满足需求
2022-06-13 16:33:14.326 | INFO     | test_final:test_report:50 - 班级达成度数据均已写入
2022-06-13 16:33:14.330 | INFO     | test_final:test_report:66 - 目标个数一致
2022-06-13 16:33:14.330 | INFO     | test_final:test_report:71 - 班级达成度数据写入合法
2022-06-13 16:33:14.349 | DEBUG    | test_final:test_object_sheet:80 - 
正在执行测试模块-----客观评鉴页帧是否满足需求
2022-06-13 16:35:11.507 | INFO     | src.main:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 16:35:11.778 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 16:35:11.789 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 16:35:11.790 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 16:35:11.790 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 16:35:16.299 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/tests/test_data_false.py", line 3, in <module>
    from src.main import object_all_out

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "E:\python\2021.9.17\pandas_excel\src\main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001D4132E39D0>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                                          │        │           │                    20172658...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001D412C878B0>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000001D4132E0A60>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000001D4106FF1D0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:35:22.646 | DEBUG    | test_data_false:test_class_avg:13 - 
正在执行测试模块-----作业页帧总分
2022-06-13 16:35:42.951 | INFO     | src.main:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 16:35:43.256 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 16:35:43.263 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 16:35:43.268 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 16:35:43.269 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 16:35:47.362 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/tests/test_data_false.py", line 3, in <module>
    from src.main import object_all_out

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "E:\python\2021.9.17\pandas_excel\src\main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000020749D339D0>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                                          │        │           │                    20172658...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000207496A78B0>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x0000020749D30A60>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x000002074711F1D0>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:35:53.552 | DEBUG    | test_data_false:test_class_avg:13 - 
正在执行测试模块-----作业页帧总分
2022-06-13 16:36:59.045 | INFO     | src.main:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 16:36:59.322 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 16:36:59.332 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 16:36:59.332 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 16:36:59.337 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 16:37:03.839 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/tests/test_data_false.py", line 3, in <module>
    from src.main import object_all_out

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "E:\python\2021.9.17\pandas_excel\src\main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000023FF1443A60>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                                          │        │           │                    20172658...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000023FF0DB5940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x0000023FF1440AF0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x0000023FEE82F130>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:37:09.725 | DEBUG    | test_data_false:test_class_avg:13 - 
正在执行测试模块-----作业页帧总分
2022-06-13 16:38:12.189 | INFO     | src.main:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 16:38:12.504 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 16:38:12.512 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 16:38:12.518 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 16:38:12.518 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 16:38:19.775 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/tests/test_data_false.py", line 3, in <module>
    from src.main import object_all_out

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "E:\python\2021.9.17\pandas_excel\src\main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x0000022865243A60>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                                          │        │           │                    20172658...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x0000022862166940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x0000022865240AF0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x0000022862660040>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:38:26.394 | DEBUG    | test_data_false:test_class_avg:13 - 
正在执行测试模块-----作业页帧总分
2022-06-13 16:40:12.350 | INFO     | src.main:<module>:15 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 16:40:12.617 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 16:40:12.629 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 16:40:12.630 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 16:40:12.633 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 16:40:16.783 | ERROR    | src.to_excel:write_reporter:260 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/tests/test_data_false.py", line 3, in <module>
    from src.main import object_all_out

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "E:\python\2021.9.17\pandas_excel\src\main.py", line 17, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000002374B763A60>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                                          │        │           │                    20172658...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x00000237486A5940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000002374B760AF0>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 215, in write_reporter
    ach = single_ach.loc[class_id, :]
          │          └ <property object at 0x0000023748BA8F40>
          └         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
            170408  0.787  0.801  0.610  0.621    NaN
            170409  0.845  0.852  0.694  0.707    NaN

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 16:40:23.135 | DEBUG    | test_data_false:test_class_avg:13 - 
正在执行测试模块-----作业页帧总分
2022-06-13 18:05:07.543 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 18:05:07.733 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 18:05:07.741 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 18:05:07.742 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 18:05:07.744 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-13 18:05:10.195 | ERROR    | src.to_excel:write_reporter:264 - local variable 'class_id' referenced before assignment
Traceback (most recent call last):

  File "E:/python/2021.9.17/pandas_excel/src/main.py", line 18, in <module>
    final_target_achieve, new_path, student_id, k, object_all_out = get_info.operate_sheet(df_test_weight, file, df_index_values, df_weight, data_weight)
                                                                    │        │             │               │     │                │          └ 课程目标达成情况评价报告
                                                                    │        │             │               │     │                │            考核成绩法    0.64
                                                                    │        │             │               │     │                │            教师评价     0.16
                                                                    │        │             │               │     │                │            学生自评      0.2
                                                                    │        │             │               │     │                │            Name: 权重值, dtype: object
                                                                    │        │             │               │     │                └ 课程目标达成情况评价报告    作业    报告  教师评价  学生自评
                                                                    │        │             │               │     │                  考核方式                                
                                                                    │        │             │               │     │                  课程目标1         0.64   0.0  0.16   0.2
                                                                    │        │             │               │     │                  课程目标2         ...
                                                                    │        │             │               │     └ ['教师评价', '学生自评']
                                                                    │        │             │               └ '..\\data\\6_软工(1).xls'
                                                                    │        │             └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
                                                                    │        │               课程目标达成情况评价报告                              
                                                                    │        │               作业               1     1     1     1   ...
                                                                    │        └ <function operate_sheet at 0x000001B05883F670>
                                                                    └ <module 'src.get_info' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\get_info.py'>

  File "E:\python\2021.9.17\pandas_excel\src\get_info.py", line 113, in operate_sheet
    start_col, new_path, object_all_out = to_excel.write_excel(object_all_params, object_all_scores, object_evaluation_achieve,
                                          │        │           │                  │                  └ [题号          课程目标1  课程目标2  课程目标3  课程目标4 课程目标5
                                          │        │           │                  │                    学生学号                                        
                                          │        │           │                  │                    20152540.0  1.000  1.000  0.375  0...
                                          │        │           │                  └ [            1    2    3    4
                                          │        │           │                    学生学号                        
                                          │        │           │                    20152540.0  7  3.0  6.0  4.0
                                          │        │           │                    20172657.0  5  5.0  6.0  4.0
                                          │        │           │                    20172658...
                                          │        │           └ [       1    2    3    4
                                          │        │             题号                     
                                          │        │             小题分数   7  8.0  6.0  9.0
                                          │        │             课程目标1  1  0.0  0.0  0.0
                                          │        │             课程目标2  0  0.0  1.0  0.0
                                          │        │             课程目标...
                                          │        └ <function write_excel at 0x000001B055C30940>
                                          └ <module 'src.to_excel' from 'E:\\python\\2021.9.17\\pandas_excel\\src\\to_excel.py'>

  File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 32, in write_excel
    write_reporter(wb, sheet, df_test_weight, class_ach, class_id, df_index_values, data_weight)
    │              │   │      │               │          │         │                └ 课程目标达成情况评价报告
    │              │   │      │               │          │         │                  考核成绩法    0.64
    │              │   │      │               │          │         │                  教师评价     0.16
    │              │   │      │               │          │         │                  学生自评      0.2
    │              │   │      │               │          │         │                  Name: 权重值, dtype: object
    │              │   │      │               │          │         └ ['教师评价', '学生自评']
    │              │   │      │               │          └ ['170408', '170409']
    │              │   │      │               └ [        课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
    │              │   │      │                 170408  0.787  0.801  0.610  0.621    NaN
    │              │   │      │                 170409  0.845  0.852  0.694  0.707    Na...
    │              │   │      └ 考核方式         课程目标1 课程目标2 课程目标3 课程目标4 课程目标5
    │              │   │        课程目标达成情况评价报告                              
    │              │   │        作业               1     1     1     1   ...
    │              │   └ '..\\data\\6_软工(1).xls'
    │              └ <Book [6_软工(1).xls]>
    └ <function write_reporter at 0x000001B05883C700>

> File "E:\python\2021.9.17\pandas_excel\src\to_excel.py", line 213, in write_reporter
    print(class_id)

UnboundLocalError: local variable 'class_id' referenced before assignment
2022-06-13 20:26:45.505 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-13 20:26:45.695 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-13 20:26:45.702 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-13 20:26:45.704 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-13 20:26:45.705 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
2022-06-14 18:13:20.607 | INFO     | __main__:<module>:16 - 
 权重矩阵：df_weight
课程目标达成情况评价报告    作业    报告  教师评价  学生自评
考核方式                                
课程目标1         0.64   0.0  0.16   0.2
课程目标2         0.64   0.0  0.16   0.2
课程目标3         0.64   0.0  0.16   0.2
课程目标4         0.64   0.0  0.16   0.2
课程目标5          0.0  0.64  0.16   0.2
2022-06-14 18:13:20.810 | INFO     | src.get_info:operate_sheet:108 - 
 最终达成度：achieve
          课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
20152540  1.000  0.748  0.600  0.392  0.696
20172657  0.705  0.856  0.760  0.392  0.696
20172658  0.705  0.749  0.688  0.572  0.628
20172659  1.000  0.535  0.456  0.643  0.628
20172661  0.876  0.856  0.760  0.572  0.705
20172662  0.876  0.535  0.536  0.643  0.636
20172663  1.000  0.748  0.600  0.392  0.696
20172664  1.000  0.641  0.528  0.572  0.645
20172665  0.876  0.535  0.536  0.643  0.628
20172666  0.581  0.928  0.840  0.392  0.655
20172667  0.581  0.821  0.768  0.572  0.655
20172668  0.705  0.856  0.760  0.392  0.628
20172669  0.876  0.749  0.688  0.643  0.705
20172670  1.000  0.428  0.348  0.786  0.628
20172671  0.876  0.861  0.848  0.897  0.885
20172672  0.876  0.643  0.616  0.786  0.724
20172673  0.876  0.641  0.608  0.572  0.696
20172674  1.000  0.856  0.760  0.643  0.696
20172675  0.581  0.715  0.696  0.643  0.636
20172676  1.000  0.535  0.456  0.643  0.628
20172677  1.000  0.641  0.528  0.572  0.645
20172678  0.581  0.821  0.768  0.572  0.628
20172679  0.876  0.748  0.680  0.392  0.655
20172680  0.581  0.715  0.696  0.643  0.655
20172681  0.705  0.643  0.616  0.643  0.655
20172682  0.705  0.715  0.696  0.786  0.791
20172683  0.581  0.928  0.840  0.392  0.655
20172684  1.000  0.535  0.456  0.643  0.628
20172685  0.705  1.000  1.000  0.786  0.828
20172686  0.705  0.643  0.616  0.643  0.655
20172687  0.705  0.536  0.508  0.786  0.636
20172688  0.581  0.928  0.840  0.392  0.696
20172689  0.581  0.715  0.696  0.643  0.628
20172690  0.705  0.536  0.508  0.786  0.636
20172691  1.000  0.748  0.600  0.392  0.696
20172692  1.000  0.641  0.528  0.572  0.636
20172693  0.876  0.535  0.536  0.643  0.628
20172694  0.705  0.755  0.776  0.897  0.876
20172695  0.581  0.715  0.696  0.643  0.655
20172696  0.581  0.928  0.840  0.392  0.645
20172697  0.705  0.861  0.848  0.786  0.715
20162573  0.876  0.641  0.608  0.572  0.628
20172698  0.705  0.856  0.760  0.392  0.628
20172699  0.876  0.641  0.608  0.572  0.628
20172700  0.876  0.861  0.848  0.897  0.828
20172701  0.705  0.928  0.840  0.572  0.705
20172702  0.705  0.755  0.776  0.897  0.724
20172703  0.705  0.821  0.768  0.643  0.772
20172704  0.705  0.928  0.840  0.572  0.772
20172705  1.000  0.821  0.768  0.897  0.800
20172706  0.705  0.861  0.848  0.786  0.655
20172707  0.705  0.928  0.840  0.572  0.655
20172708  0.876  0.861  0.848  0.897  0.828
20172709  0.705  0.715  0.696  0.786  0.705
20172710  0.705  0.856  0.760  0.392  0.628
20172711  0.876  0.821  0.768  0.786  0.791
20172712  0.876  0.928  0.840  0.643  0.724
20172713  1.000  0.748  0.600  0.392  0.628
20172714  0.705  0.749  0.688  0.572  0.696
20172715  1.000  0.643  0.616  0.897  0.791
20172716  1.000  0.641  0.608  0.643  0.772
20172717  1.000  0.856  0.760  0.643  0.705
20172719  1.000  0.748  0.680  0.572  0.772
20172720  0.705  0.643  0.616  0.643  0.645
20172721  1.000  0.856  0.760  0.643  0.885
20172722  0.876  1.000  1.000  0.897  0.964
20172723  0.581  0.715  0.696  0.643  0.645
20172724  1.000  0.821  0.768  0.897  0.876
20172725  1.000  0.968  0.920  0.897  0.936
20172726  0.705  0.755  0.776  0.897  0.819
20172727  1.000  0.535  0.536  0.786  0.715
20172728  1.000  0.749  0.688  0.786  0.781
20172729  1.000  0.821  0.768  0.897  0.819
20172730  1.000  0.748  0.600  0.392  0.645
20172731  0.705  0.755  0.776  0.897  0.800
20172732  1.000  0.641  0.608  0.643  0.715
20172733  0.581  0.755  0.776  0.786  0.772
平均值       0.817  0.752  0.698  0.651  0.709
2022-06-14 18:13:20.810 | INFO     | src.get_info:operate_sheet:109 - 
 统计数据：static_final_data
考核方式         课程目标1  课程目标2  课程目标3  课程目标4  课程目标5
单项目标超过平均值人数     41   36.0   36.0   26.0   28.0
单项目标达成人数        65   54.0   36.0   26.0   33.0
单项目标未达成人数       12   23.0   41.0   51.0   44.0
所有目标超过平均值人数      9    NaN    NaN    NaN    NaN
所有目标均达成人数       15    NaN    NaN    NaN    NaN
所有目标均未达成人数       0    NaN    NaN    NaN    NaN
2022-06-14 18:13:20.810 | INFO     | src.get_info:operate_sheet:110 - 
 统计数据：static_data_single_odd
考核方式          课程目标1   课程目标2   课程目标3   课程目标4   课程目标5
单项目标超过平均值人数  53.25%  46.75%  46.75%  33.77%  36.36%
单项目标达成人数     84.42%  70.13%  46.75%  33.77%  42.86%
单项目标未达成人数    15.58%  29.87%  53.25%  66.23%  57.14%
2022-06-14 18:13:20.826 | INFO     | src.get_info:operate_sheet:111 - 
 统计数据：static_data_all_odd
所有目标超过平均值人数    11.69%
所有目标均达成人数      19.48%
所有目标均未达成人数      0.00%
dtype: object
